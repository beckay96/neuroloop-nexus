

# Schema

| rel_oid | schema_name         | object_name                     | kind | total_size |
| ------- | ------------------- | ------------------------------- | ---- | ---------- |
| 16525   | auth                | audit_log_entries               | r    | 80 kB      |
| 16927   | auth                | flow_state                      | r    | 40 kB      |
| 16725   | auth                | identities                      | r    | 80 kB      |
| 16518   | auth                | instances                       | r    | 16 kB      |
| 16814   | auth                | mfa_amr_claims                  | r    | 48 kB      |
| 16802   | auth                | mfa_challenges                  | r    | 24 kB      |
| 16789   | auth                | mfa_factors                     | r    | 56 kB      |
| 17009   | auth                | oauth_clients                   | r    | 40 kB      |
| 16977   | auth                | one_time_tokens                 | r    | 88 kB      |
| 16507   | auth                | refresh_tokens                  | r    | 128 kB     |
| 16856   | auth                | saml_providers                  | r    | 32 kB      |
| 16874   | auth                | saml_relay_states               | r    | 40 kB      |
| 16533   | auth                | schema_migrations               | r    | 24 kB      |
| 16755   | auth                | sessions                        | r    | 80 kB      |
| 16841   | auth                | sso_domains                     | r    | 32 kB      |
| 16832   | auth                | sso_providers                   | r    | 32 kB      |
| 16495   | auth                | users                           | r    | 152 kB     |
| 20930   | clinical            | ai_insights_cards               | r    | 40 kB      |
| 20882   | clinical            | case_data_panels                | r    | 40 kB      |
| 20787   | clinical            | clinical_notes_exports          | r    | 48 kB      |
| 20691   | clinical            | clinical_scale_results          | r    | 48 kB      |
| 20909   | clinical            | clinician_today_view            | r    | 40 kB      |
| 20723   | clinical            | neuro_imaging_results           | r    | 56 kB      |
| 20821   | clinical            | patient_collab_chat             | r    | 56 kB      |
| 20855   | clinical            | patient_pro_timeline            | r    | 40 kB      |
| 20657   | clinical            | patient_risk_alerts             | r    | 48 kB      |
| 20757   | clinical            | patient_snapshots               | r    | 40 kB      |
| 16420   | extensions          | pg_stat_statements              | v    | 0 bytes    |
| 16403   | extensions          | pg_stat_statements_info         | v    | 0 bytes    |
| 20598   | linkage             | research_id_map                 | r    | 48 kB      |
| 21780   | private_health_info | clinical_media                  | r    | 32 kB      |
| 21323   | private_health_info | clinician_onboarding_data       | r    | 24 kB      |
| 20636   | private_health_info | clinician_phi                   | r    | 48 kB      |
| 21740   | private_health_info | daily_symptom_logs              | r    | 40 kB      |
| 21709   | private_health_info | gait_episodes                   | r    | 40 kB      |
| 21304   | private_health_info | patient_onboarding_data         | r    | 24 kB      |
| 20617   | private_health_info | patient_phi                     | r    | 32 kB      |
| 21639   | private_health_info | seizure_events                  | r    | 40 kB      |
| 23533   | private_health_info | seizure_generalized_assessment  | r    | 24 kB      |
| 23512   | private_health_info | seizure_log_brain_regions       | r    | 16 kB      |
| 23584   | private_health_info | seizure_log_post_ictal_symptoms | r    | 16 kB      |
| 23455   | private_health_info | seizure_log_signs               | r    | 32 kB      |
| 23564   | private_health_info | seizure_log_triggers            | r    | 16 kB      |
| 23421   | private_health_info | seizure_logs_research           | r    | 40 kB      |
| 21438   | private_health_info | tracking_entries                | r    | 32 kB      |
| 21679   | private_health_info | tremor_episodes                 | r    | 32 kB      |
| 21394   | private_health_info | user_conditions                 | r    | 32 kB      |
| 21417   | private_health_info | user_medications                | r    | 24 kB      |
| 19559   | protected           | system_settings                 | r    | 32 kB      |
| 21477   | public              | achievements                    | r    | 48 kB      |
| 21535   | public              | audit_log                       | r    | 40 kB      |
| 23479   | public              | brain_regions_reference         | r    | 32 kB      |
| 21582   | public              | carer_invitations               | r    | 48 kB      |
| 21340   | public              | carer_onboarding_data           | r    | 24 kB      |
| 21244   | public              | carer_profiles                  | r    | 32 kB      |
| 20987   | public              | carer_relationships             | r    | 40 kB      |
| 21222   | public              | clinician_profiles              | r    | 40 kB      |
| 21374   | public              | conditions                      | r    | 80 kB      |
| 21807   | public              | data_sharing_preferences        | r    | 32 kB      |
| 21384   | public              | medications                     | r    | 80 kB      |
| 20958   | public              | patient_clinician_connections   | r    | 48 kB      |
| 21552   | public              | patient_invitations             | r    | 48 kB      |
| 21203   | public              | patient_profiles                | r    | 32 kB      |
| 21183   | public              | profiles                        | r    | 48 kB      |
| 21619   | public              | research_consent                | r    | 24 kB      |
| 21357   | public              | researcher_onboarding_data      | r    | 24 kB      |
| 21263   | public              | researcher_profiles             | r    | 32 kB      |
| 21509   | public              | security_incidents              | r    | 32 kB      |
| 23444   | public              | seizure_signs_reference         | r    | 48 kB      |
| 23553   | public              | seizure_triggers_reference      | r    | 48 kB      |
| 23490   | public              | sign_brain_region_mapping       | r    | 48 kB      |
| 21859   | public              | symptom_options                 | r    | 32 kB      |
| 21849   | public              | trigger_options                 | r    | 32 kB      |
| 21489   | public              | user_achievements               | r    | 24 kB      |
| 21458   | public              | user_points                     | r    | 24 kB      |
| 17348   | realtime            | messages                        | p    | 0 bytes    |
| 17025   | realtime            | schema_migrations               | r    | 24 kB      |
| 17203   | realtime            | subscription                    | r    | 32 kB      |
| 21903   | research            | daily_symptom_logs              | r    | 32 kB      |
| 21893   | research            | gait_episodes                   | r    | 24 kB      |
| 21872   | research            | seizure_events                  | r    | 32 kB      |
| 21883   | research            | tremor_episodes                 | r    | 24 kB      |
| 16546   | storage             | buckets                         | r    | 48 kB      |
| 17160   | storage             | buckets_analytics               | r    | 16 kB      |
| 16588   | storage             | migrations                      | r    | 40 kB      |
| 16561   | storage             | objects                         | r    | 64 kB      |
| 17115   | storage             | prefixes                        | r    | 24 kB      |
| 17062   | storage             | s3_multipart_uploads            | r    | 24 kB      |
| 17076   | storage             | s3_multipart_uploads_parts      | r    | 16 kB      |
| 19702   | supabase_migrations | schema_migrations               | r    | 192 kB     |
| 20382   | supabase_migrations | seed_files                      | r    | 16 kB      |
| 16658   | vault               | secrets                         | r    | 24 kB      |
| 16671   | vault               | decrypted_secrets               | v    | 0 bytes    |









-----------------




# Non-System Schemas 


| schema_oid | schema_name         | owner          |
| ---------- | ------------------- | -------------- |
| 16494      | auth                | supabase_admin |
| 20597      | clinical            | postgres       |
| 16388      | extensions          | postgres       |
| 16624      | graphql             | supabase_admin |
| 16613      | graphql_public      | supabase_admin |
| 20596      | linkage             | postgres       |
| 20595      | private_health_info | postgres       |
| 19554      | protected           | postgres       |
| 18464      | public              | postgres       |
| 16605      | realtime            | supabase_admin |
| 21871      | research            | postgres       |
| 16542      | storage             | supabase_admin |
| 19701      | supabase_migrations | postgres       |
| 16653      | vault               | supabase_admin |





----------



# Columns with data types, defaults, nullability (all schemas)

| schema_name         | table_name                      | ordinal_position | column_name                        | data_type                      | column_default                                                 | not_null | identity_kind | generated_kind |
| ------------------- | ------------------------------- | ---------------- | ---------------------------------- | ------------------------------ | -------------------------------------------------------------- | -------- | ------------- | -------------- |
| auth                | audit_log_entries               | 1                | instance_id                        | uuid                           | null                                                           | false    |               |                |
| auth                | audit_log_entries               | 2                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | audit_log_entries               | 3                | payload                            | json                           | null                                                           | false    |               |                |
| auth                | audit_log_entries               | 4                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | audit_log_entries               | 5                | ip_address                         | character varying(64)          | ''::character varying                                          | true     |               |                |
| auth                | flow_state                      | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | flow_state                      | 2                | user_id                            | uuid                           | null                                                           | false    |               |                |
| auth                | flow_state                      | 3                | auth_code                          | text                           | null                                                           | true     |               |                |
| auth                | flow_state                      | 4                | code_challenge_method              | auth.code_challenge_method     | null                                                           | true     |               |                |
| auth                | flow_state                      | 5                | code_challenge                     | text                           | null                                                           | true     |               |                |
| auth                | flow_state                      | 6                | provider_type                      | text                           | null                                                           | true     |               |                |
| auth                | flow_state                      | 7                | provider_access_token              | text                           | null                                                           | false    |               |                |
| auth                | flow_state                      | 8                | provider_refresh_token             | text                           | null                                                           | false    |               |                |
| auth                | flow_state                      | 9                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | flow_state                      | 10               | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | flow_state                      | 11               | authentication_method              | text                           | null                                                           | true     |               |                |
| auth                | flow_state                      | 12               | auth_code_issued_at                | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | identities                      | 1                | provider_id                        | text                           | null                                                           | true     |               |                |
| auth                | identities                      | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| auth                | identities                      | 3                | identity_data                      | jsonb                          | null                                                           | true     |               |                |
| auth                | identities                      | 4                | provider                           | text                           | null                                                           | true     |               |                |
| auth                | identities                      | 5                | last_sign_in_at                    | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | identities                      | 6                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | identities                      | 7                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | identities                      | 8                | email                              | text                           | lower((identity_data ->> 'email'::text))                       | false    |               | s              |
| auth                | identities                      | 9                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| auth                | instances                       | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | instances                       | 2                | uuid                               | uuid                           | null                                                           | false    |               |                |
| auth                | instances                       | 3                | raw_base_config                    | text                           | null                                                           | false    |               |                |
| auth                | instances                       | 4                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | instances                       | 5                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | mfa_amr_claims                  | 1                | session_id                         | uuid                           | null                                                           | true     |               |                |
| auth                | mfa_amr_claims                  | 2                | created_at                         | timestamp with time zone       | null                                                           | true     |               |                |
| auth                | mfa_amr_claims                  | 3                | updated_at                         | timestamp with time zone       | null                                                           | true     |               |                |
| auth                | mfa_amr_claims                  | 4                | authentication_method              | text                           | null                                                           | true     |               |                |
| auth                | mfa_amr_claims                  | 5                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | mfa_challenges                  | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | mfa_challenges                  | 2                | factor_id                          | uuid                           | null                                                           | true     |               |                |
| auth                | mfa_challenges                  | 3                | created_at                         | timestamp with time zone       | null                                                           | true     |               |                |
| auth                | mfa_challenges                  | 4                | verified_at                        | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | mfa_challenges                  | 5                | ip_address                         | inet                           | null                                                           | true     |               |                |
| auth                | mfa_challenges                  | 6                | otp_code                           | text                           | null                                                           | false    |               |                |
| auth                | mfa_challenges                  | 7                | web_authn_session_data             | jsonb                          | null                                                           | false    |               |                |
| auth                | mfa_factors                     | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | mfa_factors                     | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| auth                | mfa_factors                     | 3                | friendly_name                      | text                           | null                                                           | false    |               |                |
| auth                | mfa_factors                     | 4                | factor_type                        | auth.factor_type               | null                                                           | true     |               |                |
| auth                | mfa_factors                     | 5                | status                             | auth.factor_status             | null                                                           | true     |               |                |
| auth                | mfa_factors                     | 6                | created_at                         | timestamp with time zone       | null                                                           | true     |               |                |
| auth                | mfa_factors                     | 7                | updated_at                         | timestamp with time zone       | null                                                           | true     |               |                |
| auth                | mfa_factors                     | 8                | secret                             | text                           | null                                                           | false    |               |                |
| auth                | mfa_factors                     | 9                | phone                              | text                           | null                                                           | false    |               |                |
| auth                | mfa_factors                     | 10               | last_challenged_at                 | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | mfa_factors                     | 11               | web_authn_credential               | jsonb                          | null                                                           | false    |               |                |
| auth                | mfa_factors                     | 12               | web_authn_aaguid                   | uuid                           | null                                                           | false    |               |                |
| auth                | oauth_clients                   | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | oauth_clients                   | 2                | client_id                          | text                           | null                                                           | true     |               |                |
| auth                | oauth_clients                   | 3                | client_secret_hash                 | text                           | null                                                           | true     |               |                |
| auth                | oauth_clients                   | 4                | registration_type                  | auth.oauth_registration_type   | null                                                           | true     |               |                |
| auth                | oauth_clients                   | 5                | redirect_uris                      | text                           | null                                                           | true     |               |                |
| auth                | oauth_clients                   | 6                | grant_types                        | text                           | null                                                           | true     |               |                |
| auth                | oauth_clients                   | 7                | client_name                        | text                           | null                                                           | false    |               |                |
| auth                | oauth_clients                   | 8                | client_uri                         | text                           | null                                                           | false    |               |                |
| auth                | oauth_clients                   | 9                | logo_uri                           | text                           | null                                                           | false    |               |                |
| auth                | oauth_clients                   | 10               | created_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| auth                | oauth_clients                   | 11               | updated_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| auth                | oauth_clients                   | 12               | deleted_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | one_time_tokens                 | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | one_time_tokens                 | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| auth                | one_time_tokens                 | 3                | token_type                         | auth.one_time_token_type       | null                                                           | true     |               |                |
| auth                | one_time_tokens                 | 4                | token_hash                         | text                           | null                                                           | true     |               |                |
| auth                | one_time_tokens                 | 5                | relates_to                         | text                           | null                                                           | true     |               |                |
| auth                | one_time_tokens                 | 6                | created_at                         | timestamp without time zone    | now()                                                          | true     |               |                |
| auth                | one_time_tokens                 | 7                | updated_at                         | timestamp without time zone    | now()                                                          | true     |               |                |
| auth                | refresh_tokens                  | 1                | instance_id                        | uuid                           | null                                                           | false    |               |                |
| auth                | refresh_tokens                  | 2                | id                                 | bigint                         | nextval('auth.refresh_tokens_id_seq'::regclass)                | true     |               |                |
| auth                | refresh_tokens                  | 3                | token                              | character varying(255)         | null                                                           | false    |               |                |
| auth                | refresh_tokens                  | 4                | user_id                            | character varying(255)         | null                                                           | false    |               |                |
| auth                | refresh_tokens                  | 5                | revoked                            | boolean                        | null                                                           | false    |               |                |
| auth                | refresh_tokens                  | 6                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | refresh_tokens                  | 7                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | refresh_tokens                  | 8                | parent                             | character varying(255)         | null                                                           | false    |               |                |
| auth                | refresh_tokens                  | 9                | session_id                         | uuid                           | null                                                           | false    |               |                |
| auth                | saml_providers                  | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | saml_providers                  | 2                | sso_provider_id                    | uuid                           | null                                                           | true     |               |                |
| auth                | saml_providers                  | 3                | entity_id                          | text                           | null                                                           | true     |               |                |
| auth                | saml_providers                  | 4                | metadata_xml                       | text                           | null                                                           | true     |               |                |
| auth                | saml_providers                  | 5                | metadata_url                       | text                           | null                                                           | false    |               |                |
| auth                | saml_providers                  | 6                | attribute_mapping                  | jsonb                          | null                                                           | false    |               |                |
| auth                | saml_providers                  | 7                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | saml_providers                  | 8                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | saml_providers                  | 9                | name_id_format                     | text                           | null                                                           | false    |               |                |
| auth                | saml_relay_states               | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | saml_relay_states               | 2                | sso_provider_id                    | uuid                           | null                                                           | true     |               |                |
| auth                | saml_relay_states               | 3                | request_id                         | text                           | null                                                           | true     |               |                |
| auth                | saml_relay_states               | 4                | for_email                          | text                           | null                                                           | false    |               |                |
| auth                | saml_relay_states               | 5                | redirect_to                        | text                           | null                                                           | false    |               |                |
| auth                | saml_relay_states               | 7                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | saml_relay_states               | 8                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | saml_relay_states               | 9                | flow_state_id                      | uuid                           | null                                                           | false    |               |                |
| auth                | schema_migrations               | 1                | version                            | character varying(255)         | null                                                           | true     |               |                |
| auth                | sessions                        | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | sessions                        | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| auth                | sessions                        | 3                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | sessions                        | 4                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | sessions                        | 5                | factor_id                          | uuid                           | null                                                           | false    |               |                |
| auth                | sessions                        | 6                | aal                                | auth.aal_level                 | null                                                           | false    |               |                |
| auth                | sessions                        | 7                | not_after                          | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | sessions                        | 8                | refreshed_at                       | timestamp without time zone    | null                                                           | false    |               |                |
| auth                | sessions                        | 9                | user_agent                         | text                           | null                                                           | false    |               |                |
| auth                | sessions                        | 10               | ip                                 | inet                           | null                                                           | false    |               |                |
| auth                | sessions                        | 11               | tag                                | text                           | null                                                           | false    |               |                |
| auth                | sso_domains                     | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | sso_domains                     | 2                | sso_provider_id                    | uuid                           | null                                                           | true     |               |                |
| auth                | sso_domains                     | 3                | domain                             | text                           | null                                                           | true     |               |                |
| auth                | sso_domains                     | 4                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | sso_domains                     | 5                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | sso_providers                   | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | sso_providers                   | 2                | resource_id                        | text                           | null                                                           | false    |               |                |
| auth                | sso_providers                   | 3                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | sso_providers                   | 4                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | sso_providers                   | 5                | disabled                           | boolean                        | null                                                           | false    |               |                |
| auth                | users                           | 1                | instance_id                        | uuid                           | null                                                           | false    |               |                |
| auth                | users                           | 2                | id                                 | uuid                           | null                                                           | true     |               |                |
| auth                | users                           | 3                | aud                                | character varying(255)         | null                                                           | false    |               |                |
| auth                | users                           | 4                | role                               | character varying(255)         | null                                                           | false    |               |                |
| auth                | users                           | 5                | email                              | character varying(255)         | null                                                           | false    |               |                |
| auth                | users                           | 6                | encrypted_password                 | character varying(255)         | null                                                           | false    |               |                |
| auth                | users                           | 7                | email_confirmed_at                 | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 8                | invited_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 9                | confirmation_token                 | character varying(255)         | null                                                           | false    |               |                |
| auth                | users                           | 10               | confirmation_sent_at               | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 11               | recovery_token                     | character varying(255)         | null                                                           | false    |               |                |
| auth                | users                           | 12               | recovery_sent_at                   | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 13               | email_change_token_new             | character varying(255)         | null                                                           | false    |               |                |
| auth                | users                           | 14               | email_change                       | character varying(255)         | null                                                           | false    |               |                |
| auth                | users                           | 15               | email_change_sent_at               | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 16               | last_sign_in_at                    | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 17               | raw_app_meta_data                  | jsonb                          | null                                                           | false    |               |                |
| auth                | users                           | 18               | raw_user_meta_data                 | jsonb                          | null                                                           | false    |               |                |
| auth                | users                           | 19               | is_super_admin                     | boolean                        | null                                                           | false    |               |                |
| auth                | users                           | 20               | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 21               | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 22               | phone                              | text                           | NULL::character varying                                        | false    |               |                |
| auth                | users                           | 23               | phone_confirmed_at                 | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 24               | phone_change                       | text                           | ''::character varying                                          | false    |               |                |
| auth                | users                           | 25               | phone_change_token                 | character varying(255)         | ''::character varying                                          | false    |               |                |
| auth                | users                           | 26               | phone_change_sent_at               | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 27               | confirmed_at                       | timestamp with time zone       | LEAST(email_confirmed_at, phone_confirmed_at)                  | false    |               | s              |
| auth                | users                           | 28               | email_change_token_current         | character varying(255)         | ''::character varying                                          | false    |               |                |
| auth                | users                           | 29               | email_change_confirm_status        | smallint                       | 0                                                              | false    |               |                |
| auth                | users                           | 30               | banned_until                       | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 31               | reauthentication_token             | character varying(255)         | ''::character varying                                          | false    |               |                |
| auth                | users                           | 32               | reauthentication_sent_at           | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 33               | is_sso_user                        | boolean                        | false                                                          | true     |               |                |
| auth                | users                           | 34               | deleted_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| auth                | users                           | 35               | is_anonymous                       | boolean                        | false                                                          | true     |               |                |
| clinical            | ai_insights_cards               | 1                | insight_id                         | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | ai_insights_cards               | 2                | clinician_id                       | uuid                           | null                                                           | true     |               |                |
| clinical            | ai_insights_cards               | 3                | title                              | text                           | null                                                           | true     |               |                |
| clinical            | ai_insights_cards               | 4                | content                            | text                           | null                                                           | true     |               |                |
| clinical            | ai_insights_cards               | 5                | insight_type                       | text                           | null                                                           | true     |               |                |
| clinical            | ai_insights_cards               | 6                | impact_metric                      | jsonb                          | null                                                           | false    |               |                |
| clinical            | ai_insights_cards               | 7                | ai_model_version                   | text                           | null                                                           | false    |               |                |
| clinical            | ai_insights_cards               | 8                | confidence_score                   | numeric(5,2)                   | null                                                           | false    |               |                |
| clinical            | ai_insights_cards               | 9                | is_read                            | boolean                        | false                                                          | false    |               |                |
| clinical            | ai_insights_cards               | 10               | is_dismissed                       | boolean                        | false                                                          | false    |               |                |
| clinical            | ai_insights_cards               | 11               | is_pinned                          | boolean                        | false                                                          | false    |               |                |
| clinical            | ai_insights_cards               | 12               | has_action                         | boolean                        | false                                                          | false    |               |                |
| clinical            | ai_insights_cards               | 13               | action_url                         | text                           | null                                                           | false    |               |                |
| clinical            | ai_insights_cards               | 14               | action_taken                       | boolean                        | false                                                          | false    |               |                |
| clinical            | ai_insights_cards               | 15               | generated_at                       | timestamp with time zone       | now()                                                          | true     |               |                |
| clinical            | ai_insights_cards               | 16               | read_at                            | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | ai_insights_cards               | 17               | dismissed_at                       | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | case_data_panels                | 1                | panel_id                           | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | case_data_panels                | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| clinical            | case_data_panels                | 3                | panel_type                         | text                           | null                                                           | true     |               |                |
| clinical            | case_data_panels                | 4                | custom_panel_name                  | text                           | null                                                           | false    |               |                |
| clinical            | case_data_panels                | 5                | title                              | text                           | null                                                           | true     |               |                |
| clinical            | case_data_panels                | 6                | content                            | jsonb                          | null                                                           | true     |               |                |
| clinical            | case_data_panels                | 7                | display_order                      | integer                        | 0                                                              | false    |               |                |
| clinical            | case_data_panels                | 8                | is_visible                         | boolean                        | true                                                           | false    |               |                |
| clinical            | case_data_panels                | 9                | is_collapsed                       | boolean                        | false                                                          | false    |               |                |
| clinical            | case_data_panels                | 10               | priority_score                     | numeric(5,2)                   | null                                                           | false    |               |                |
| clinical            | case_data_panels                | 11               | added_at                           | timestamp with time zone       | now()                                                          | true     |               |                |
| clinical            | case_data_panels                | 12               | added_by                           | uuid                           | null                                                           | false    |               |                |
| clinical            | case_data_panels                | 13               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | clinical_notes_exports          | 1                | note_id                            | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | clinical_notes_exports          | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| clinical            | clinical_notes_exports          | 3                | note_type                          | text                           | null                                                           | true     |               |                |
| clinical            | clinical_notes_exports          | 4                | content                            | text                           | null                                                           | true     |               |                |
| clinical            | clinical_notes_exports          | 5                | format                             | text                           | null                                                           | true     |               |                |
| clinical            | clinical_notes_exports          | 6                | file_path                          | text                           | null                                                           | false    |               |                |
| clinical            | clinical_notes_exports          | 7                | status                             | text                           | 'draft'::text                                                  | false    |               |                |
| clinical            | clinical_notes_exports          | 8                | author_id                          | uuid                           | null                                                           | true     |               |                |
| clinical            | clinical_notes_exports          | 9                | signed_by                          | uuid                           | null                                                           | false    |               |                |
| clinical            | clinical_notes_exports          | 10               | signed_at                          | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | clinical_notes_exports          | 11               | digital_signature                  | text                           | null                                                           | false    |               |                |
| clinical            | clinical_notes_exports          | 12               | shared_with                        | uuid[]                         | ARRAY[]::uuid[]                                                | false    |               |                |
| clinical            | clinical_notes_exports          | 13               | shared_at                          | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | clinical_notes_exports          | 14               | visit_date                         | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | clinical_notes_exports          | 15               | generated_at                       | timestamp with time zone       | now()                                                          | true     |               |                |
| clinical            | clinical_notes_exports          | 16               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | clinical_scale_results          | 1                | scale_id                           | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | clinical_scale_results          | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| clinical            | clinical_scale_results          | 3                | scale_type                         | text                           | null                                                           | true     |               |                |
| clinical            | clinical_scale_results          | 4                | scale_version                      | text                           | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 5                | total_score                        | numeric(10,2)                  | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 6                | subscale_scores                    | jsonb                          | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 7                | assessed_at                        | timestamp with time zone       | null                                                           | true     |               |                |
| clinical            | clinical_scale_results          | 8                | due_at                             | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 9                | change_from_baseline               | numeric(10,2)                  | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 10               | change_alert                       | boolean                        | false                                                          | false    |               |                |
| clinical            | clinical_scale_results          | 11               | is_significant_change              | boolean                        | false                                                          | false    |               |                |
| clinical            | clinical_scale_results          | 12               | trend                              | jsonb                          | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 13               | assessed_by                        | uuid                           | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 14               | assessment_notes                   | text                           | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 15               | patient_condition                  | text                           | null                                                           | false    |               |                |
| clinical            | clinical_scale_results          | 16               | entered_by                         | uuid                           | null                                                           | true     |               |                |
| clinical            | clinical_scale_results          | 17               | entered_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | clinical_scale_results          | 18               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | clinician_today_view            | 1                | view_id                            | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | clinician_today_view            | 2                | clinician_id                       | uuid                           | null                                                           | true     |               |                |
| clinical            | clinician_today_view            | 3                | date                               | date                           | CURRENT_DATE                                                   | true     |               |                |
| clinical            | clinician_today_view            | 4                | appointments                       | jsonb                          | null                                                           | false    |               |                |
| clinical            | clinician_today_view            | 5                | alerts                             | jsonb                          | null                                                           | false    |               |                |
| clinical            | clinician_today_view            | 6                | high_priority_patients             | jsonb                          | null                                                           | false    |               |                |
| clinical            | clinician_today_view            | 7                | pending_tasks                      | jsonb                          | null                                                           | false    |               |                |
| clinical            | clinician_today_view            | 8                | layout_config                      | jsonb                          | null                                                           | false    |               |                |
| clinical            | clinician_today_view            | 9                | widget_order                       | integer[]                      | null                                                           | false    |               |                |
| clinical            | clinician_today_view            | 10               | last_refreshed                     | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | clinician_today_view            | 11               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | clinician_today_view            | 12               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | neuro_imaging_results           | 1                | image_id                           | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | neuro_imaging_results           | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| clinical            | neuro_imaging_results           | 3                | study_type                         | text                           | null                                                           | true     |               |                |
| clinical            | neuro_imaging_results           | 4                | study_protocol                     | text                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 5                | modality_details                   | text                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 6                | image_path                         | text                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 7                | dicom_uid                          | text                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 8                | file_size_mb                       | numeric(10,2)                  | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 9                | findings_summary                   | text                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 10               | impression                         | text                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 11               | annotations                        | jsonb                          | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 12               | critical_findings                  | boolean                        | false                                                          | false    |               |                |
| clinical            | neuro_imaging_results           | 13               | study_date                         | timestamp with time zone       | null                                                           | true     |               |                |
| clinical            | neuro_imaging_results           | 14               | radiologist                        | text                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 15               | ordering_physician                 | uuid                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 16               | ai_processed                       | boolean                        | false                                                          | false    |               |                |
| clinical            | neuro_imaging_results           | 17               | ai_findings                        | jsonb                          | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 18               | uploaded_at                        | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | neuro_imaging_results           | 19               | uploaded_by                        | uuid                           | null                                                           | false    |               |                |
| clinical            | neuro_imaging_results           | 20               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | patient_collab_chat             | 1                | message_id                         | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | patient_collab_chat             | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| clinical            | patient_collab_chat             | 3                | sender_id                          | uuid                           | null                                                           | true     |               |                |
| clinical            | patient_collab_chat             | 4                | message                            | text                           | null                                                           | true     |               |                |
| clinical            | patient_collab_chat             | 5                | thread_id                          | uuid                           | null                                                           | false    |               |                |
| clinical            | patient_collab_chat             | 6                | parent_message_id                  | uuid                           | null                                                           | false    |               |                |
| clinical            | patient_collab_chat             | 7                | attachments                        | jsonb                          | null                                                           | false    |               |                |
| clinical            | patient_collab_chat             | 8                | is_urgent                          | boolean                        | false                                                          | false    |               |                |
| clinical            | patient_collab_chat             | 9                | requires_response                  | boolean                        | false                                                          | false    |               |                |
| clinical            | patient_collab_chat             | 10               | is_read                            | boolean                        | false                                                          | false    |               |                |
| clinical            | patient_collab_chat             | 11               | read_by                            | uuid[]                         | ARRAY[]::uuid[]                                                | false    |               |                |
| clinical            | patient_collab_chat             | 12               | read_at                            | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | patient_collab_chat             | 13               | mentioned_users                    | uuid[]                         | ARRAY[]::uuid[]                                                | false    |               |                |
| clinical            | patient_collab_chat             | 14               | sent_at                            | timestamp with time zone       | now()                                                          | true     |               |                |
| clinical            | patient_collab_chat             | 15               | edited_at                          | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | patient_collab_chat             | 16               | deleted_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 1                | pro_id                             | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | patient_pro_timeline            | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| clinical            | patient_pro_timeline            | 3                | pro_type                           | text                           | null                                                           | true     |               |                |
| clinical            | patient_pro_timeline            | 4                | custom_type_name                   | text                           | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 5                | value                              | numeric(10,2)                  | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 6                | value_unit                         | text                           | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 7                | value_json                         | jsonb                          | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 8                | reported_at                        | timestamp with time zone       | now()                                                          | true     |               |                |
| clinical            | patient_pro_timeline            | 9                | collection_method                  | text                           | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 10               | linked_intervention                | uuid                           | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 11               | intervention_notes                 | text                           | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 12               | is_validated                       | boolean                        | false                                                          | false    |               |                |
| clinical            | patient_pro_timeline            | 13               | validated_by                       | uuid                           | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 14               | validation_notes                   | text                           | null                                                           | false    |               |                |
| clinical            | patient_pro_timeline            | 15               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | patient_pro_timeline            | 16               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | patient_risk_alerts             | 1                | alert_id                           | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | patient_risk_alerts             | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| clinical            | patient_risk_alerts             | 3                | risk_type                          | text                           | null                                                           | true     |               |                |
| clinical            | patient_risk_alerts             | 4                | alert_level                        | text                           | 'moderate'::text                                               | true     |               |                |
| clinical            | patient_risk_alerts             | 5                | score                              | numeric(5,2)                   | null                                                           | false    |               |                |
| clinical            | patient_risk_alerts             | 6                | reason                             | text                           | null                                                           | true     |               |                |
| clinical            | patient_risk_alerts             | 7                | context_data                       | jsonb                          | null                                                           | false    |               |                |
| clinical            | patient_risk_alerts             | 8                | status                             | text                           | 'unread'::text                                                 | false    |               |                |
| clinical            | patient_risk_alerts             | 9                | acknowledged_by                    | uuid                           | null                                                           | false    |               |                |
| clinical            | patient_risk_alerts             | 10               | acknowledged_at                    | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | patient_risk_alerts             | 11               | resolved_by                        | uuid                           | null                                                           | false    |               |                |
| clinical            | patient_risk_alerts             | 12               | resolved_at                        | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | patient_risk_alerts             | 13               | resolution_notes                   | text                           | null                                                           | false    |               |                |
| clinical            | patient_risk_alerts             | 14               | created_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| clinical            | patient_risk_alerts             | 15               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| clinical            | patient_snapshots               | 1                | snapshot_id                        | uuid                           | gen_random_uuid()                                              | true     |               |                |
| clinical            | patient_snapshots               | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| clinical            | patient_snapshots               | 3                | summary                            | text                           | null                                                           | true     |               |                |
| clinical            | patient_snapshots               | 4                | highlight_events                   | jsonb                          | null                                                           | false    |               |                |
| clinical            | patient_snapshots               | 5                | key_metrics                        | jsonb                          | null                                                           | false    |               |                |
| clinical            | patient_snapshots               | 6                | author                             | text                           | null                                                           | true     |               |                |
| clinical            | patient_snapshots               | 7                | author_id                          | uuid                           | null                                                           | false    |               |                |
| clinical            | patient_snapshots               | 8                | ai_model_version                   | text                           | null                                                           | false    |               |                |
| clinical            | patient_snapshots               | 9                | period_start                       | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | patient_snapshots               | 10               | period_end                         | timestamp with time zone       | null                                                           | false    |               |                |
| clinical            | patient_snapshots               | 11               | is_pinned                          | boolean                        | false                                                          | false    |               |                |
| clinical            | patient_snapshots               | 12               | is_archived                        | boolean                        | false                                                          | false    |               |                |
| clinical            | patient_snapshots               | 13               | generated_at                       | timestamp with time zone       | now()                                                          | true     |               |                |
| clinical            | patient_snapshots               | 14               | reviewed_by                        | uuid                           | null                                                           | false    |               |                |
| clinical            | patient_snapshots               | 15               | reviewed_at                        | timestamp with time zone       | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 1                | userid                             | oid                            | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 2                | dbid                               | oid                            | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 3                | toplevel                           | boolean                        | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 4                | queryid                            | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 5                | query                              | text                           | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 6                | plans                              | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 7                | total_plan_time                    | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 8                | min_plan_time                      | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 9                | max_plan_time                      | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 10               | mean_plan_time                     | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 11               | stddev_plan_time                   | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 12               | calls                              | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 13               | total_exec_time                    | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 14               | min_exec_time                      | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 15               | max_exec_time                      | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 16               | mean_exec_time                     | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 17               | stddev_exec_time                   | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 18               | rows                               | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 19               | shared_blks_hit                    | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 20               | shared_blks_read                   | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 21               | shared_blks_dirtied                | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 22               | shared_blks_written                | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 23               | local_blks_hit                     | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 24               | local_blks_read                    | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 25               | local_blks_dirtied                 | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 26               | local_blks_written                 | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 27               | temp_blks_read                     | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 28               | temp_blks_written                  | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 29               | shared_blk_read_time               | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 30               | shared_blk_write_time              | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 31               | local_blk_read_time                | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 32               | local_blk_write_time               | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 33               | temp_blk_read_time                 | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 34               | temp_blk_write_time                | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 35               | wal_records                        | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 36               | wal_fpi                            | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 37               | wal_bytes                          | numeric                        | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 38               | jit_functions                      | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 39               | jit_generation_time                | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 40               | jit_inlining_count                 | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 41               | jit_inlining_time                  | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 42               | jit_optimization_count             | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 43               | jit_optimization_time              | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 44               | jit_emission_count                 | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 45               | jit_emission_time                  | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 46               | jit_deform_count                   | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 47               | jit_deform_time                    | double precision               | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 48               | stats_since                        | timestamp with time zone       | null                                                           | false    |               |                |
| extensions          | pg_stat_statements              | 49               | minmax_stats_since                 | timestamp with time zone       | null                                                           | false    |               |                |
| extensions          | pg_stat_statements_info         | 1                | dealloc                            | bigint                         | null                                                           | false    |               |                |
| extensions          | pg_stat_statements_info         | 2                | stats_reset                        | timestamp with time zone       | null                                                           | false    |               |                |
| linkage             | research_id_map                 | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| linkage             | research_id_map                 | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| linkage             | research_id_map                 | 3                | research_id                        | uuid                           | gen_random_uuid()                                              | true     |               |                |
| linkage             | research_id_map                 | 4                | created_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| linkage             | research_id_map                 | 5                | created_by                         | uuid                           | null                                                           | false    |               |                |
| linkage             | research_id_map                 | 6                | last_accessed                      | timestamp with time zone       | null                                                           | false    |               |                |
| linkage             | research_id_map                 | 7                | access_count                       | integer                        | 0                                                              | false    |               |                |
| linkage             | research_id_map                 | 8                | irb_protocol_number                | text                           | null                                                           | false    |               |                |
| linkage             | research_id_map                 | 9                | consent_version                    | text                           | null                                                           | false    |               |                |
| linkage             | research_id_map                 | 10               | is_locked                          | boolean                        | false                                                          | false    |               |                |
| linkage             | research_id_map                 | 11               | notes                              | text                           | null                                                           | false    |               |                |
| private_health_info | clinical_media                  | 1                | media_id                           | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | clinical_media                  | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| private_health_info | clinical_media                  | 3                | parent_type                        | text                           | null                                                           | true     |               |                |
| private_health_info | clinical_media                  | 4                | parent_id                          | uuid                           | null                                                           | true     |               |                |
| private_health_info | clinical_media                  | 5                | file_url                           | text                           | null                                                           | true     |               |                |
| private_health_info | clinical_media                  | 6                | file_type                          | text                           | null                                                           | true     |               |                |
| private_health_info | clinical_media                  | 7                | file_size_mb                       | numeric(10,2)                  | null                                                           | false    |               |                |
| private_health_info | clinical_media                  | 8                | mime_type                          | text                           | null                                                           | false    |               |                |
| private_health_info | clinical_media                  | 9                | thumbnail_url                      | text                           | null                                                           | false    |               |                |
| private_health_info | clinical_media                  | 10               | duration_seconds                   | integer                        | null                                                           | false    |               |                |
| private_health_info | clinical_media                  | 11               | description                        | text                           | null                                                           | false    |               |                |
| private_health_info | clinical_media                  | 12               | tags                               | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | clinical_media                  | 13               | storage_bucket                     | text                           | 'phi-bucket'::text                                             | false    |               |                |
| private_health_info | clinical_media                  | 14               | storage_path                       | text                           | null                                                           | false    |               |                |
| private_health_info | clinical_media                  | 15               | shared_with_clinician              | boolean                        | true                                                           | false    |               |                |
| private_health_info | clinical_media                  | 16               | visible_to_researchers             | boolean                        | false                                                          | false    |               |                |
| private_health_info | clinical_media                  | 17               | uploaded_at                        | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | clinical_media                  | 18               | uploaded_by                        | uuid                           | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | clinician_onboarding_data       | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| private_health_info | clinician_onboarding_data       | 3                | first_name                         | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 4                | middle_name                        | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 5                | last_name                          | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 6                | clinician_title                    | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 7                | specialty                          | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 8                | institution                        | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 9                | license_number                     | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 10               | patient_invite_emails              | text[]                         | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 11               | completed_at                       | timestamp with time zone       | null                                                           | false    |               |                |
| private_health_info | clinician_onboarding_data       | 12               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | clinician_onboarding_data       | 13               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | clinician_onboarding_data       | 14               | onboarding_step                    | integer                        | 0                                                              | false    |               |                |
| private_health_info | clinician_onboarding_data       | 15               | last_updated_at                    | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | clinician_phi                   | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | clinician_phi                   | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| private_health_info | clinician_phi                   | 3                | npi_number                         | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 4                | dea_number                         | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 5                | license_number                     | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 6                | license_state                      | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 7                | license_expiry                     | date                           | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 8                | office_phone                       | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 9                | office_fax                         | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 10               | practice_address                   | jsonb                          | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 11               | medical_degree                     | text                           | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 12               | board_certifications               | text[]                         | null                                                           | false    |               |                |
| private_health_info | clinician_phi                   | 13               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | clinician_phi                   | 14               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | daily_symptom_logs              | 1                | log_id                             | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | daily_symptom_logs              | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| private_health_info | daily_symptom_logs              | 3                | log_date                           | date                           | null                                                           | true     |               |                |
| private_health_info | daily_symptom_logs              | 4                | overall_feeling                    | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 5                | mood                               | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 6                | energy_level                       | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 7                | fatigue_level                      | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 8                | pain_level                         | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 9                | sleep_quality                      | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 10               | sleep_hours                        | numeric(4,1)                   | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 11               | sleep_disturbances                 | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | daily_symptom_logs              | 12               | motor_fluctuations_occurred        | boolean                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 13               | on_time_hours                      | numeric(4,1)                   | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 14               | off_time_hours                     | numeric(4,1)                   | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 15               | dyskinesia_severity                | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 16               | stiffness_severity                 | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 17               | slowness_severity                  | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 18               | cognitive_issues                   | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | daily_symptom_logs              | 19               | mood_issues                        | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | daily_symptom_logs              | 20               | autonomic_symptoms                 | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | daily_symptom_logs              | 21               | adl_independence_level             | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 22               | activities_difficult               | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | daily_symptom_logs              | 23               | all_medications_taken              | boolean                        | true                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 24               | missed_doses                       | text                           | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 25               | medication_side_effects            | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | daily_symptom_logs              | 26               | other_symptoms                     | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | daily_symptom_logs              | 27               | symptom_notes                      | text                           | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 28               | stress_level                       | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 29               | exercise_minutes                   | integer                        | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 30               | notable_events                     | text                           | null                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 31               | shared_with_clinician              | boolean                        | true                                                           | false    |               |                |
| private_health_info | daily_symptom_logs              | 32               | visible_to_researchers             | boolean                        | false                                                          | false    |               |                |
| private_health_info | daily_symptom_logs              | 33               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | daily_symptom_logs              | 34               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | gait_episodes                   | 1                | gait_id                            | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | gait_episodes                   | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| private_health_info | gait_episodes                   | 3                | occurred_at                        | timestamp with time zone       | null                                                           | true     |               |                |
| private_health_info | gait_episodes                   | 4                | duration_seconds                   | integer                        | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 5                | event_type                         | text                           | null                                                           | true     |               |                |
| private_health_info | gait_episodes                   | 6                | severity                           | integer                        | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 7                | resulted_in_fall                   | boolean                        | false                                                          | false    |               |                |
| private_health_info | gait_episodes                   | 8                | fall_direction                     | text                           | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 9                | injury_occurred                    | boolean                        | false                                                          | false    |               |                |
| private_health_info | gait_episodes                   | 10               | injury_description                 | text                           | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 11               | required_assistance                | boolean                        | false                                                          | false    |               |                |
| private_health_info | gait_episodes                   | 12               | location                           | text                           | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 13               | activity                           | text                           | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 14               | environmental_factors              | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | gait_episodes                   | 15               | medication_status                  | text                           | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 16               | hours_since_medication             | integer                        | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 17               | freezing_trigger                   | text                           | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 18               | broke_freeze_with                  | text                           | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 19               | video_recorded                     | boolean                        | false                                                          | false    |               |                |
| private_health_info | gait_episodes                   | 20               | media_urls                         | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | gait_episodes                   | 21               | notes                              | text                           | null                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 22               | shared_with_clinician              | boolean                        | true                                                           | false    |               |                |
| private_health_info | gait_episodes                   | 23               | visible_to_researchers             | boolean                        | false                                                          | false    |               |                |
| private_health_info | gait_episodes                   | 24               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | gait_episodes                   | 25               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | patient_onboarding_data         | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | patient_onboarding_data         | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| private_health_info | patient_onboarding_data         | 3                | first_name                         | text                           | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 4                | middle_name                        | text                           | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 5                | last_name                          | text                           | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 6                | date_of_birth                      | date                           | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 7                | gender                             | gender_enum                    | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 8                | phone_number                       | text                           | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 9                | emergency_contact_name             | text                           | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 10               | emergency_contact_phone            | text                           | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 11               | emergency_contact_relationship     | text                           | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 12               | selected_conditions                | uuid[]                         | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 13               | track_menstrual_cycle              | boolean                        | false                                                          | false    |               |                |
| private_health_info | patient_onboarding_data         | 14               | share_research_data                | boolean                        | false                                                          | false    |               |                |
| private_health_info | patient_onboarding_data         | 15               | research_data_types                | research_data_type_enum[]      | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 16               | completed_at                       | timestamp with time zone       | null                                                           | false    |               |                |
| private_health_info | patient_onboarding_data         | 17               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | patient_onboarding_data         | 18               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | patient_onboarding_data         | 19               | onboarding_step                    | integer                        | 0                                                              | false    |               |                |
| private_health_info | patient_onboarding_data         | 20               | last_updated_at                    | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | patient_phi                     | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | patient_phi                     | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| private_health_info | patient_phi                     | 3                | date_of_birth                      | date                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 4                | social_security_number_encrypted   | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 5                | medical_record_number              | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 6                | gender                             | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 7                | ethnicity                          | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 8                | race                               | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 9                | primary_language                   | text                           | 'English'::text                                                | false    |               |                |
| private_health_info | patient_phi                     | 10               | preferred_pronouns                 | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 11               | home_address                       | jsonb                          | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 12               | phone_number                       | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 13               | emergency_contact_name             | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 14               | emergency_contact_phone            | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 15               | emergency_contact_relationship     | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 16               | primary_diagnosis                  | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 17               | diagnosis_date                     | date                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 18               | referring_physician                | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 19               | primary_care_physician             | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 20               | insurance_provider                 | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 21               | insurance_member_id                | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 22               | timezone                           | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 23               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | patient_phi                     | 24               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | patient_phi                     | 25               | medicare_number_encrypted          | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 26               | medicare_irn                       | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 27               | medicare_expiry                    | date                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 28               | dva_number_encrypted               | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 29               | private_health_insurer             | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 30               | private_health_member_id_encrypted | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 31               | aadhaar_number_encrypted           | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 32               | pan_number_encrypted               | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 33               | ayushman_bharat_id_encrypted       | text                           | null                                                           | false    |               |                |
| private_health_info | patient_phi                     | 34               | country_code                       | text                           | 'AU'::text                                                     | false    |               |                |
| private_health_info | patient_phi                     | 35               | national_health_id_encrypted       | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 1                | event_id                           | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | seizure_events                  | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| private_health_info | seizure_events                  | 3                | occurred_at                        | timestamp with time zone       | null                                                           | true     |               |                |
| private_health_info | seizure_events                  | 4                | duration_seconds                   | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 5                | seizure_type                       | text                           | null                                                           | true     |               |                |
| private_health_info | seizure_events                  | 6                | seizure_subtype                    | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 7                | severity                           | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 8                | consciousness_level                | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 9                | had_aura                           | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 10               | aura_signs                         | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | seizure_events                  | 11               | aura_description                   | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 12               | warning_time_seconds               | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 13               | possible_triggers                  | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | seizure_events                  | 14               | trigger_details                    | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 15               | body_parts_affected                | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | seizure_events                  | 16               | motor_symptoms                     | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | seizure_events                  | 17               | non_motor_symptoms                 | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | seizure_events                  | 18               | post_ictal_confusion               | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 19               | post_ictal_effects                 | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | seizure_events                  | 20               | post_ictal_duration_minutes        | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 21               | injuries_occurred                  | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 22               | injury_types                       | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | seizure_events                  | 23               | injury_description                 | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 24               | required_medical_attention         | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 25               | location                           | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 26               | activity_before                    | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 27               | witnessed                          | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 28               | witness_name                       | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 29               | witness_description                | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 30               | medication_taken_as_prescribed     | boolean                        | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 31               | hours_since_last_dose              | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 32               | recent_medication_changes          | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 33               | fully_recovered                    | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 34               | recovery_time_minutes              | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 35               | video_recorded                     | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 36               | media_urls                         | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | seizure_events                  | 37               | notes                              | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 38               | patient_concerns                   | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_events                  | 39               | shared_with_clinician              | boolean                        | true                                                           | false    |               |                |
| private_health_info | seizure_events                  | 40               | shared_with_carers                 | boolean                        | true                                                           | false    |               |                |
| private_health_info | seizure_events                  | 41               | visible_to_researchers             | boolean                        | false                                                          | false    |               |                |
| private_health_info | seizure_events                  | 42               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | seizure_events                  | 43               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | seizure_events                  | 44               | synced_to_clinician_at             | timestamp with time zone       | null                                                           | false    |               |                |
| private_health_info | seizure_generalized_assessment  | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | seizure_generalized_assessment  | 2                | log_id                             | uuid                           | null                                                           | true     |               |                |
| private_health_info | seizure_generalized_assessment  | 3                | assessment_type                    | assessment_type_enum           | null                                                           | true     |               |                |
| private_health_info | seizure_generalized_assessment  | 4                | classifier_basis                   | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_generalized_assessment  | 5                | confidence_score                   | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_generalized_assessment  | 6                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | seizure_log_brain_regions       | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | seizure_log_brain_regions       | 2                | log_id                             | uuid                           | null                                                           | true     |               |                |
| private_health_info | seizure_log_brain_regions       | 3                | region_id                          | integer                        | null                                                           | true     |               |                |
| private_health_info | seizure_log_brain_regions       | 4                | calculated_probability             | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_log_brain_regions       | 5                | probability_grade                  | probability_grade_enum         | null                                                           | false    |               |                |
| private_health_info | seizure_log_brain_regions       | 6                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | seizure_log_post_ictal_symptoms | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | seizure_log_post_ictal_symptoms | 2                | log_id                             | uuid                           | null                                                           | true     |               |                |
| private_health_info | seizure_log_post_ictal_symptoms | 3                | symptom                            | post_ictal_symptom_enum        | null                                                           | true     |               |                |
| private_health_info | seizure_log_post_ictal_symptoms | 4                | severity                           | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_log_post_ictal_symptoms | 5                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | seizure_log_signs               | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | seizure_log_signs               | 2                | log_id                             | uuid                           | null                                                           | true     |               |                |
| private_health_info | seizure_log_signs               | 3                | sign_id                            | integer                        | null                                                           | true     |               |                |
| private_health_info | seizure_log_signs               | 4                | present                            | yes_no_enum                    | 'YES'::yes_no_enum                                             | false    |               |                |
| private_health_info | seizure_log_signs               | 5                | observer_rank                      | witness_role_enum              | null                                                           | false    |               |                |
| private_health_info | seizure_log_signs               | 6                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | seizure_log_triggers            | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | seizure_log_triggers            | 2                | log_id                             | uuid                           | null                                                           | true     |               |                |
| private_health_info | seizure_log_triggers            | 3                | trigger_id                         | integer                        | null                                                           | true     |               |                |
| private_health_info | seizure_log_triggers            | 4                | trigger_strength                   | trigger_strength_enum          | null                                                           | false    |               |                |
| private_health_info | seizure_log_triggers            | 5                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | seizure_logs_research           | 1                | log_id                             | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | seizure_logs_research           | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| private_health_info | seizure_logs_research           | 3                | log_date                           | date                           | null                                                           | true     |               |                |
| private_health_info | seizure_logs_research           | 4                | log_time                           | time without time zone         | null                                                           | true     |               |                |
| private_health_info | seizure_logs_research           | 5                | seizure_type                       | seizure_type_enum              | null                                                           | true     |               |                |
| private_health_info | seizure_logs_research           | 6                | consciousness_level                | consciousness_level_enum       | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 7                | duration_seconds                   | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 8                | aura_present                       | yes_no_enum                    | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 9                | aura_description                   | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 10               | witnessed                          | yes_no_enum                    | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 11               | witness_role                       | witness_role_enum              | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 12               | video_recorded                     | yes_no_enum                    | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 13               | location_type                      | location_type_enum             | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 14               | post_ictal_confusion_minutes       | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 15               | recovery_time_minutes              | integer                        | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 16               | sleep_hours_prior                  | numeric(4,1)                   | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 17               | medication_adherence_prior         | medication_adherence_enum      | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 18               | stress_level                       | stress_level_enum              | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 19               | emergency_services_called          | yes_no_enum                    | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 20               | rescue_medication_used             | yes_no_enum                    | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 21               | rescue_medication_type             | rescue_medication_enum         | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 22               | hospitalized                       | yes_no_enum                    | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 23               | research_grade                     | yes_no_enum                    | 'YES'::yes_no_enum                                             | false    |               |                |
| private_health_info | seizure_logs_research           | 24               | notes                              | text                           | null                                                           | false    |               |                |
| private_health_info | seizure_logs_research           | 25               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | seizure_logs_research           | 26               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | tracking_entries                | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | tracking_entries                | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| private_health_info | tracking_entries                | 3                | tracking_type                      | tracking_feature_enum          | null                                                           | true     |               |                |
| private_health_info | tracking_entries                | 4                | entry_date                         | date                           | CURRENT_DATE                                                   | false    |               |                |
| private_health_info | tracking_entries                | 5                | value                              | numeric                        | null                                                           | false    |               |                |
| private_health_info | tracking_entries                | 6                | severity                           | integer                        | null                                                           | false    |               |                |
| private_health_info | tracking_entries                | 7                | notes                              | text                           | null                                                           | false    |               |                |
| private_health_info | tracking_entries                | 8                | metadata                           | jsonb                          | '{}'::jsonb                                                    | false    |               |                |
| private_health_info | tracking_entries                | 9                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | tracking_entries                | 10               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | tremor_episodes                 | 1                | tremor_id                          | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | tremor_episodes                 | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| private_health_info | tremor_episodes                 | 3                | occurred_at                        | timestamp with time zone       | null                                                           | true     |               |                |
| private_health_info | tremor_episodes                 | 4                | duration_seconds                   | integer                        | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 5                | tremor_type                        | text                           | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 6                | severity                           | integer                        | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 7                | frequency_hz                       | numeric(5,2)                   | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 8                | body_regions                       | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | tremor_episodes                 | 9                | dominant_side                      | text                           | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 10               | interfered_with_activities         | boolean                        | false                                                          | false    |               |                |
| private_health_info | tremor_episodes                 | 11               | activities_affected                | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | tremor_episodes                 | 12               | occurred_during                    | text                           | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 13               | medication_status                  | text                           | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 14               | hours_since_medication             | integer                        | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 15               | possible_triggers                  | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | tremor_episodes                 | 16               | trigger_details                    | text                           | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 17               | video_recorded                     | boolean                        | false                                                          | false    |               |                |
| private_health_info | tremor_episodes                 | 18               | media_urls                         | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| private_health_info | tremor_episodes                 | 19               | notes                              | text                           | null                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 20               | shared_with_clinician              | boolean                        | true                                                           | false    |               |                |
| private_health_info | tremor_episodes                 | 21               | visible_to_researchers             | boolean                        | false                                                          | false    |               |                |
| private_health_info | tremor_episodes                 | 22               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | tremor_episodes                 | 23               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | user_conditions                 | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | user_conditions                 | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| private_health_info | user_conditions                 | 3                | condition_id                       | uuid                           | null                                                           | true     |               |                |
| private_health_info | user_conditions                 | 4                | diagnosis_date                     | date                           | null                                                           | false    |               |                |
| private_health_info | user_conditions                 | 5                | severity                           | integer                        | null                                                           | false    |               |                |
| private_health_info | user_conditions                 | 6                | tracking_features_enabled          | tracking_feature_enum[]        | null                                                           | false    |               |                |
| private_health_info | user_conditions                 | 7                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| private_health_info | user_medications                | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| private_health_info | user_medications                | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| private_health_info | user_medications                | 3                | medication_id                      | uuid                           | null                                                           | false    |               |                |
| private_health_info | user_medications                | 4                | dosage_amount                      | numeric                        | null                                                           | false    |               |                |
| private_health_info | user_medications                | 5                | dosage_unit                        | text                           | null                                                           | false    |               |                |
| private_health_info | user_medications                | 6                | frequency                          | text                           | null                                                           | false    |               |                |
| private_health_info | user_medications                | 7                | start_date                         | date                           | null                                                           | false    |               |                |
| private_health_info | user_medications                | 8                | end_date                           | date                           | null                                                           | false    |               |                |
| private_health_info | user_medications                | 9                | is_active                          | boolean                        | true                                                           | false    |               |                |
| private_health_info | user_medications                | 10               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| protected           | system_settings                 | 1                | key                                | text                           | null                                                           | true     |               |                |
| protected           | system_settings                 | 2                | value                              | text                           | null                                                           | true     |               |                |
| protected           | system_settings                 | 3                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| protected           | system_settings                 | 4                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | achievements                    | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | achievements                    | 2                | name                               | text                           | null                                                           | true     |               |                |
| public              | achievements                    | 3                | description                        | text                           | null                                                           | false    |               |                |
| public              | achievements                    | 4                | icon                               | text                           | null                                                           | false    |               |                |
| public              | achievements                    | 5                | points                             | integer                        | 0                                                              | false    |               |                |
| public              | achievements                    | 6                | category                           | text                           | null                                                           | false    |               |                |
| public              | achievements                    | 7                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | audit_log                       | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | audit_log                       | 2                | user_id                            | uuid                           | null                                                           | false    |               |                |
| public              | audit_log                       | 3                | action                             | text                           | null                                                           | true     |               |                |
| public              | audit_log                       | 4                | table_name                         | text                           | null                                                           | false    |               |                |
| public              | audit_log                       | 5                | record_id                          | text                           | null                                                           | false    |               |                |
| public              | audit_log                       | 6                | old_values                         | jsonb                          | null                                                           | false    |               |                |
| public              | audit_log                       | 7                | new_values                         | jsonb                          | null                                                           | false    |               |                |
| public              | audit_log                       | 8                | ip_address_hash                    | text                           | null                                                           | false    |               |                |
| public              | audit_log                       | 9                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | brain_regions_reference         | 1                | region_id                          | integer                        | nextval('brain_regions_reference_region_id_seq'::regclass)     | true     |               |                |
| public              | brain_regions_reference         | 2                | lobe                               | brain_lobe_enum                | null                                                           | true     |               |                |
| public              | brain_regions_reference         | 3                | subregion                          | brain_subregion_enum           | null                                                           | false    |               |                |
| public              | brain_regions_reference         | 4                | laterality                         | laterality_enum                | 'BILATERAL'::laterality_enum                                   | false    |               |                |
| public              | brain_regions_reference         | 5                | display_name                       | text                           | null                                                           | true     |               |                |
| public              | brain_regions_reference         | 6                | function_description               | text                           | null                                                           | false    |               |                |
| public              | brain_regions_reference         | 7                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | carer_invitations               | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | carer_invitations               | 2                | relationship_id                    | uuid                           | null                                                           | true     |               |                |
| public              | carer_invitations               | 3                | patient_user_id                    | uuid                           | null                                                           | true     |               |                |
| public              | carer_invitations               | 4                | carer_email                        | text                           | null                                                           | true     |               |                |
| public              | carer_invitations               | 5                | carer_email_hash                   | text                           | null                                                           | true     |               |                |
| public              | carer_invitations               | 6                | invitation_token                   | text                           | encode(gen_random_bytes(32), 'hex'::text)                      | true     |               |                |
| public              | carer_invitations               | 7                | status                             | text                           | 'pending'::text                                                | false    |               |                |
| public              | carer_invitations               | 8                | dob_verification_attempts          | integer                        | 0                                                              | false    |               |                |
| public              | carer_invitations               | 9                | max_dob_attempts                   | integer                        | 3                                                              | false    |               |                |
| public              | carer_invitations               | 10               | last_verification_attempt          | timestamp with time zone       | null                                                           | false    |               |                |
| public              | carer_invitations               | 11               | invited_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | carer_invitations               | 12               | expires_at                         | timestamp with time zone       | (now() + '30 days'::interval)                                  | false    |               |                |
| public              | carer_invitations               | 13               | accepted_at                        | timestamp with time zone       | null                                                           | false    |               |                |
| public              | carer_invitations               | 14               | cancelled_at                       | timestamp with time zone       | null                                                           | false    |               |                |
| public              | carer_invitations               | 15               | carer_user_id                      | uuid                           | null                                                           | false    |               |                |
| public              | carer_invitations               | 16               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | carer_invitations               | 17               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | carer_onboarding_data           | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | carer_onboarding_data           | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | carer_onboarding_data           | 3                | first_name                         | text                           | null                                                           | false    |               |                |
| public              | carer_onboarding_data           | 4                | middle_name                        | text                           | null                                                           | false    |               |                |
| public              | carer_onboarding_data           | 5                | last_name                          | text                           | null                                                           | false    |               |                |
| public              | carer_onboarding_data           | 6                | completed_at                       | timestamp with time zone       | null                                                           | false    |               |                |
| public              | carer_onboarding_data           | 7                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | carer_onboarding_data           | 8                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | carer_profiles                  | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | carer_profiles                  | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | carer_profiles                  | 3                | preferred_contact_method           | text                           | 'email'::text                                                  | false    |               |                |
| public              | carer_profiles                  | 4                | availability_notes                 | text                           | null                                                           | false    |               |                |
| public              | carer_profiles                  | 5                | certifications                     | text[]                         | null                                                           | false    |               |                |
| public              | carer_profiles                  | 6                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | carer_profiles                  | 7                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | carer_relationships             | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | carer_relationships             | 2                | patient_user_id                    | uuid                           | null                                                           | true     |               |                |
| public              | carer_relationships             | 3                | carer_user_id                      | uuid                           | null                                                           | false    |               |                |
| public              | carer_relationships             | 4                | relationship_type                  | text                           | null                                                           | true     |               |                |
| public              | carer_relationships             | 5                | relationship_details               | text                           | null                                                           | false    |               |                |
| public              | carer_relationships             | 6                | status                             | text                           | 'pending'::text                                                | true     |               |                |
| public              | carer_relationships             | 7                | can_view_health_data               | boolean                        | true                                                           | false    |               |                |
| public              | carer_relationships             | 8                | can_receive_alerts                 | boolean                        | true                                                           | false    |               |                |
| public              | carer_relationships             | 9                | can_manage_appointments            | boolean                        | false                                                          | false    |               |                |
| public              | carer_relationships             | 10               | invited_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| public              | carer_relationships             | 11               | approved_at                        | timestamp with time zone       | null                                                           | false    |               |                |
| public              | carer_relationships             | 12               | terminated_at                      | timestamp with time zone       | null                                                           | false    |               |                |
| public              | carer_relationships             | 13               | termination_reason                 | text                           | null                                                           | false    |               |                |
| public              | carer_relationships             | 14               | created_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| public              | carer_relationships             | 15               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | clinician_profiles              | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | clinician_profiles              | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | clinician_profiles              | 3                | specialty                          | text                           | null                                                           | false    |               |                |
| public              | clinician_profiles              | 4                | sub_specialty                      | text                           | null                                                           | false    |               |                |
| public              | clinician_profiles              | 5                | institution                        | text                           | null                                                           | false    |               |                |
| public              | clinician_profiles              | 6                | department                         | text                           | null                                                           | false    |               |                |
| public              | clinician_profiles              | 7                | years_in_practice                  | integer                        | null                                                           | false    |               |                |
| public              | clinician_profiles              | 8                | patient_capacity                   | integer                        | 100                                                            | false    |               |                |
| public              | clinician_profiles              | 9                | accepting_new_patients             | boolean                        | true                                                           | false    |               |                |
| public              | clinician_profiles              | 10               | preferred_communication            | text                           | 'email'::text                                                  | false    |               |                |
| public              | clinician_profiles              | 11               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | clinician_profiles              | 12               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | conditions                      | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | conditions                      | 2                | name                               | text                           | null                                                           | true     |               |                |
| public              | conditions                      | 3                | category                           | text                           | null                                                           | false    |               |                |
| public              | conditions                      | 4                | description                        | text                           | null                                                           | false    |               |                |
| public              | conditions                      | 5                | snomed_code                        | text                           | null                                                           | false    |               |                |
| public              | conditions                      | 6                | icd10_code                         | text                           | null                                                           | false    |               |                |
| public              | conditions                      | 7                | tracking_features_array            | tracking_feature_enum[]        | null                                                           | false    |               |                |
| public              | conditions                      | 8                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | data_sharing_preferences        | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | data_sharing_preferences        | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| public              | data_sharing_preferences        | 3                | default_share_with_clinicians      | boolean                        | true                                                           | false    |               |                |
| public              | data_sharing_preferences        | 4                | default_share_with_carers          | boolean                        | true                                                           | false    |               |                |
| public              | data_sharing_preferences        | 5                | default_share_with_researchers     | boolean                        | false                                                          | false    |               |                |
| public              | data_sharing_preferences        | 6                | clinician_access_rules             | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| public              | data_sharing_preferences        | 7                | carer_access_rules                 | jsonb                          | '[]'::jsonb                                                    | false    |               |                |
| public              | data_sharing_preferences        | 8                | research_seizure_data              | boolean                        | false                                                          | false    |               |                |
| public              | data_sharing_preferences        | 9                | research_tremor_data               | boolean                        | false                                                          | false    |               |                |
| public              | data_sharing_preferences        | 10               | research_gait_data                 | boolean                        | false                                                          | false    |               |                |
| public              | data_sharing_preferences        | 11               | research_medication_data           | boolean                        | false                                                          | false    |               |                |
| public              | data_sharing_preferences        | 12               | research_symptom_data              | boolean                        | false                                                          | false    |               |                |
| public              | data_sharing_preferences        | 13               | research_imaging_data              | boolean                        | false                                                          | false    |               |                |
| public              | data_sharing_preferences        | 14               | research_demographic_data          | boolean                        | false                                                          | false    |               |                |
| public              | data_sharing_preferences        | 15               | seizure_events_visibility          | text                           | 'clinician_carer'::text                                        | false    |               |                |
| public              | data_sharing_preferences        | 16               | tremor_episodes_visibility         | text                           | 'clinician_carer'::text                                        | false    |               |                |
| public              | data_sharing_preferences        | 17               | gait_episodes_visibility           | text                           | 'clinician_carer'::text                                        | false    |               |                |
| public              | data_sharing_preferences        | 18               | daily_logs_visibility              | text                           | 'clinician_only'::text                                         | false    |               |                |
| public              | data_sharing_preferences        | 19               | medications_visibility             | text                           | 'clinician_carer'::text                                        | false    |               |                |
| public              | data_sharing_preferences        | 20               | media_visibility                   | text                           | 'clinician_only'::text                                         | false    |               |                |
| public              | data_sharing_preferences        | 21               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | data_sharing_preferences        | 22               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | medications                     | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | medications                     | 2                | name                               | text                           | null                                                           | true     |               |                |
| public              | medications                     | 3                | generic_name                       | text                           | null                                                           | false    |               |                |
| public              | medications                     | 4                | category                           | text                           | null                                                           | false    |               |                |
| public              | medications                     | 5                | rxnorm_code                        | text                           | null                                                           | false    |               |                |
| public              | medications                     | 6                | atc_code                           | text                           | null                                                           | false    |               |                |
| public              | medications                     | 7                | common_dosages                     | text                           | null                                                           | false    |               |                |
| public              | medications                     | 8                | contraindications                  | text[]                         | null                                                           | false    |               |                |
| public              | medications                     | 9                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | patient_clinician_connections   | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | patient_clinician_connections   | 2                | patient_id                         | uuid                           | null                                                           | true     |               |                |
| public              | patient_clinician_connections   | 3                | clinician_id                       | uuid                           | null                                                           | true     |               |                |
| public              | patient_clinician_connections   | 4                | status                             | text                           | 'pending'::text                                                | true     |               |                |
| public              | patient_clinician_connections   | 5                | access_level                       | text                           | 'full'::text                                                   | false    |               |                |
| public              | patient_clinician_connections   | 6                | access_expires_at                  | timestamp with time zone       | null                                                           | false    |               |                |
| public              | patient_clinician_connections   | 7                | connected_at                       | timestamp with time zone       | null                                                           | false    |               |                |
| public              | patient_clinician_connections   | 8                | approved_at                        | timestamp with time zone       | null                                                           | false    |               |                |
| public              | patient_clinician_connections   | 9                | terminated_at                      | timestamp with time zone       | null                                                           | false    |               |                |
| public              | patient_clinician_connections   | 10               | termination_reason                 | text                           | null                                                           | false    |               |                |
| public              | patient_clinician_connections   | 11               | created_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| public              | patient_clinician_connections   | 12               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | patient_invitations             | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | patient_invitations             | 2                | clinician_id                       | uuid                           | null                                                           | true     |               |                |
| public              | patient_invitations             | 3                | patient_email                      | text                           | null                                                           | true     |               |                |
| public              | patient_invitations             | 4                | patient_email_hash                 | text                           | null                                                           | true     |               |                |
| public              | patient_invitations             | 5                | invitation_token                   | text                           | encode(gen_random_bytes(32), 'hex'::text)                      | true     |               |                |
| public              | patient_invitations             | 6                | status                             | text                           | 'pending'::text                                                | false    |               |                |
| public              | patient_invitations             | 7                | patient_id                         | uuid                           | null                                                           | false    |               |                |
| public              | patient_invitations             | 8                | message                            | text                           | null                                                           | false    |               |                |
| public              | patient_invitations             | 9                | invited_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | patient_invitations             | 10               | expires_at                         | timestamp with time zone       | (now() + '7 days'::interval)                                   | false    |               |                |
| public              | patient_invitations             | 11               | accepted_at                        | timestamp with time zone       | null                                                           | false    |               |                |
| public              | patient_invitations             | 12               | cancelled_at                       | timestamp with time zone       | null                                                           | false    |               |                |
| public              | patient_invitations             | 13               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | patient_invitations             | 14               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | patient_profiles                | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | patient_profiles                | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | patient_profiles                | 3                | timezone                           | text                           | null                                                           | false    |               |                |
| public              | patient_profiles                | 4                | preferred_language                 | text                           | 'English'::text                                                | false    |               |                |
| public              | patient_profiles                | 5                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | patient_profiles                | 6                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | patient_profiles                | 7                | first_name                         | text                           | null                                                           | false    |               |                |
| public              | patient_profiles                | 8                | last_name                          | text                           | null                                                           | false    |               |                |
| public              | patient_profiles                | 9                | date_of_birth                      | date                           | null                                                           | false    |               |                |
| public              | patient_profiles                | 10               | gender                             | gender_enum                    | null                                                           | false    |               |                |
| public              | profiles                        | 1                | id                                 | uuid                           | null                                                           | true     |               |                |
| public              | profiles                        | 2                | user_type                          | user_type_enum                 | null                                                           | true     |               |                |
| public              | profiles                        | 3                | first_name                         | text                           | null                                                           | false    |               |                |
| public              | profiles                        | 4                | middle_name                        | text                           | null                                                           | false    |               |                |
| public              | profiles                        | 5                | last_name                          | text                           | null                                                           | false    |               |                |
| public              | profiles                        | 6                | email                              | text                           | null                                                           | false    |               |                |
| public              | profiles                        | 7                | phone_number                       | text                           | null                                                           | false    |               |                |
| public              | profiles                        | 8                | onboarding_completed               | boolean                        | false                                                          | false    |               |                |
| public              | profiles                        | 10               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | profiles                        | 11               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | research_consent                | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | research_consent                | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | research_consent                | 3                | data_type                          | research_data_type_enum        | null                                                           | true     |               |                |
| public              | research_consent                | 4                | consent_status                     | consent_status_enum            | 'pending'::consent_status_enum                                 | false    |               |                |
| public              | research_consent                | 5                | consent_given_at                   | timestamp with time zone       | null                                                           | false    |               |                |
| public              | research_consent                | 6                | consent_withdrawn_at               | timestamp with time zone       | null                                                           | false    |               |                |
| public              | research_consent                | 7                | consent_version                    | text                           | null                                                           | false    |               |                |
| public              | research_consent                | 8                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | researcher_onboarding_data      | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | researcher_onboarding_data      | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | researcher_onboarding_data      | 3                | first_name                         | text                           | null                                                           | false    |               |                |
| public              | researcher_onboarding_data      | 4                | middle_name                        | text                           | null                                                           | false    |               |                |
| public              | researcher_onboarding_data      | 5                | last_name                          | text                           | null                                                           | false    |               |                |
| public              | researcher_onboarding_data      | 6                | institution                        | text                           | null                                                           | false    |               |                |
| public              | researcher_onboarding_data      | 7                | research_focus                     | text                           | null                                                           | false    |               |                |
| public              | researcher_onboarding_data      | 8                | credentials                        | text                           | null                                                           | false    |               |                |
| public              | researcher_onboarding_data      | 9                | completed_at                       | timestamp with time zone       | null                                                           | false    |               |                |
| public              | researcher_onboarding_data      | 10               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | researcher_onboarding_data      | 11               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | researcher_profiles             | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | researcher_profiles             | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | researcher_profiles             | 3                | institution                        | text                           | null                                                           | false    |               |                |
| public              | researcher_profiles             | 4                | department                         | text                           | null                                                           | false    |               |                |
| public              | researcher_profiles             | 5                | research_focus                     | text                           | null                                                           | false    |               |                |
| public              | researcher_profiles             | 6                | credentials                        | text                           | null                                                           | false    |               |                |
| public              | researcher_profiles             | 7                | access_level                       | text                           | 'basic'::text                                                  | false    |               |                |
| public              | researcher_profiles             | 8                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | researcher_profiles             | 9                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | security_incidents              | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | security_incidents              | 2                | user_id                            | uuid                           | null                                                           | false    |               |                |
| public              | security_incidents              | 3                | incident_type                      | text                           | null                                                           | true     |               |                |
| public              | security_incidents              | 4                | severity                           | text                           | 'medium'::text                                                 | false    |               |                |
| public              | security_incidents              | 5                | description                        | text                           | null                                                           | false    |               |                |
| public              | security_incidents              | 6                | ip_address_hash                    | text                           | null                                                           | false    |               |                |
| public              | security_incidents              | 7                | user_agent                         | text                           | null                                                           | false    |               |                |
| public              | security_incidents              | 8                | resolved                           | boolean                        | false                                                          | false    |               |                |
| public              | security_incidents              | 9                | resolved_at                        | timestamp with time zone       | null                                                           | false    |               |                |
| public              | security_incidents              | 10               | resolved_by                        | uuid                           | null                                                           | false    |               |                |
| public              | security_incidents              | 11               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | security_incidents              | 12               | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | seizure_signs_reference         | 1                | sign_id                            | integer                        | nextval('seizure_signs_reference_sign_id_seq'::regclass)       | true     |               |                |
| public              | seizure_signs_reference         | 2                | sign_name                          | seizure_sign_enum              | null                                                           | true     |               |                |
| public              | seizure_signs_reference         | 3                | category                           | semiology_category_enum        | null                                                           | true     |               |                |
| public              | seizure_signs_reference         | 4                | display_name                       | text                           | null                                                           | true     |               |                |
| public              | seizure_signs_reference         | 5                | description                        | text                           | null                                                           | false    |               |                |
| public              | seizure_signs_reference         | 6                | research_code                      | text                           | null                                                           | false    |               |                |
| public              | seizure_signs_reference         | 7                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | seizure_triggers_reference      | 1                | trigger_id                         | integer                        | nextval('seizure_triggers_reference_trigger_id_seq'::regclass) | true     |               |                |
| public              | seizure_triggers_reference      | 2                | trigger_type                       | trigger_type_enum              | null                                                           | true     |               |                |
| public              | seizure_triggers_reference      | 3                | display_name                       | text                           | null                                                           | true     |               |                |
| public              | seizure_triggers_reference      | 4                | description                        | text                           | null                                                           | false    |               |                |
| public              | seizure_triggers_reference      | 5                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | sign_brain_region_mapping       | 1                | id                                 | integer                        | nextval('sign_brain_region_mapping_id_seq'::regclass)          | true     |               |                |
| public              | sign_brain_region_mapping       | 2                | sign_id                            | integer                        | null                                                           | true     |               |                |
| public              | sign_brain_region_mapping       | 3                | region_id                          | integer                        | null                                                           | true     |               |                |
| public              | sign_brain_region_mapping       | 4                | probability_grade                  | probability_grade_enum         | null                                                           | true     |               |                |
| public              | sign_brain_region_mapping       | 5                | probability_percentage             | integer                        | null                                                           | false    |               |                |
| public              | sign_brain_region_mapping       | 6                | research_basis                     | text                           | null                                                           | false    |               |                |
| public              | sign_brain_region_mapping       | 7                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | symptom_options                 | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | symptom_options                 | 2                | category                           | text                           | null                                                           | true     |               |                |
| public              | symptom_options                 | 3                | symptom_name                       | text                           | null                                                           | true     |               |                |
| public              | symptom_options                 | 4                | description                        | text                           | null                                                           | false    |               |                |
| public              | symptom_options                 | 5                | display_order                      | integer                        | 0                                                              | false    |               |                |
| public              | symptom_options                 | 6                | active                             | boolean                        | true                                                           | false    |               |                |
| public              | trigger_options                 | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | trigger_options                 | 2                | category                           | text                           | null                                                           | true     |               |                |
| public              | trigger_options                 | 3                | trigger_name                       | text                           | null                                                           | true     |               |                |
| public              | trigger_options                 | 4                | description                        | text                           | null                                                           | false    |               |                |
| public              | trigger_options                 | 5                | display_order                      | integer                        | 0                                                              | false    |               |                |
| public              | trigger_options                 | 6                | active                             | boolean                        | true                                                           | false    |               |                |
| public              | user_achievements               | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | user_achievements               | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | user_achievements               | 3                | achievement_id                     | uuid                           | null                                                           | true     |               |                |
| public              | user_achievements               | 4                | earned_at                          | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | user_points                     | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| public              | user_points                     | 2                | user_id                            | uuid                           | null                                                           | true     |               |                |
| public              | user_points                     | 3                | points                             | integer                        | 0                                                              | false    |               |                |
| public              | user_points                     | 4                | level                              | integer                        | 1                                                              | false    |               |                |
| public              | user_points                     | 5                | streak_days                        | integer                        | 0                                                              | false    |               |                |
| public              | user_points                     | 6                | last_activity_date                 | date                           | null                                                           | false    |               |                |
| public              | user_points                     | 7                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| public              | user_points                     | 8                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| realtime            | messages                        | 3                | topic                              | text                           | null                                                           | true     |               |                |
| realtime            | messages                        | 4                | extension                          | text                           | null                                                           | true     |               |                |
| realtime            | messages                        | 5                | payload                            | jsonb                          | null                                                           | false    |               |                |
| realtime            | messages                        | 6                | event                              | text                           | null                                                           | false    |               |                |
| realtime            | messages                        | 7                | private                            | boolean                        | false                                                          | false    |               |                |
| realtime            | messages                        | 8                | updated_at                         | timestamp without time zone    | now()                                                          | true     |               |                |
| realtime            | messages                        | 9                | inserted_at                        | timestamp without time zone    | now()                                                          | true     |               |                |
| realtime            | messages                        | 10               | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| realtime            | schema_migrations               | 1                | version                            | bigint                         | null                                                           | true     |               |                |
| realtime            | schema_migrations               | 2                | inserted_at                        | timestamp(0) without time zone | null                                                           | false    |               |                |
| realtime            | subscription                    | 1                | id                                 | bigint                         | null                                                           | true     | a             |                |
| realtime            | subscription                    | 2                | subscription_id                    | uuid                           | null                                                           | true     |               |                |
| realtime            | subscription                    | 4                | entity                             | regclass                       | null                                                           | true     |               |                |
| realtime            | subscription                    | 5                | filters                            | realtime.user_defined_filter[] | '{}'::realtime.user_defined_filter[]                           | true     |               |                |
| realtime            | subscription                    | 7                | claims                             | jsonb                          | null                                                           | true     |               |                |
| realtime            | subscription                    | 8                | claims_role                        | regrole                        | realtime.to_regrole((claims ->> 'role'::text))                 | true     |               | s              |
| realtime            | subscription                    | 9                | created_at                         | timestamp without time zone    | timezone('utc'::text, now())                                   | true     |               |                |
| research            | daily_symptom_logs              | 1                | log_id                             | uuid                           | gen_random_uuid()                                              | true     |               |                |
| research            | daily_symptom_logs              | 2                | research_id                        | uuid                           | null                                                           | true     |               |                |
| research            | daily_symptom_logs              | 3                | log_date                           | date                           | null                                                           | true     |               |                |
| research            | daily_symptom_logs              | 4                | overall_feeling                    | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 5                | mood                               | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 6                | energy_level                       | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 7                | fatigue_level                      | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 8                | pain_level                         | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 9                | sleep_quality                      | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 10               | sleep_hours                        | numeric(4,1)                   | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 11               | sleep_disturbances                 | jsonb                          | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 12               | motor_fluctuations_occurred        | boolean                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 13               | on_time_hours                      | numeric(4,1)                   | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 14               | off_time_hours                     | numeric(4,1)                   | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 15               | dyskinesia_severity                | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 16               | stiffness_severity                 | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 17               | slowness_severity                  | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 18               | cognitive_issues                   | jsonb                          | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 19               | mood_issues                        | jsonb                          | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 20               | autonomic_symptoms                 | jsonb                          | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 21               | adl_independence_level             | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 22               | activities_difficult               | jsonb                          | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 23               | all_medications_taken              | boolean                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 24               | medication_side_effects            | jsonb                          | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 25               | stress_level                       | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 26               | exercise_minutes                   | integer                        | null                                                           | false    |               |                |
| research            | daily_symptom_logs              | 27               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| research            | daily_symptom_logs              | 28               | source_log_id                      | uuid                           | null                                                           | false    |               |                |
| research            | gait_episodes                   | 1                | gait_id                            | uuid                           | gen_random_uuid()                                              | true     |               |                |
| research            | gait_episodes                   | 2                | research_id                        | uuid                           | null                                                           | true     |               |                |
| research            | gait_episodes                   | 3                | occurred_at_date                   | date                           | null                                                           | true     |               |                |
| research            | gait_episodes                   | 4                | occurred_at_hour                   | integer                        | null                                                           | false    |               |                |
| research            | gait_episodes                   | 5                | duration_seconds                   | integer                        | null                                                           | false    |               |                |
| research            | gait_episodes                   | 6                | event_type                         | text                           | null                                                           | true     |               |                |
| research            | gait_episodes                   | 7                | severity                           | integer                        | null                                                           | false    |               |                |
| research            | gait_episodes                   | 8                | resulted_in_fall                   | boolean                        | null                                                           | false    |               |                |
| research            | gait_episodes                   | 9                | fall_direction                     | text                           | null                                                           | false    |               |                |
| research            | gait_episodes                   | 10               | injury_occurred                    | boolean                        | null                                                           | false    |               |                |
| research            | gait_episodes                   | 11               | required_assistance                | boolean                        | null                                                           | false    |               |                |
| research            | gait_episodes                   | 12               | environmental_factors              | jsonb                          | null                                                           | false    |               |                |
| research            | gait_episodes                   | 13               | medication_status                  | text                           | null                                                           | false    |               |                |
| research            | gait_episodes                   | 14               | hours_since_medication             | integer                        | null                                                           | false    |               |                |
| research            | gait_episodes                   | 15               | freezing_trigger                   | text                           | null                                                           | false    |               |                |
| research            | gait_episodes                   | 16               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| research            | gait_episodes                   | 17               | source_gait_id                     | uuid                           | null                                                           | false    |               |                |
| research            | seizure_events                  | 1                | event_id                           | uuid                           | gen_random_uuid()                                              | true     |               |                |
| research            | seizure_events                  | 2                | research_id                        | uuid                           | null                                                           | true     |               |                |
| research            | seizure_events                  | 3                | occurred_at_date                   | date                           | null                                                           | true     |               |                |
| research            | seizure_events                  | 4                | occurred_at_hour                   | integer                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 5                | duration_seconds                   | integer                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 6                | seizure_type                       | text                           | null                                                           | true     |               |                |
| research            | seizure_events                  | 7                | severity                           | integer                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 8                | consciousness_level                | text                           | null                                                           | false    |               |                |
| research            | seizure_events                  | 9                | had_aura                           | boolean                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 10               | aura_signs                         | jsonb                          | null                                                           | false    |               |                |
| research            | seizure_events                  | 11               | possible_triggers                  | jsonb                          | null                                                           | false    |               |                |
| research            | seizure_events                  | 12               | body_parts_affected                | jsonb                          | null                                                           | false    |               |                |
| research            | seizure_events                  | 13               | motor_symptoms                     | jsonb                          | null                                                           | false    |               |                |
| research            | seizure_events                  | 14               | non_motor_symptoms                 | jsonb                          | null                                                           | false    |               |                |
| research            | seizure_events                  | 15               | post_ictal_effects                 | jsonb                          | null                                                           | false    |               |                |
| research            | seizure_events                  | 16               | post_ictal_duration_minutes        | integer                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 17               | injuries_occurred                  | boolean                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 18               | injury_types                       | jsonb                          | null                                                           | false    |               |                |
| research            | seizure_events                  | 19               | required_medical_attention         | boolean                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 20               | witnessed                          | boolean                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 21               | medication_taken_as_prescribed     | boolean                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 22               | hours_since_last_dose              | integer                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 23               | recent_medication_changes          | boolean                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 24               | fully_recovered                    | boolean                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 25               | recovery_time_minutes              | integer                        | null                                                           | false    |               |                |
| research            | seizure_events                  | 26               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| research            | seizure_events                  | 27               | source_event_id                    | uuid                           | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 1                | tremor_id                          | uuid                           | gen_random_uuid()                                              | true     |               |                |
| research            | tremor_episodes                 | 2                | research_id                        | uuid                           | null                                                           | true     |               |                |
| research            | tremor_episodes                 | 3                | occurred_at_date                   | date                           | null                                                           | true     |               |                |
| research            | tremor_episodes                 | 4                | occurred_at_hour                   | integer                        | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 5                | duration_seconds                   | integer                        | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 6                | tremor_type                        | text                           | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 7                | severity                           | integer                        | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 8                | frequency_hz                       | numeric(5,2)                   | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 9                | body_regions                       | jsonb                          | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 10               | dominant_side                      | text                           | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 11               | interfered_with_activities         | boolean                        | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 12               | activities_affected                | jsonb                          | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 13               | occurred_during                    | text                           | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 14               | medication_status                  | text                           | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 15               | hours_since_medication             | integer                        | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 16               | possible_triggers                  | jsonb                          | null                                                           | false    |               |                |
| research            | tremor_episodes                 | 17               | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| research            | tremor_episodes                 | 18               | source_tremor_id                   | uuid                           | null                                                           | false    |               |                |
| storage             | buckets                         | 1                | id                                 | text                           | null                                                           | true     |               |                |
| storage             | buckets                         | 2                | name                               | text                           | null                                                           | true     |               |                |
| storage             | buckets                         | 3                | owner                              | uuid                           | null                                                           | false    |               |                |
| storage             | buckets                         | 4                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| storage             | buckets                         | 5                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| storage             | buckets                         | 6                | public                             | boolean                        | false                                                          | false    |               |                |
| storage             | buckets                         | 7                | avif_autodetection                 | boolean                        | false                                                          | false    |               |                |
| storage             | buckets                         | 8                | file_size_limit                    | bigint                         | null                                                           | false    |               |                |
| storage             | buckets                         | 9                | allowed_mime_types                 | text[]                         | null                                                           | false    |               |                |
| storage             | buckets                         | 10               | owner_id                           | text                           | null                                                           | false    |               |                |
| storage             | buckets                         | 11               | type                               | storage.buckettype             | 'STANDARD'::storage.buckettype                                 | true     |               |                |
| storage             | buckets_analytics               | 1                | id                                 | text                           | null                                                           | true     |               |                |
| storage             | buckets_analytics               | 2                | type                               | storage.buckettype             | 'ANALYTICS'::storage.buckettype                                | true     |               |                |
| storage             | buckets_analytics               | 3                | format                             | text                           | 'ICEBERG'::text                                                | true     |               |                |
| storage             | buckets_analytics               | 4                | created_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| storage             | buckets_analytics               | 5                | updated_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| storage             | migrations                      | 1                | id                                 | integer                        | null                                                           | true     |               |                |
| storage             | migrations                      | 2                | name                               | character varying(100)         | null                                                           | true     |               |                |
| storage             | migrations                      | 3                | hash                               | character varying(40)          | null                                                           | true     |               |                |
| storage             | migrations                      | 4                | executed_at                        | timestamp without time zone    | CURRENT_TIMESTAMP                                              | false    |               |                |
| storage             | objects                         | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| storage             | objects                         | 2                | bucket_id                          | text                           | null                                                           | false    |               |                |
| storage             | objects                         | 3                | name                               | text                           | null                                                           | false    |               |                |
| storage             | objects                         | 4                | owner                              | uuid                           | null                                                           | false    |               |                |
| storage             | objects                         | 5                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| storage             | objects                         | 6                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| storage             | objects                         | 7                | last_accessed_at                   | timestamp with time zone       | now()                                                          | false    |               |                |
| storage             | objects                         | 8                | metadata                           | jsonb                          | null                                                           | false    |               |                |
| storage             | objects                         | 9                | path_tokens                        | text[]                         | string_to_array(name, '/'::text)                               | false    |               | s              |
| storage             | objects                         | 10               | version                            | text                           | null                                                           | false    |               |                |
| storage             | objects                         | 11               | owner_id                           | text                           | null                                                           | false    |               |                |
| storage             | objects                         | 12               | user_metadata                      | jsonb                          | null                                                           | false    |               |                |
| storage             | objects                         | 13               | level                              | integer                        | null                                                           | false    |               |                |
| storage             | prefixes                        | 1                | bucket_id                          | text                           | null                                                           | true     |               |                |
| storage             | prefixes                        | 2                | name                               | text                           | null                                                           | true     |               |                |
| storage             | prefixes                        | 3                | level                              | integer                        | storage.get_level(name)                                        | true     |               | s              |
| storage             | prefixes                        | 4                | created_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| storage             | prefixes                        | 5                | updated_at                         | timestamp with time zone       | now()                                                          | false    |               |                |
| storage             | s3_multipart_uploads            | 1                | id                                 | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads            | 2                | in_progress_size                   | bigint                         | 0                                                              | true     |               |                |
| storage             | s3_multipart_uploads            | 3                | upload_signature                   | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads            | 4                | bucket_id                          | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads            | 5                | key                                | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads            | 6                | version                            | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads            | 7                | owner_id                           | text                           | null                                                           | false    |               |                |
| storage             | s3_multipart_uploads            | 8                | created_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| storage             | s3_multipart_uploads            | 9                | user_metadata                      | jsonb                          | null                                                           | false    |               |                |
| storage             | s3_multipart_uploads_parts      | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| storage             | s3_multipart_uploads_parts      | 2                | upload_id                          | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads_parts      | 3                | size                               | bigint                         | 0                                                              | true     |               |                |
| storage             | s3_multipart_uploads_parts      | 4                | part_number                        | integer                        | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads_parts      | 5                | bucket_id                          | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads_parts      | 6                | key                                | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads_parts      | 7                | etag                               | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads_parts      | 8                | owner_id                           | text                           | null                                                           | false    |               |                |
| storage             | s3_multipart_uploads_parts      | 9                | version                            | text                           | null                                                           | true     |               |                |
| storage             | s3_multipart_uploads_parts      | 10               | created_at                         | timestamp with time zone       | now()                                                          | true     |               |                |
| supabase_migrations | schema_migrations               | 1                | version                            | text                           | null                                                           | true     |               |                |
| supabase_migrations | schema_migrations               | 2                | statements                         | text[]                         | null                                                           | false    |               |                |
| supabase_migrations | schema_migrations               | 3                | name                               | text                           | null                                                           | false    |               |                |
| supabase_migrations | schema_migrations               | 4                | created_by                         | text                           | null                                                           | false    |               |                |
| supabase_migrations | schema_migrations               | 5                | idempotency_key                    | text                           | null                                                           | false    |               |                |
| supabase_migrations | seed_files                      | 1                | path                               | text                           | null                                                           | true     |               |                |
| supabase_migrations | seed_files                      | 2                | hash                               | text                           | null                                                           | true     |               |                |
| vault               | decrypted_secrets               | 1                | id                                 | uuid                           | null                                                           | false    |               |                |
| vault               | decrypted_secrets               | 2                | name                               | text                           | null                                                           | false    |               |                |
| vault               | decrypted_secrets               | 3                | description                        | text                           | null                                                           | false    |               |                |
| vault               | decrypted_secrets               | 4                | secret                             | text                           | null                                                           | false    |               |                |
| vault               | decrypted_secrets               | 5                | decrypted_secret                   | text                           | null                                                           | false    |               |                |
| vault               | decrypted_secrets               | 6                | key_id                             | uuid                           | null                                                           | false    |               |                |
| vault               | decrypted_secrets               | 7                | nonce                              | bytea                          | null                                                           | false    |               |                |
| vault               | decrypted_secrets               | 8                | created_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| vault               | decrypted_secrets               | 9                | updated_at                         | timestamp with time zone       | null                                                           | false    |               |                |
| vault               | secrets                         | 1                | id                                 | uuid                           | gen_random_uuid()                                              | true     |               |                |
| vault               | secrets                         | 2                | name                               | text                           | null                                                           | false    |               |                |
| vault               | secrets                         | 3                | description                        | text                           | ''::text                                                       | true     |               |                |
| vault               | secrets                         | 4                | secret                             | text                           | null                                                           | true     |               |                |
| vault               | secrets                         | 5                | key_id                             | uuid                           | null                                                           | false    |               |                |
| vault               | secrets                         | 6                | nonce                              | bytea                          | vault._crypto_aead_det_noncegen()                              | false    |               |                |
| vault               | secrets                         | 7                | created_at                         | timestamp with time zone       | CURRENT_TIMESTAMP                                              | true     |               |                |
| vault               | secrets                         | 8                | updated_at                         | timestamp with time zone       | CURRENT_TIMESTAMP                                              | true     |               |                |





------

# Primary keys, unique constraints, and check constraints (all schemas)




| schema_name         | table_name                      | constraint_name                                           | constraint_type | definition                                                                                                                                                                                                                                                                    |
| ------------------- | ------------------------------- | --------------------------------------------------------- | --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| auth                | audit_log_entries               | audit_log_entries_pkey                                    | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | flow_state                      | flow_state_pkey                                           | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | identities                      | identities_pkey                                           | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | identities                      | identities_provider_id_provider_unique                    | u               | UNIQUE (provider_id, provider)                                                                                                                                                                                                                                                |
| auth                | instances                       | instances_pkey                                            | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | mfa_amr_claims                  | amr_id_pk                                                 | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | mfa_amr_claims                  | mfa_amr_claims_session_id_authentication_method_pkey      | u               | UNIQUE (session_id, authentication_method)                                                                                                                                                                                                                                    |
| auth                | mfa_challenges                  | mfa_challenges_pkey                                       | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | mfa_factors                     | mfa_factors_pkey                                          | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | mfa_factors                     | mfa_factors_last_challenged_at_key                        | u               | UNIQUE (last_challenged_at)                                                                                                                                                                                                                                                   |
| auth                | oauth_clients                   | oauth_clients_client_name_length                          | c               | CHECK ((char_length(client_name) <= 1024))                                                                                                                                                                                                                                    |
| auth                | oauth_clients                   | oauth_clients_client_uri_length                           | c               | CHECK ((char_length(client_uri) <= 2048))                                                                                                                                                                                                                                     |
| auth                | oauth_clients                   | oauth_clients_logo_uri_length                             | c               | CHECK ((char_length(logo_uri) <= 2048))                                                                                                                                                                                                                                       |
| auth                | oauth_clients                   | oauth_clients_pkey                                        | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | oauth_clients                   | oauth_clients_client_id_key                               | u               | UNIQUE (client_id)                                                                                                                                                                                                                                                            |
| auth                | one_time_tokens                 | one_time_tokens_token_hash_check                          | c               | CHECK ((char_length(token_hash) > 0))                                                                                                                                                                                                                                         |
| auth                | one_time_tokens                 | one_time_tokens_pkey                                      | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | refresh_tokens                  | refresh_tokens_pkey                                       | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | refresh_tokens                  | refresh_tokens_token_unique                               | u               | UNIQUE (token)                                                                                                                                                                                                                                                                |
| auth                | saml_providers                  | entity_id not empty                                       | c               | CHECK ((char_length(entity_id) > 0))                                                                                                                                                                                                                                          |
| auth                | saml_providers                  | metadata_url not empty                                    | c               | CHECK (((metadata_url = NULL::text) OR (char_length(metadata_url) > 0)))                                                                                                                                                                                                      |
| auth                | saml_providers                  | metadata_xml not empty                                    | c               | CHECK ((char_length(metadata_xml) > 0))                                                                                                                                                                                                                                       |
| auth                | saml_providers                  | saml_providers_pkey                                       | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | saml_providers                  | saml_providers_entity_id_key                              | u               | UNIQUE (entity_id)                                                                                                                                                                                                                                                            |
| auth                | saml_relay_states               | request_id not empty                                      | c               | CHECK ((char_length(request_id) > 0))                                                                                                                                                                                                                                         |
| auth                | saml_relay_states               | saml_relay_states_pkey                                    | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | schema_migrations               | schema_migrations_pkey                                    | p               | PRIMARY KEY (version)                                                                                                                                                                                                                                                         |
| auth                | sessions                        | sessions_pkey                                             | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | sso_domains                     | domain not empty                                          | c               | CHECK ((char_length(domain) > 0))                                                                                                                                                                                                                                             |
| auth                | sso_domains                     | sso_domains_pkey                                          | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | sso_providers                   | resource_id not empty                                     | c               | CHECK (((resource_id = NULL::text) OR (char_length(resource_id) > 0)))                                                                                                                                                                                                        |
| auth                | sso_providers                   | sso_providers_pkey                                        | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | users                           | users_email_change_confirm_status_check                   | c               | CHECK (((email_change_confirm_status >= 0) AND (email_change_confirm_status <= 2)))                                                                                                                                                                                           |
| auth                | users                           | users_pkey                                                | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| auth                | users                           | users_phone_key                                           | u               | UNIQUE (phone)                                                                                                                                                                                                                                                                |
| clinical            | ai_insights_cards               | ai_insights_cards_insight_type_check                      | c               | CHECK ((insight_type = ANY (ARRAY['did_you_know'::text, 'impact_metric'::text, 'best_practice'::text, 'alert'::text, 'recommendation'::text])))                                                                                                                               |
| clinical            | ai_insights_cards               | ai_insights_cards_pkey                                    | p               | PRIMARY KEY (insight_id)                                                                                                                                                                                                                                                      |
| clinical            | case_data_panels                | case_data_panels_panel_type_check                         | c               | CHECK ((panel_type = ANY (ARRAY['urgency'::text, 'ai_alerts'::text, 'trends'::text, 'intervention'::text, 'medications'::text, 'vitals'::text, 'labs'::text, 'custom'::text])))                                                                                               |
| clinical            | case_data_panels                | case_data_panels_pkey                                     | p               | PRIMARY KEY (panel_id)                                                                                                                                                                                                                                                        |
| clinical            | clinical_notes_exports          | clinical_notes_exports_format_check                       | c               | CHECK ((format = ANY (ARRAY['pdf'::text, 'docx'::text, 'html'::text, 'markdown'::text])))                                                                                                                                                                                     |
| clinical            | clinical_notes_exports          | clinical_notes_exports_note_type_check                    | c               | CHECK ((note_type = ANY (ARRAY['progress_note'::text, 'consult_letter'::text, 'discharge_summary'::text, 'referral'::text, 'procedure_note'::text, 'other'::text])))                                                                                                          |
| clinical            | clinical_notes_exports          | clinical_notes_exports_status_check                       | c               | CHECK ((status = ANY (ARRAY['draft'::text, 'finalized'::text, 'signed'::text, 'shared'::text, 'archived'::text])))                                                                                                                                                            |
| clinical            | clinical_notes_exports          | clinical_notes_exports_pkey                               | p               | PRIMARY KEY (note_id)                                                                                                                                                                                                                                                         |
| clinical            | clinical_scale_results          | clinical_scale_results_scale_type_check                   | c               | CHECK ((scale_type = ANY (ARRAY['MDS-UPDRS'::text, 'MoCA'::text, 'NIHSS'::text, 'MMSE'::text, 'PDQ-39'::text, 'HAMD'::text, 'HAMA'::text, 'EDSS'::text, 'Other'::text])))                                                                                                     |
| clinical            | clinical_scale_results          | clinical_scale_results_pkey                               | p               | PRIMARY KEY (scale_id)                                                                                                                                                                                                                                                        |
| clinical            | clinician_today_view            | clinician_today_view_pkey                                 | p               | PRIMARY KEY (view_id)                                                                                                                                                                                                                                                         |
| clinical            | clinician_today_view            | clinician_today_view_clinician_id_date_key                | u               | UNIQUE (clinician_id, date)                                                                                                                                                                                                                                                   |
| clinical            | neuro_imaging_results           | neuro_imaging_results_study_type_check                    | c               | CHECK ((study_type = ANY (ARRAY['MRI'::text, 'CT'::text, 'EEG'::text, 'PET'::text, 'SPECT'::text, 'DTI'::text, 'fMRI'::text, 'MEG'::text, 'SEEG'::text, 'Other'::text])))                                                                                                     |
| clinical            | neuro_imaging_results           | neuro_imaging_results_pkey                                | p               | PRIMARY KEY (image_id)                                                                                                                                                                                                                                                        |
| clinical            | neuro_imaging_results           | neuro_imaging_results_dicom_uid_key                       | u               | UNIQUE (dicom_uid)                                                                                                                                                                                                                                                            |
| clinical            | patient_collab_chat             | patient_collab_chat_pkey                                  | p               | PRIMARY KEY (message_id)                                                                                                                                                                                                                                                      |
| clinical            | patient_pro_timeline            | patient_pro_timeline_collection_method_check              | c               | CHECK ((collection_method = ANY (ARRAY['app'::text, 'wearable'::text, 'manual_entry'::text, 'survey'::text, 'voice'::text])))                                                                                                                                                 |
| clinical            | patient_pro_timeline            | patient_pro_timeline_pro_type_check                       | c               | CHECK ((pro_type = ANY (ARRAY['sleep'::text, 'mood'::text, 'pain'::text, 'fatigue'::text, 'falls'::text, 'side_effects'::text, 'anxiety'::text, 'depression'::text, 'quality_of_life'::text, 'custom'::text])))                                                               |
| clinical            | patient_pro_timeline            | patient_pro_timeline_pkey                                 | p               | PRIMARY KEY (pro_id)                                                                                                                                                                                                                                                          |
| clinical            | patient_risk_alerts             | patient_risk_alerts_alert_level_check                     | c               | CHECK ((alert_level = ANY (ARRAY['critical'::text, 'high'::text, 'moderate'::text, 'low'::text])))                                                                                                                                                                            |
| clinical            | patient_risk_alerts             | patient_risk_alerts_risk_type_check                       | c               | CHECK ((risk_type = ANY (ARRAY['seizure'::text, 'fall'::text, 'hospital'::text, 'med_failure'::text, 'cognitive_decline'::text, 'other'::text])))                                                                                                                             |
| clinical            | patient_risk_alerts             | patient_risk_alerts_status_check                          | c               | CHECK ((status = ANY (ARRAY['unread'::text, 'acknowledged'::text, 'in_progress'::text, 'resolved'::text, 'dismissed'::text])))                                                                                                                                                |
| clinical            | patient_risk_alerts             | patient_risk_alerts_pkey                                  | p               | PRIMARY KEY (alert_id)                                                                                                                                                                                                                                                        |
| clinical            | patient_snapshots               | patient_snapshots_author_check                            | c               | CHECK ((author = ANY (ARRAY['ai'::text, 'clinician'::text, 'hybrid'::text])))                                                                                                                                                                                                 |
| clinical            | patient_snapshots               | patient_snapshots_pkey                                    | p               | PRIMARY KEY (snapshot_id)                                                                                                                                                                                                                                                     |
| linkage             | research_id_map                 | research_id_map_pkey                                      | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| linkage             | research_id_map                 | research_id_map_research_id_key                           | u               | UNIQUE (research_id)                                                                                                                                                                                                                                                          |
| linkage             | research_id_map                 | research_id_map_user_id_key                               | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| private_health_info | clinical_media                  | clinical_media_file_type_check                            | c               | CHECK ((file_type = ANY (ARRAY['video'::text, 'photo'::text, 'audio'::text, 'document'::text])))                                                                                                                                                                              |
| private_health_info | clinical_media                  | clinical_media_parent_type_check                          | c               | CHECK ((parent_type = ANY (ARRAY['seizure_event'::text, 'tremor_episode'::text, 'gait_episode'::text, 'daily_log'::text, 'other'::text])))                                                                                                                                    |
| private_health_info | clinical_media                  | clinical_media_pkey                                       | p               | PRIMARY KEY (media_id)                                                                                                                                                                                                                                                        |
| private_health_info | clinician_onboarding_data       | clinician_onboarding_data_pkey                            | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | clinician_onboarding_data       | clinician_onboarding_data_user_id_key                     | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| private_health_info | clinician_phi                   | clinician_phi_pkey                                        | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | clinician_phi                   | clinician_phi_npi_number_key                              | u               | UNIQUE (npi_number)                                                                                                                                                                                                                                                           |
| private_health_info | clinician_phi                   | clinician_phi_user_id_key                                 | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_adl_independence_level_check           | c               | CHECK (((adl_independence_level >= 1) AND (adl_independence_level <= 10)))                                                                                                                                                                                                    |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_dyskinesia_severity_check              | c               | CHECK (((dyskinesia_severity >= 1) AND (dyskinesia_severity <= 10)))                                                                                                                                                                                                          |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_energy_level_check                     | c               | CHECK (((energy_level >= 1) AND (energy_level <= 10)))                                                                                                                                                                                                                        |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_fatigue_level_check                    | c               | CHECK (((fatigue_level >= 1) AND (fatigue_level <= 10)))                                                                                                                                                                                                                      |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_mood_check                             | c               | CHECK (((mood >= 1) AND (mood <= 10)))                                                                                                                                                                                                                                        |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_overall_feeling_check                  | c               | CHECK (((overall_feeling >= 1) AND (overall_feeling <= 10)))                                                                                                                                                                                                                  |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_pain_level_check                       | c               | CHECK (((pain_level >= 1) AND (pain_level <= 10)))                                                                                                                                                                                                                            |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_sleep_quality_check                    | c               | CHECK (((sleep_quality >= 1) AND (sleep_quality <= 10)))                                                                                                                                                                                                                      |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_slowness_severity_check                | c               | CHECK (((slowness_severity >= 1) AND (slowness_severity <= 10)))                                                                                                                                                                                                              |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_stiffness_severity_check               | c               | CHECK (((stiffness_severity >= 1) AND (stiffness_severity <= 10)))                                                                                                                                                                                                            |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_stress_level_check                     | c               | CHECK (((stress_level >= 1) AND (stress_level <= 10)))                                                                                                                                                                                                                        |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_pkey                                   | p               | PRIMARY KEY (log_id)                                                                                                                                                                                                                                                          |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_patient_id_log_date_key                | u               | UNIQUE (patient_id, log_date)                                                                                                                                                                                                                                                 |
| private_health_info | gait_episodes                   | gait_episodes_event_type_check                            | c               | CHECK ((event_type = ANY (ARRAY['freezing'::text, 'festination'::text, 'shuffling'::text, 'imbalance'::text, 'fall'::text, 'near_fall'::text, 'difficulty_turning'::text, 'difficulty_starting'::text, 'other'::text])))                                                      |
| private_health_info | gait_episodes                   | gait_episodes_fall_direction_check                        | c               | CHECK ((fall_direction = ANY (ARRAY['forward'::text, 'backward'::text, 'sideways_left'::text, 'sideways_right'::text, 'unknown'::text])))                                                                                                                                     |
| private_health_info | gait_episodes                   | gait_episodes_freezing_trigger_check                      | c               | CHECK ((freezing_trigger = ANY (ARRAY['doorway'::text, 'turn'::text, 'narrow_space'::text, 'dual_task'::text, 'anxiety'::text, 'crowded'::text, 'start_walking'::text, 'other'::text])))                                                                                      |
| private_health_info | gait_episodes                   | gait_episodes_medication_status_check                     | c               | CHECK ((medication_status = ANY (ARRAY['on'::text, 'off'::text, 'wearing_off'::text, 'unknown'::text])))                                                                                                                                                                      |
| private_health_info | gait_episodes                   | gait_episodes_severity_check                              | c               | CHECK (((severity >= 1) AND (severity <= 10)))                                                                                                                                                                                                                                |
| private_health_info | gait_episodes                   | gait_episodes_pkey                                        | p               | PRIMARY KEY (gait_id)                                                                                                                                                                                                                                                         |
| private_health_info | patient_onboarding_data         | patient_onboarding_data_pkey                              | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | patient_onboarding_data         | patient_onboarding_data_user_id_key                       | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| private_health_info | patient_phi                     | patient_phi_pkey                                          | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | patient_phi                     | patient_phi_user_id_key                                   | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| private_health_info | seizure_events                  | seizure_events_consciousness_level_check                  | c               | CHECK ((consciousness_level = ANY (ARRAY['fully_conscious'::text, 'impaired_awareness'::text, 'unconscious'::text, 'unknown'::text])))                                                                                                                                        |
| private_health_info | seizure_events                  | seizure_events_seizure_type_check                         | c               | CHECK ((seizure_type = ANY (ARRAY['absence'::text, 'tonic_clonic'::text, 'tonic'::text, 'clonic'::text, 'myoclonic'::text, 'atonic'::text, 'focal_aware'::text, 'focal_impaired_awareness'::text, 'focal_to_bilateral_tonic_clonic'::text, 'unknown'::text, 'other'::text]))) |
| private_health_info | seizure_events                  | seizure_events_severity_check                             | c               | CHECK (((severity >= 1) AND (severity <= 10)))                                                                                                                                                                                                                                |
| private_health_info | seizure_events                  | seizure_events_pkey                                       | p               | PRIMARY KEY (event_id)                                                                                                                                                                                                                                                        |
| private_health_info | seizure_generalized_assessment  | seizure_generalized_assessment_classifier_basis_check     | c               | CHECK ((char_length(classifier_basis) <= 255))                                                                                                                                                                                                                                |
| private_health_info | seizure_generalized_assessment  | seizure_generalized_assessment_confidence_score_check     | c               | CHECK (((confidence_score >= 0) AND (confidence_score <= 100)))                                                                                                                                                                                                               |
| private_health_info | seizure_generalized_assessment  | seizure_generalized_assessment_pkey                       | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | seizure_generalized_assessment  | seizure_generalized_assessment_log_id_key                 | u               | UNIQUE (log_id)                                                                                                                                                                                                                                                               |
| private_health_info | seizure_log_brain_regions       | seizure_log_brain_regions_calculated_probability_check    | c               | CHECK (((calculated_probability >= 0) AND (calculated_probability <= 100)))                                                                                                                                                                                                   |
| private_health_info | seizure_log_brain_regions       | seizure_log_brain_regions_pkey                            | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | seizure_log_brain_regions       | seizure_log_brain_regions_log_id_region_id_key            | u               | UNIQUE (log_id, region_id)                                                                                                                                                                                                                                                    |
| private_health_info | seizure_log_post_ictal_symptoms | seizure_log_post_ictal_symptoms_severity_check            | c               | CHECK (((severity >= 1) AND (severity <= 10)))                                                                                                                                                                                                                                |
| private_health_info | seizure_log_post_ictal_symptoms | seizure_log_post_ictal_symptoms_pkey                      | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | seizure_log_post_ictal_symptoms | seizure_log_post_ictal_symptoms_log_id_symptom_key        | u               | UNIQUE (log_id, symptom)                                                                                                                                                                                                                                                      |
| private_health_info | seizure_log_signs               | seizure_log_signs_pkey                                    | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | seizure_log_signs               | seizure_log_signs_log_id_sign_id_key                      | u               | UNIQUE (log_id, sign_id)                                                                                                                                                                                                                                                      |
| private_health_info | seizure_log_triggers            | seizure_log_triggers_pkey                                 | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | seizure_log_triggers            | seizure_log_triggers_log_id_trigger_id_key                | u               | UNIQUE (log_id, trigger_id)                                                                                                                                                                                                                                                   |
| private_health_info | seizure_logs_research           | seizure_logs_research_aura_description_check              | c               | CHECK ((char_length(aura_description) <= 255))                                                                                                                                                                                                                                |
| private_health_info | seizure_logs_research           | seizure_logs_research_notes_check                         | c               | CHECK ((char_length(notes) <= 255))                                                                                                                                                                                                                                           |
| private_health_info | seizure_logs_research           | seizure_logs_research_pkey                                | p               | PRIMARY KEY (log_id)                                                                                                                                                                                                                                                          |
| private_health_info | tracking_entries                | tracking_entries_severity_check                           | c               | CHECK (((severity >= 1) AND (severity <= 10)))                                                                                                                                                                                                                                |
| private_health_info | tracking_entries                | tracking_entries_pkey                                     | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | tremor_episodes                 | tremor_episodes_dominant_side_check                       | c               | CHECK ((dominant_side = ANY (ARRAY['left'::text, 'right'::text, 'bilateral'::text, 'none'::text])))                                                                                                                                                                           |
| private_health_info | tremor_episodes                 | tremor_episodes_medication_status_check                   | c               | CHECK ((medication_status = ANY (ARRAY['on'::text, 'off'::text, 'wearing_off'::text, 'unknown'::text])))                                                                                                                                                                      |
| private_health_info | tremor_episodes                 | tremor_episodes_occurred_during_check                     | c               | CHECK ((occurred_during = ANY (ARRAY['rest'::text, 'movement'::text, 'holding_position'::text, 'reaching'::text, 'writing'::text, 'eating'::text, 'other'::text])))                                                                                                           |
| private_health_info | tremor_episodes                 | tremor_episodes_severity_check                            | c               | CHECK (((severity >= 1) AND (severity <= 10)))                                                                                                                                                                                                                                |
| private_health_info | tremor_episodes                 | tremor_episodes_tremor_type_check                         | c               | CHECK ((tremor_type = ANY (ARRAY['resting'::text, 'action'::text, 'postural'::text, 'intention'::text, 'kinetic'::text, 'other'::text])))                                                                                                                                     |
| private_health_info | tremor_episodes                 | tremor_episodes_pkey                                      | p               | PRIMARY KEY (tremor_id)                                                                                                                                                                                                                                                       |
| private_health_info | user_conditions                 | user_conditions_severity_check                            | c               | CHECK (((severity >= 1) AND (severity <= 5)))                                                                                                                                                                                                                                 |
| private_health_info | user_conditions                 | user_conditions_pkey                                      | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| private_health_info | user_conditions                 | user_conditions_user_id_condition_id_key                  | u               | UNIQUE (user_id, condition_id)                                                                                                                                                                                                                                                |
| private_health_info | user_medications                | user_medications_pkey                                     | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| protected           | system_settings                 | system_settings_pkey                                      | p               | PRIMARY KEY (key)                                                                                                                                                                                                                                                             |
| public              | achievements                    | achievements_pkey                                         | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | achievements                    | achievements_name_key                                     | u               | UNIQUE (name)                                                                                                                                                                                                                                                                 |
| public              | audit_log                       | audit_log_pkey                                            | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | brain_regions_reference         | brain_regions_reference_pkey                              | p               | PRIMARY KEY (region_id)                                                                                                                                                                                                                                                       |
| public              | carer_invitations               | carer_invitations_status_check                            | c               | CHECK ((status = ANY (ARRAY['pending'::text, 'verification_required'::text, 'accepted'::text, 'expired'::text, 'cancelled'::text, 'verification_failed'::text])))                                                                                                             |
| public              | carer_invitations               | carer_invitations_pkey                                    | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | carer_invitations               | carer_invitations_invitation_token_key                    | u               | UNIQUE (invitation_token)                                                                                                                                                                                                                                                     |
| public              | carer_onboarding_data           | carer_onboarding_data_pkey                                | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | carer_onboarding_data           | carer_onboarding_data_user_id_key                         | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| public              | carer_profiles                  | carer_profiles_pkey                                       | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | carer_profiles                  | carer_profiles_user_id_key                                | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| public              | carer_relationships             | carer_relationships_relationship_type_check               | c               | CHECK ((relationship_type = ANY (ARRAY['parent'::text, 'spouse'::text, 'partner'::text, 'child'::text, 'sibling'::text, 'friend'::text, 'caregiver'::text, 'other'::text])))                                                                                                  |
| public              | carer_relationships             | carer_relationships_status_check                          | c               | CHECK ((status = ANY (ARRAY['pending'::text, 'active'::text, 'suspended'::text, 'terminated'::text])))                                                                                                                                                                        |
| public              | carer_relationships             | carer_relationships_pkey                                  | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | clinician_profiles              | clinician_profiles_pkey                                   | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | clinician_profiles              | clinician_profiles_user_id_key                            | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| public              | conditions                      | conditions_pkey                                           | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | data_sharing_preferences        | data_sharing_preferences_daily_logs_visibility_check      | c               | CHECK ((daily_logs_visibility = ANY (ARRAY['private'::text, 'clinician_only'::text, 'clinician_carer'::text, 'all'::text])))                                                                                                                                                  |
| public              | data_sharing_preferences        | data_sharing_preferences_gait_episodes_visibility_check   | c               | CHECK ((gait_episodes_visibility = ANY (ARRAY['private'::text, 'clinician_only'::text, 'clinician_carer'::text, 'all'::text])))                                                                                                                                               |
| public              | data_sharing_preferences        | data_sharing_preferences_media_visibility_check           | c               | CHECK ((media_visibility = ANY (ARRAY['private'::text, 'clinician_only'::text, 'clinician_carer'::text, 'all'::text])))                                                                                                                                                       |
| public              | data_sharing_preferences        | data_sharing_preferences_medications_visibility_check     | c               | CHECK ((medications_visibility = ANY (ARRAY['private'::text, 'clinician_only'::text, 'clinician_carer'::text, 'all'::text])))                                                                                                                                                 |
| public              | data_sharing_preferences        | data_sharing_preferences_seizure_events_visibility_check  | c               | CHECK ((seizure_events_visibility = ANY (ARRAY['private'::text, 'clinician_only'::text, 'clinician_carer'::text, 'all'::text])))                                                                                                                                              |
| public              | data_sharing_preferences        | data_sharing_preferences_tremor_episodes_visibility_check | c               | CHECK ((tremor_episodes_visibility = ANY (ARRAY['private'::text, 'clinician_only'::text, 'clinician_carer'::text, 'all'::text])))                                                                                                                                             |
| public              | data_sharing_preferences        | data_sharing_preferences_pkey                             | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | data_sharing_preferences        | data_sharing_preferences_patient_id_key                   | u               | UNIQUE (patient_id)                                                                                                                                                                                                                                                           |
| public              | medications                     | medications_pkey                                          | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | patient_clinician_connections   | patient_clinician_connections_access_level_check          | c               | CHECK ((access_level = ANY (ARRAY['full'::text, 'limited'::text, 'view_only'::text])))                                                                                                                                                                                        |
| public              | patient_clinician_connections   | patient_clinician_connections_status_check                | c               | CHECK ((status = ANY (ARRAY['pending'::text, 'active'::text, 'suspended'::text, 'terminated'::text])))                                                                                                                                                                        |
| public              | patient_clinician_connections   | patient_clinician_connections_pkey                        | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | patient_clinician_connections   | patient_clinician_connections_patient_id_clinician_id_key | u               | UNIQUE (patient_id, clinician_id)                                                                                                                                                                                                                                             |
| public              | patient_invitations             | patient_invitations_status_check                          | c               | CHECK ((status = ANY (ARRAY['pending'::text, 'accepted'::text, 'expired'::text, 'cancelled'::text])))                                                                                                                                                                         |
| public              | patient_invitations             | patient_invitations_pkey                                  | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | patient_invitations             | patient_invitations_invitation_token_key                  | u               | UNIQUE (invitation_token)                                                                                                                                                                                                                                                     |
| public              | patient_profiles                | patient_profiles_pkey                                     | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | patient_profiles                | patient_profiles_user_id_key                              | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| public              | profiles                        | profiles_pkey                                             | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | research_consent                | research_consent_pkey                                     | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | researcher_onboarding_data      | researcher_onboarding_data_pkey                           | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | researcher_onboarding_data      | researcher_onboarding_data_user_id_key                    | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| public              | researcher_profiles             | researcher_profiles_access_level_check                    | c               | CHECK ((access_level = ANY (ARRAY['basic'::text, 'advanced'::text, 'admin'::text])))                                                                                                                                                                                          |
| public              | researcher_profiles             | researcher_profiles_pkey                                  | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | researcher_profiles             | researcher_profiles_user_id_key                           | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| public              | security_incidents              | security_incidents_incident_type_check                    | c               | CHECK ((incident_type = ANY (ARRAY['suspicious_access'::text, 'excessive_queries'::text, 'failed_authentication'::text, 'data_breach_attempt'::text, 'unauthorized_access'::text, 'failed_dob_verification'::text, 'other'::text])))                                          |
| public              | security_incidents              | security_incidents_severity_check                         | c               | CHECK ((severity = ANY (ARRAY['low'::text, 'medium'::text, 'high'::text, 'critical'::text])))                                                                                                                                                                                 |
| public              | security_incidents              | security_incidents_pkey                                   | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | seizure_signs_reference         | seizure_signs_reference_pkey                              | p               | PRIMARY KEY (sign_id)                                                                                                                                                                                                                                                         |
| public              | seizure_signs_reference         | seizure_signs_reference_sign_name_key                     | u               | UNIQUE (sign_name)                                                                                                                                                                                                                                                            |
| public              | seizure_triggers_reference      | seizure_triggers_reference_pkey                           | p               | PRIMARY KEY (trigger_id)                                                                                                                                                                                                                                                      |
| public              | seizure_triggers_reference      | seizure_triggers_reference_trigger_type_key               | u               | UNIQUE (trigger_type)                                                                                                                                                                                                                                                         |
| public              | sign_brain_region_mapping       | sign_brain_region_mapping_probability_percentage_check    | c               | CHECK (((probability_percentage >= 0) AND (probability_percentage <= 100)))                                                                                                                                                                                                   |
| public              | sign_brain_region_mapping       | sign_brain_region_mapping_pkey                            | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | sign_brain_region_mapping       | sign_brain_region_mapping_sign_id_region_id_key           | u               | UNIQUE (sign_id, region_id)                                                                                                                                                                                                                                                   |
| public              | symptom_options                 | symptom_options_pkey                                      | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | trigger_options                 | trigger_options_pkey                                      | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | user_achievements               | user_achievements_pkey                                    | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | user_achievements               | user_achievements_user_id_achievement_id_key              | u               | UNIQUE (user_id, achievement_id)                                                                                                                                                                                                                                              |
| public              | user_points                     | user_points_pkey                                          | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| public              | user_points                     | user_points_user_id_key                                   | u               | UNIQUE (user_id)                                                                                                                                                                                                                                                              |
| realtime            | messages                        | messages_pkey                                             | p               | PRIMARY KEY (id, inserted_at)                                                                                                                                                                                                                                                 |
| realtime            | schema_migrations               | schema_migrations_pkey                                    | p               | PRIMARY KEY (version)                                                                                                                                                                                                                                                         |
| realtime            | subscription                    | pk_subscription                                           | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| research            | daily_symptom_logs              | daily_symptom_logs_pkey                                   | p               | PRIMARY KEY (log_id)                                                                                                                                                                                                                                                          |
| research            | daily_symptom_logs              | daily_symptom_logs_research_id_log_date_key               | u               | UNIQUE (research_id, log_date)                                                                                                                                                                                                                                                |
| research            | gait_episodes                   | gait_episodes_pkey                                        | p               | PRIMARY KEY (gait_id)                                                                                                                                                                                                                                                         |
| research            | seizure_events                  | seizure_events_pkey                                       | p               | PRIMARY KEY (event_id)                                                                                                                                                                                                                                                        |
| research            | tremor_episodes                 | tremor_episodes_pkey                                      | p               | PRIMARY KEY (tremor_id)                                                                                                                                                                                                                                                       |
| storage             | buckets                         | buckets_pkey                                              | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| storage             | buckets_analytics               | buckets_analytics_pkey                                    | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| storage             | migrations                      | migrations_pkey                                           | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| storage             | migrations                      | migrations_name_key                                       | u               | UNIQUE (name)                                                                                                                                                                                                                                                                 |
| storage             | objects                         | objects_pkey                                              | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| storage             | prefixes                        | prefixes_pkey                                             | p               | PRIMARY KEY (bucket_id, level, name)                                                                                                                                                                                                                                          |
| storage             | s3_multipart_uploads            | s3_multipart_uploads_pkey                                 | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| storage             | s3_multipart_uploads_parts      | s3_multipart_uploads_parts_pkey                           | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |
| supabase_migrations | schema_migrations               | schema_migrations_pkey                                    | p               | PRIMARY KEY (version)                                                                                                                                                                                                                                                         |
| supabase_migrations | schema_migrations               | schema_migrations_idempotency_key_key                     | u               | UNIQUE (idempotency_key)                                                                                                                                                                                                                                                      |
| supabase_migrations | seed_files                      | seed_files_pkey                                           | p               | PRIMARY KEY (path)                                                                                                                                                                                                                                                            |
| vault               | secrets                         | secrets_pkey                                              | p               | PRIMARY KEY (id)                                                                                                                                                                                                                                                              |






----------



# Foreign keys (all schemas)


| schema_name         | table_name                      | constraint_name                                 | fk_definition                                                                        | confmatchtype | confupdtype | confdeltype |
| ------------------- | ------------------------------- | ----------------------------------------------- | ------------------------------------------------------------------------------------ | ------------- | ----------- | ----------- |
| auth                | identities                      | identities_user_id_fkey                         | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| auth                | mfa_amr_claims                  | mfa_amr_claims_session_id_fkey                  | FOREIGN KEY (session_id) REFERENCES auth.sessions (id)                               | s             | a           | c           |
| auth                | mfa_challenges                  | mfa_challenges_auth_factor_id_fkey              | FOREIGN KEY (factor_id) REFERENCES auth.mfa_factors (id)                             | s             | a           | c           |
| auth                | mfa_factors                     | mfa_factors_user_id_fkey                        | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| auth                | one_time_tokens                 | one_time_tokens_user_id_fkey                    | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| auth                | refresh_tokens                  | refresh_tokens_session_id_fkey                  | FOREIGN KEY (session_id) REFERENCES auth.sessions (id)                               | s             | a           | c           |
| auth                | saml_providers                  | saml_providers_sso_provider_id_fkey             | FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers (id)                     | s             | a           | c           |
| auth                | saml_relay_states               | saml_relay_states_flow_state_id_fkey            | FOREIGN KEY (flow_state_id) REFERENCES auth.flow_state (id)                          | s             | a           | c           |
| auth                | saml_relay_states               | saml_relay_states_sso_provider_id_fkey          | FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers (id)                     | s             | a           | c           |
| auth                | sessions                        | sessions_user_id_fkey                           | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| auth                | sso_domains                     | sso_domains_sso_provider_id_fkey                | FOREIGN KEY (sso_provider_id) REFERENCES auth.sso_providers (id)                     | s             | a           | c           |
| clinical            | ai_insights_cards               | ai_insights_cards_clinician_id_fkey             | FOREIGN KEY (clinician_id) REFERENCES auth.users (id)                                | s             | a           | c           |
| clinical            | case_data_panels                | case_data_panels_added_by_fkey                  | FOREIGN KEY (added_by) REFERENCES auth.users (id)                                    | s             | a           | a           |
| clinical            | case_data_panels                | case_data_panels_patient_id_fkey                | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| clinical            | clinical_notes_exports          | clinical_notes_exports_author_id_fkey           | FOREIGN KEY (author_id) REFERENCES auth.users (id)                                   | s             | a           | a           |
| clinical            | clinical_notes_exports          | clinical_notes_exports_patient_id_fkey          | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| clinical            | clinical_notes_exports          | clinical_notes_exports_signed_by_fkey           | FOREIGN KEY (signed_by) REFERENCES auth.users (id)                                   | s             | a           | a           |
| clinical            | clinical_scale_results          | clinical_scale_results_assessed_by_fkey         | FOREIGN KEY (assessed_by) REFERENCES auth.users (id)                                 | s             | a           | a           |
| clinical            | clinical_scale_results          | clinical_scale_results_entered_by_fkey          | FOREIGN KEY (entered_by) REFERENCES auth.users (id)                                  | s             | a           | a           |
| clinical            | clinical_scale_results          | clinical_scale_results_patient_id_fkey          | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| clinical            | clinician_today_view            | clinician_today_view_clinician_id_fkey          | FOREIGN KEY (clinician_id) REFERENCES auth.users (id)                                | s             | a           | c           |
| clinical            | neuro_imaging_results           | neuro_imaging_results_ordering_physician_fkey   | FOREIGN KEY (ordering_physician) REFERENCES auth.users (id)                          | s             | a           | a           |
| clinical            | neuro_imaging_results           | neuro_imaging_results_patient_id_fkey           | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| clinical            | neuro_imaging_results           | neuro_imaging_results_uploaded_by_fkey          | FOREIGN KEY (uploaded_by) REFERENCES auth.users (id)                                 | s             | a           | a           |
| clinical            | patient_collab_chat             | patient_collab_chat_parent_message_id_fkey      | FOREIGN KEY (parent_message_id) REFERENCES clinical.patient_collab_chat (message_id) | s             | a           | a           |
| clinical            | patient_collab_chat             | patient_collab_chat_patient_id_fkey             | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| clinical            | patient_collab_chat             | patient_collab_chat_sender_id_fkey              | FOREIGN KEY (sender_id) REFERENCES auth.users (id)                                   | s             | a           | a           |
| clinical            | patient_pro_timeline            | patient_pro_timeline_patient_id_fkey            | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| clinical            | patient_pro_timeline            | patient_pro_timeline_validated_by_fkey          | FOREIGN KEY (validated_by) REFERENCES auth.users (id)                                | s             | a           | a           |
| clinical            | patient_risk_alerts             | patient_risk_alerts_acknowledged_by_fkey        | FOREIGN KEY (acknowledged_by) REFERENCES auth.users (id)                             | s             | a           | a           |
| clinical            | patient_risk_alerts             | patient_risk_alerts_patient_id_fkey             | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| clinical            | patient_risk_alerts             | patient_risk_alerts_resolved_by_fkey            | FOREIGN KEY (resolved_by) REFERENCES auth.users (id)                                 | s             | a           | a           |
| clinical            | patient_snapshots               | patient_snapshots_author_id_fkey                | FOREIGN KEY (author_id) REFERENCES auth.users (id)                                   | s             | a           | a           |
| clinical            | patient_snapshots               | patient_snapshots_patient_id_fkey               | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| clinical            | patient_snapshots               | patient_snapshots_reviewed_by_fkey              | FOREIGN KEY (reviewed_by) REFERENCES auth.users (id)                                 | s             | a           | a           |
| private_health_info | clinical_media                  | clinical_media_patient_id_fkey                  | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| private_health_info | clinical_media                  | clinical_media_uploaded_by_fkey                 | FOREIGN KEY (uploaded_by) REFERENCES auth.users (id)                                 | s             | a           | a           |
| private_health_info | clinician_onboarding_data       | clinician_onboarding_data_user_id_fkey          | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| private_health_info | clinician_phi                   | clinician_phi_user_id_fkey                      | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_patient_id_fkey              | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| private_health_info | gait_episodes                   | gait_episodes_patient_id_fkey                   | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| private_health_info | patient_onboarding_data         | patient_onboarding_data_user_id_fkey            | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| private_health_info | patient_phi                     | patient_phi_user_id_fkey                        | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| private_health_info | seizure_events                  | seizure_events_patient_id_fkey                  | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| private_health_info | seizure_generalized_assessment  | seizure_generalized_assessment_log_id_fkey      | FOREIGN KEY (log_id) REFERENCES private_health_info.seizure_logs_research (log_id)   | s             | a           | c           |
| private_health_info | seizure_log_brain_regions       | seizure_log_brain_regions_log_id_fkey           | FOREIGN KEY (log_id) REFERENCES private_health_info.seizure_logs_research (log_id)   | s             | a           | c           |
| private_health_info | seizure_log_brain_regions       | seizure_log_brain_regions_region_id_fkey        | FOREIGN KEY (region_id) REFERENCES public.brain_regions_reference (region_id)        | s             | a           | a           |
| private_health_info | seizure_log_post_ictal_symptoms | seizure_log_post_ictal_symptoms_log_id_fkey     | FOREIGN KEY (log_id) REFERENCES private_health_info.seizure_logs_research (log_id)   | s             | a           | c           |
| private_health_info | seizure_log_signs               | seizure_log_signs_log_id_fkey                   | FOREIGN KEY (log_id) REFERENCES private_health_info.seizure_logs_research (log_id)   | s             | a           | c           |
| private_health_info | seizure_log_signs               | seizure_log_signs_sign_id_fkey                  | FOREIGN KEY (sign_id) REFERENCES public.seizure_signs_reference (sign_id)            | s             | a           | a           |
| private_health_info | seizure_log_triggers            | seizure_log_triggers_log_id_fkey                | FOREIGN KEY (log_id) REFERENCES private_health_info.seizure_logs_research (log_id)   | s             | a           | c           |
| private_health_info | seizure_log_triggers            | seizure_log_triggers_trigger_id_fkey            | FOREIGN KEY (trigger_id) REFERENCES public.seizure_triggers_reference (trigger_id)   | s             | a           | a           |
| private_health_info | seizure_logs_research           | seizure_logs_research_user_id_fkey              | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| private_health_info | tracking_entries                | tracking_entries_user_id_fkey                   | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| private_health_info | tremor_episodes                 | tremor_episodes_patient_id_fkey                 | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| private_health_info | user_conditions                 | user_conditions_condition_id_fkey               | FOREIGN KEY (condition_id) REFERENCES public.conditions (id)                         | s             | a           | a           |
| private_health_info | user_conditions                 | user_conditions_user_id_fkey                    | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| private_health_info | user_medications                | user_medications_medication_id_fkey             | FOREIGN KEY (medication_id) REFERENCES public.medications (id)                       | s             | a           | a           |
| private_health_info | user_medications                | user_medications_user_id_fkey                   | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | audit_log                       | audit_log_user_id_fkey                          | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | a           |
| public              | carer_invitations               | carer_invitations_carer_user_id_fkey            | FOREIGN KEY (carer_user_id) REFERENCES auth.users (id)                               | s             | a           | a           |
| public              | carer_invitations               | carer_invitations_patient_user_id_fkey          | FOREIGN KEY (patient_user_id) REFERENCES auth.users (id)                             | s             | a           | c           |
| public              | carer_invitations               | carer_invitations_relationship_id_fkey          | FOREIGN KEY (relationship_id) REFERENCES public.carer_relationships (id)             | s             | a           | c           |
| public              | carer_onboarding_data           | carer_onboarding_data_user_id_fkey              | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | carer_profiles                  | carer_profiles_user_id_fkey                     | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | carer_relationships             | carer_relationships_carer_user_id_fkey          | FOREIGN KEY (carer_user_id) REFERENCES auth.users (id)                               | s             | a           | n           |
| public              | carer_relationships             | carer_relationships_patient_user_id_fkey        | FOREIGN KEY (patient_user_id) REFERENCES auth.users (id)                             | s             | a           | c           |
| public              | clinician_profiles              | clinician_profiles_user_id_fkey                 | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | data_sharing_preferences        | data_sharing_preferences_patient_id_fkey        | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| public              | patient_clinician_connections   | patient_clinician_connections_clinician_id_fkey | FOREIGN KEY (clinician_id) REFERENCES auth.users (id)                                | s             | a           | c           |
| public              | patient_clinician_connections   | patient_clinician_connections_patient_id_fkey   | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | c           |
| public              | patient_invitations             | patient_invitations_clinician_id_fkey           | FOREIGN KEY (clinician_id) REFERENCES auth.users (id)                                | s             | a           | c           |
| public              | patient_invitations             | patient_invitations_patient_id_fkey             | FOREIGN KEY (patient_id) REFERENCES auth.users (id)                                  | s             | a           | a           |
| public              | patient_profiles                | patient_profiles_user_id_fkey                   | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | profiles                        | profiles_id_fkey                                | FOREIGN KEY (id) REFERENCES auth.users (id)                                          | s             | a           | c           |
| public              | research_consent                | research_consent_user_id_fkey                   | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | researcher_onboarding_data      | researcher_onboarding_data_user_id_fkey         | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | researcher_profiles             | researcher_profiles_user_id_fkey                | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | security_incidents              | security_incidents_resolved_by_fkey             | FOREIGN KEY (resolved_by) REFERENCES auth.users (id)                                 | s             | a           | a           |
| public              | security_incidents              | security_incidents_user_id_fkey                 | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | a           |
| public              | sign_brain_region_mapping       | sign_brain_region_mapping_region_id_fkey        | FOREIGN KEY (region_id) REFERENCES public.brain_regions_reference (region_id)        | s             | a           | a           |
| public              | sign_brain_region_mapping       | sign_brain_region_mapping_sign_id_fkey          | FOREIGN KEY (sign_id) REFERENCES public.seizure_signs_reference (sign_id)            | s             | a           | a           |
| public              | user_achievements               | user_achievements_achievement_id_fkey           | FOREIGN KEY (achievement_id) REFERENCES public.achievements (id)                     | s             | a           | a           |
| public              | user_achievements               | user_achievements_user_id_fkey                  | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| public              | user_points                     | user_points_user_id_fkey                        | FOREIGN KEY (user_id) REFERENCES auth.users (id)                                     | s             | a           | c           |
| storage             | objects                         | objects_bucketId_fkey                           | FOREIGN KEY (bucket_id) REFERENCES storage.buckets (id)                              | s             | a           | a           |
| storage             | prefixes                        | prefixes_bucketId_fkey                          | FOREIGN KEY (bucket_id) REFERENCES storage.buckets (id)                              | s             | a           | a           |
| storage             | s3_multipart_uploads            | s3_multipart_uploads_bucket_id_fkey             | FOREIGN KEY (bucket_id) REFERENCES storage.buckets (id)                              | s             | a           | a           |
| storage             | s3_multipart_uploads_parts      | s3_multipart_uploads_parts_bucket_id_fkey       | FOREIGN KEY (bucket_id) REFERENCES storage.buckets (id)                              | s             | a           | a           |
| storage             | s3_multipart_uploads_parts      | s3_multipart_uploads_parts_upload_id_fkey       | FOREIGN KEY (upload_id) REFERENCES storage.s3_multipart_uploads (id)                 | s             | a           | c           |









-----------


# Indexes (all schemas)




| schema_name         | table_name                      | index_name                                                | index_def                                                                                                                                                                   | is_unique | is_primary |
| ------------------- | ------------------------------- | --------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------- | ---------- |
| auth                | audit_log_entries               | audit_log_entries_pkey                                    | CREATE UNIQUE INDEX audit_log_entries_pkey ON auth.audit_log_entries USING btree (id)                                                                                       | true      | true       |
| auth                | audit_log_entries               | audit_logs_instance_id_idx                                | CREATE INDEX audit_logs_instance_id_idx ON auth.audit_log_entries USING btree (instance_id)                                                                                 | false     | false      |
| auth                | flow_state                      | flow_state_created_at_idx                                 | CREATE INDEX flow_state_created_at_idx ON auth.flow_state USING btree (created_at DESC)                                                                                     | false     | false      |
| auth                | flow_state                      | flow_state_pkey                                           | CREATE UNIQUE INDEX flow_state_pkey ON auth.flow_state USING btree (id)                                                                                                     | true      | true       |
| auth                | flow_state                      | idx_auth_code                                             | CREATE INDEX idx_auth_code ON auth.flow_state USING btree (auth_code)                                                                                                       | false     | false      |
| auth                | flow_state                      | idx_user_id_auth_method                                   | CREATE INDEX idx_user_id_auth_method ON auth.flow_state USING btree (user_id, authentication_method)                                                                        | false     | false      |
| auth                | identities                      | identities_email_idx                                      | CREATE INDEX identities_email_idx ON auth.identities USING btree (email text_pattern_ops)                                                                                   | false     | false      |
| auth                | identities                      | identities_pkey                                           | CREATE UNIQUE INDEX identities_pkey ON auth.identities USING btree (id)                                                                                                     | true      | true       |
| auth                | identities                      | identities_provider_id_provider_unique                    | CREATE UNIQUE INDEX identities_provider_id_provider_unique ON auth.identities USING btree (provider_id, provider)                                                           | true      | false      |
| auth                | identities                      | identities_user_id_idx                                    | CREATE INDEX identities_user_id_idx ON auth.identities USING btree (user_id)                                                                                                | false     | false      |
| auth                | instances                       | instances_pkey                                            | CREATE UNIQUE INDEX instances_pkey ON auth.instances USING btree (id)                                                                                                       | true      | true       |
| auth                | mfa_amr_claims                  | amr_id_pk                                                 | CREATE UNIQUE INDEX amr_id_pk ON auth.mfa_amr_claims USING btree (id)                                                                                                       | true      | true       |
| auth                | mfa_amr_claims                  | mfa_amr_claims_session_id_authentication_method_pkey      | CREATE UNIQUE INDEX mfa_amr_claims_session_id_authentication_method_pkey ON auth.mfa_amr_claims USING btree (session_id, authentication_method)                             | true      | false      |
| auth                | mfa_challenges                  | mfa_challenge_created_at_idx                              | CREATE INDEX mfa_challenge_created_at_idx ON auth.mfa_challenges USING btree (created_at DESC)                                                                              | false     | false      |
| auth                | mfa_challenges                  | mfa_challenges_pkey                                       | CREATE UNIQUE INDEX mfa_challenges_pkey ON auth.mfa_challenges USING btree (id)                                                                                             | true      | true       |
| auth                | mfa_factors                     | factor_id_created_at_idx                                  | CREATE INDEX factor_id_created_at_idx ON auth.mfa_factors USING btree (user_id, created_at)                                                                                 | false     | false      |
| auth                | mfa_factors                     | mfa_factors_last_challenged_at_key                        | CREATE UNIQUE INDEX mfa_factors_last_challenged_at_key ON auth.mfa_factors USING btree (last_challenged_at)                                                                 | true      | false      |
| auth                | mfa_factors                     | mfa_factors_pkey                                          | CREATE UNIQUE INDEX mfa_factors_pkey ON auth.mfa_factors USING btree (id)                                                                                                   | true      | true       |
| auth                | mfa_factors                     | mfa_factors_user_friendly_name_unique                     | CREATE UNIQUE INDEX mfa_factors_user_friendly_name_unique ON auth.mfa_factors USING btree (friendly_name, user_id) WHERE (TRIM(BOTH FROM friendly_name) <> ''::text)        | true      | false      |
| auth                | mfa_factors                     | mfa_factors_user_id_idx                                   | CREATE INDEX mfa_factors_user_id_idx ON auth.mfa_factors USING btree (user_id)                                                                                              | false     | false      |
| auth                | mfa_factors                     | unique_phone_factor_per_user                              | CREATE UNIQUE INDEX unique_phone_factor_per_user ON auth.mfa_factors USING btree (user_id, phone)                                                                           | true      | false      |
| auth                | oauth_clients                   | oauth_clients_client_id_idx                               | CREATE INDEX oauth_clients_client_id_idx ON auth.oauth_clients USING btree (client_id)                                                                                      | false     | false      |
| auth                | oauth_clients                   | oauth_clients_client_id_key                               | CREATE UNIQUE INDEX oauth_clients_client_id_key ON auth.oauth_clients USING btree (client_id)                                                                               | true      | false      |
| auth                | oauth_clients                   | oauth_clients_deleted_at_idx                              | CREATE INDEX oauth_clients_deleted_at_idx ON auth.oauth_clients USING btree (deleted_at)                                                                                    | false     | false      |
| auth                | oauth_clients                   | oauth_clients_pkey                                        | CREATE UNIQUE INDEX oauth_clients_pkey ON auth.oauth_clients USING btree (id)                                                                                               | true      | true       |
| auth                | one_time_tokens                 | one_time_tokens_pkey                                      | CREATE UNIQUE INDEX one_time_tokens_pkey ON auth.one_time_tokens USING btree (id)                                                                                           | true      | true       |
| auth                | one_time_tokens                 | one_time_tokens_relates_to_hash_idx                       | CREATE INDEX one_time_tokens_relates_to_hash_idx ON auth.one_time_tokens USING hash (relates_to)                                                                            | false     | false      |
| auth                | one_time_tokens                 | one_time_tokens_token_hash_hash_idx                       | CREATE INDEX one_time_tokens_token_hash_hash_idx ON auth.one_time_tokens USING hash (token_hash)                                                                            | false     | false      |
| auth                | one_time_tokens                 | one_time_tokens_user_id_token_type_key                    | CREATE UNIQUE INDEX one_time_tokens_user_id_token_type_key ON auth.one_time_tokens USING btree (user_id, token_type)                                                        | true      | false      |
| auth                | refresh_tokens                  | refresh_tokens_instance_id_idx                            | CREATE INDEX refresh_tokens_instance_id_idx ON auth.refresh_tokens USING btree (instance_id)                                                                                | false     | false      |
| auth                | refresh_tokens                  | refresh_tokens_instance_id_user_id_idx                    | CREATE INDEX refresh_tokens_instance_id_user_id_idx ON auth.refresh_tokens USING btree (instance_id, user_id)                                                               | false     | false      |
| auth                | refresh_tokens                  | refresh_tokens_parent_idx                                 | CREATE INDEX refresh_tokens_parent_idx ON auth.refresh_tokens USING btree (parent)                                                                                          | false     | false      |
| auth                | refresh_tokens                  | refresh_tokens_pkey                                       | CREATE UNIQUE INDEX refresh_tokens_pkey ON auth.refresh_tokens USING btree (id)                                                                                             | true      | true       |
| auth                | refresh_tokens                  | refresh_tokens_session_id_revoked_idx                     | CREATE INDEX refresh_tokens_session_id_revoked_idx ON auth.refresh_tokens USING btree (session_id, revoked)                                                                 | false     | false      |
| auth                | refresh_tokens                  | refresh_tokens_token_unique                               | CREATE UNIQUE INDEX refresh_tokens_token_unique ON auth.refresh_tokens USING btree (token)                                                                                  | true      | false      |
| auth                | refresh_tokens                  | refresh_tokens_updated_at_idx                             | CREATE INDEX refresh_tokens_updated_at_idx ON auth.refresh_tokens USING btree (updated_at DESC)                                                                             | false     | false      |
| auth                | saml_providers                  | saml_providers_entity_id_key                              | CREATE UNIQUE INDEX saml_providers_entity_id_key ON auth.saml_providers USING btree (entity_id)                                                                             | true      | false      |
| auth                | saml_providers                  | saml_providers_pkey                                       | CREATE UNIQUE INDEX saml_providers_pkey ON auth.saml_providers USING btree (id)                                                                                             | true      | true       |
| auth                | saml_providers                  | saml_providers_sso_provider_id_idx                        | CREATE INDEX saml_providers_sso_provider_id_idx ON auth.saml_providers USING btree (sso_provider_id)                                                                        | false     | false      |
| auth                | saml_relay_states               | saml_relay_states_created_at_idx                          | CREATE INDEX saml_relay_states_created_at_idx ON auth.saml_relay_states USING btree (created_at DESC)                                                                       | false     | false      |
| auth                | saml_relay_states               | saml_relay_states_for_email_idx                           | CREATE INDEX saml_relay_states_for_email_idx ON auth.saml_relay_states USING btree (for_email)                                                                              | false     | false      |
| auth                | saml_relay_states               | saml_relay_states_pkey                                    | CREATE UNIQUE INDEX saml_relay_states_pkey ON auth.saml_relay_states USING btree (id)                                                                                       | true      | true       |
| auth                | saml_relay_states               | saml_relay_states_sso_provider_id_idx                     | CREATE INDEX saml_relay_states_sso_provider_id_idx ON auth.saml_relay_states USING btree (sso_provider_id)                                                                  | false     | false      |
| auth                | schema_migrations               | schema_migrations_pkey                                    | CREATE UNIQUE INDEX schema_migrations_pkey ON auth.schema_migrations USING btree (version)                                                                                  | true      | true       |
| auth                | sessions                        | sessions_not_after_idx                                    | CREATE INDEX sessions_not_after_idx ON auth.sessions USING btree (not_after DESC)                                                                                           | false     | false      |
| auth                | sessions                        | sessions_pkey                                             | CREATE UNIQUE INDEX sessions_pkey ON auth.sessions USING btree (id)                                                                                                         | true      | true       |
| auth                | sessions                        | sessions_user_id_idx                                      | CREATE INDEX sessions_user_id_idx ON auth.sessions USING btree (user_id)                                                                                                    | false     | false      |
| auth                | sessions                        | user_id_created_at_idx                                    | CREATE INDEX user_id_created_at_idx ON auth.sessions USING btree (user_id, created_at)                                                                                      | false     | false      |
| auth                | sso_domains                     | sso_domains_domain_idx                                    | CREATE UNIQUE INDEX sso_domains_domain_idx ON auth.sso_domains USING btree (lower(domain))                                                                                  | true      | false      |
| auth                | sso_domains                     | sso_domains_pkey                                          | CREATE UNIQUE INDEX sso_domains_pkey ON auth.sso_domains USING btree (id)                                                                                                   | true      | true       |
| auth                | sso_domains                     | sso_domains_sso_provider_id_idx                           | CREATE INDEX sso_domains_sso_provider_id_idx ON auth.sso_domains USING btree (sso_provider_id)                                                                              | false     | false      |
| auth                | sso_providers                   | sso_providers_pkey                                        | CREATE UNIQUE INDEX sso_providers_pkey ON auth.sso_providers USING btree (id)                                                                                               | true      | true       |
| auth                | sso_providers                   | sso_providers_resource_id_idx                             | CREATE UNIQUE INDEX sso_providers_resource_id_idx ON auth.sso_providers USING btree (lower(resource_id))                                                                    | true      | false      |
| auth                | sso_providers                   | sso_providers_resource_id_pattern_idx                     | CREATE INDEX sso_providers_resource_id_pattern_idx ON auth.sso_providers USING btree (resource_id text_pattern_ops)                                                         | false     | false      |
| auth                | users                           | confirmation_token_idx                                    | CREATE UNIQUE INDEX confirmation_token_idx ON auth.users USING btree (confirmation_token) WHERE ((confirmation_token)::text !~ '^[0-9 ]*$'::text)                           | true      | false      |
| auth                | users                           | email_change_token_current_idx                            | CREATE UNIQUE INDEX email_change_token_current_idx ON auth.users USING btree (email_change_token_current) WHERE ((email_change_token_current)::text !~ '^[0-9 ]*$'::text)   | true      | false      |
| auth                | users                           | email_change_token_new_idx                                | CREATE UNIQUE INDEX email_change_token_new_idx ON auth.users USING btree (email_change_token_new) WHERE ((email_change_token_new)::text !~ '^[0-9 ]*$'::text)               | true      | false      |
| auth                | users                           | reauthentication_token_idx                                | CREATE UNIQUE INDEX reauthentication_token_idx ON auth.users USING btree (reauthentication_token) WHERE ((reauthentication_token)::text !~ '^[0-9 ]*$'::text)               | true      | false      |
| auth                | users                           | recovery_token_idx                                        | CREATE UNIQUE INDEX recovery_token_idx ON auth.users USING btree (recovery_token) WHERE ((recovery_token)::text !~ '^[0-9 ]*$'::text)                                       | true      | false      |
| auth                | users                           | users_email_partial_key                                   | CREATE UNIQUE INDEX users_email_partial_key ON auth.users USING btree (email) WHERE (is_sso_user = false)                                                                   | true      | false      |
| auth                | users                           | users_instance_id_email_idx                               | CREATE INDEX users_instance_id_email_idx ON auth.users USING btree (instance_id, lower((email)::text))                                                                      | false     | false      |
| auth                | users                           | users_instance_id_idx                                     | CREATE INDEX users_instance_id_idx ON auth.users USING btree (instance_id)                                                                                                  | false     | false      |
| auth                | users                           | users_is_anonymous_idx                                    | CREATE INDEX users_is_anonymous_idx ON auth.users USING btree (is_anonymous)                                                                                                | false     | false      |
| auth                | users                           | users_phone_key                                           | CREATE UNIQUE INDEX users_phone_key ON auth.users USING btree (phone)                                                                                                       | true      | false      |
| auth                | users                           | users_pkey                                                | CREATE UNIQUE INDEX users_pkey ON auth.users USING btree (id)                                                                                                               | true      | true       |
| clinical            | ai_insights_cards               | ai_insights_cards_pkey                                    | CREATE UNIQUE INDEX ai_insights_cards_pkey ON clinical.ai_insights_cards USING btree (insight_id)                                                                           | true      | true       |
| clinical            | ai_insights_cards               | idx_insights_clinician                                    | CREATE INDEX idx_insights_clinician ON clinical.ai_insights_cards USING btree (clinician_id)                                                                                | false     | false      |
| clinical            | ai_insights_cards               | idx_insights_generated                                    | CREATE INDEX idx_insights_generated ON clinical.ai_insights_cards USING btree (generated_at DESC)                                                                           | false     | false      |
| clinical            | ai_insights_cards               | idx_insights_unread                                       | CREATE INDEX idx_insights_unread ON clinical.ai_insights_cards USING btree (is_read) WHERE (is_read = false)                                                                | false     | false      |
| clinical            | case_data_panels                | case_data_panels_pkey                                     | CREATE UNIQUE INDEX case_data_panels_pkey ON clinical.case_data_panels USING btree (panel_id)                                                                               | true      | true       |
| clinical            | case_data_panels                | idx_panels_patient                                        | CREATE INDEX idx_panels_patient ON clinical.case_data_panels USING btree (patient_id)                                                                                       | false     | false      |
| clinical            | case_data_panels                | idx_panels_type                                           | CREATE INDEX idx_panels_type ON clinical.case_data_panels USING btree (panel_type)                                                                                          | false     | false      |
| clinical            | case_data_panels                | idx_panels_visible                                        | CREATE INDEX idx_panels_visible ON clinical.case_data_panels USING btree (is_visible) WHERE (is_visible = true)                                                             | false     | false      |
| clinical            | clinical_notes_exports          | clinical_notes_exports_pkey                               | CREATE UNIQUE INDEX clinical_notes_exports_pkey ON clinical.clinical_notes_exports USING btree (note_id)                                                                    | true      | true       |
| clinical            | clinical_notes_exports          | idx_notes_author                                          | CREATE INDEX idx_notes_author ON clinical.clinical_notes_exports USING btree (author_id)                                                                                    | false     | false      |
| clinical            | clinical_notes_exports          | idx_notes_generated                                       | CREATE INDEX idx_notes_generated ON clinical.clinical_notes_exports USING btree (generated_at DESC)                                                                         | false     | false      |
| clinical            | clinical_notes_exports          | idx_notes_patient                                         | CREATE INDEX idx_notes_patient ON clinical.clinical_notes_exports USING btree (patient_id)                                                                                  | false     | false      |
| clinical            | clinical_notes_exports          | idx_notes_status                                          | CREATE INDEX idx_notes_status ON clinical.clinical_notes_exports USING btree (status)                                                                                       | false     | false      |
| clinical            | clinical_scale_results          | clinical_scale_results_pkey                               | CREATE UNIQUE INDEX clinical_scale_results_pkey ON clinical.clinical_scale_results USING btree (scale_id)                                                                   | true      | true       |
| clinical            | clinical_scale_results          | idx_scale_results_assessed                                | CREATE INDEX idx_scale_results_assessed ON clinical.clinical_scale_results USING btree (assessed_at DESC)                                                                   | false     | false      |
| clinical            | clinical_scale_results          | idx_scale_results_change_alert                            | CREATE INDEX idx_scale_results_change_alert ON clinical.clinical_scale_results USING btree (change_alert) WHERE (change_alert = true)                                       | false     | false      |
| clinical            | clinical_scale_results          | idx_scale_results_patient                                 | CREATE INDEX idx_scale_results_patient ON clinical.clinical_scale_results USING btree (patient_id)                                                                          | false     | false      |
| clinical            | clinical_scale_results          | idx_scale_results_type                                    | CREATE INDEX idx_scale_results_type ON clinical.clinical_scale_results USING btree (scale_type)                                                                             | false     | false      |
| clinical            | clinician_today_view            | clinician_today_view_clinician_id_date_key                | CREATE UNIQUE INDEX clinician_today_view_clinician_id_date_key ON clinical.clinician_today_view USING btree (clinician_id, date)                                            | true      | false      |
| clinical            | clinician_today_view            | clinician_today_view_pkey                                 | CREATE UNIQUE INDEX clinician_today_view_pkey ON clinical.clinician_today_view USING btree (view_id)                                                                        | true      | true       |
| clinical            | clinician_today_view            | idx_today_view_clinician                                  | CREATE INDEX idx_today_view_clinician ON clinical.clinician_today_view USING btree (clinician_id)                                                                           | false     | false      |
| clinical            | clinician_today_view            | idx_today_view_date                                       | CREATE INDEX idx_today_view_date ON clinical.clinician_today_view USING btree (date DESC)                                                                                   | false     | false      |
| clinical            | neuro_imaging_results           | idx_imaging_critical                                      | CREATE INDEX idx_imaging_critical ON clinical.neuro_imaging_results USING btree (critical_findings) WHERE (critical_findings = true)                                        | false     | false      |
| clinical            | neuro_imaging_results           | idx_imaging_date                                          | CREATE INDEX idx_imaging_date ON clinical.neuro_imaging_results USING btree (study_date DESC)                                                                               | false     | false      |
| clinical            | neuro_imaging_results           | idx_imaging_patient                                       | CREATE INDEX idx_imaging_patient ON clinical.neuro_imaging_results USING btree (patient_id)                                                                                 | false     | false      |
| clinical            | neuro_imaging_results           | idx_imaging_type                                          | CREATE INDEX idx_imaging_type ON clinical.neuro_imaging_results USING btree (study_type)                                                                                    | false     | false      |
| clinical            | neuro_imaging_results           | neuro_imaging_results_dicom_uid_key                       | CREATE UNIQUE INDEX neuro_imaging_results_dicom_uid_key ON clinical.neuro_imaging_results USING btree (dicom_uid)                                                           | true      | false      |
| clinical            | neuro_imaging_results           | neuro_imaging_results_pkey                                | CREATE UNIQUE INDEX neuro_imaging_results_pkey ON clinical.neuro_imaging_results USING btree (image_id)                                                                     | true      | true       |
| clinical            | patient_collab_chat             | idx_chat_patient                                          | CREATE INDEX idx_chat_patient ON clinical.patient_collab_chat USING btree (patient_id)                                                                                      | false     | false      |
| clinical            | patient_collab_chat             | idx_chat_sender                                           | CREATE INDEX idx_chat_sender ON clinical.patient_collab_chat USING btree (sender_id)                                                                                        | false     | false      |
| clinical            | patient_collab_chat             | idx_chat_sent                                             | CREATE INDEX idx_chat_sent ON clinical.patient_collab_chat USING btree (sent_at DESC)                                                                                       | false     | false      |
| clinical            | patient_collab_chat             | idx_chat_thread                                           | CREATE INDEX idx_chat_thread ON clinical.patient_collab_chat USING btree (thread_id)                                                                                        | false     | false      |
| clinical            | patient_collab_chat             | idx_chat_urgent                                           | CREATE INDEX idx_chat_urgent ON clinical.patient_collab_chat USING btree (is_urgent) WHERE (is_urgent = true)                                                               | false     | false      |
| clinical            | patient_collab_chat             | patient_collab_chat_pkey                                  | CREATE UNIQUE INDEX patient_collab_chat_pkey ON clinical.patient_collab_chat USING btree (message_id)                                                                       | true      | true       |
| clinical            | patient_pro_timeline            | idx_pro_patient                                           | CREATE INDEX idx_pro_patient ON clinical.patient_pro_timeline USING btree (patient_id)                                                                                      | false     | false      |
| clinical            | patient_pro_timeline            | idx_pro_reported                                          | CREATE INDEX idx_pro_reported ON clinical.patient_pro_timeline USING btree (reported_at DESC)                                                                               | false     | false      |
| clinical            | patient_pro_timeline            | idx_pro_type                                              | CREATE INDEX idx_pro_type ON clinical.patient_pro_timeline USING btree (pro_type)                                                                                           | false     | false      |
| clinical            | patient_pro_timeline            | patient_pro_timeline_pkey                                 | CREATE UNIQUE INDEX patient_pro_timeline_pkey ON clinical.patient_pro_timeline USING btree (pro_id)                                                                         | true      | true       |
| clinical            | patient_risk_alerts             | idx_risk_alerts_created                                   | CREATE INDEX idx_risk_alerts_created ON clinical.patient_risk_alerts USING btree (created_at DESC)                                                                          | false     | false      |
| clinical            | patient_risk_alerts             | idx_risk_alerts_level                                     | CREATE INDEX idx_risk_alerts_level ON clinical.patient_risk_alerts USING btree (alert_level)                                                                                | false     | false      |
| clinical            | patient_risk_alerts             | idx_risk_alerts_patient                                   | CREATE INDEX idx_risk_alerts_patient ON clinical.patient_risk_alerts USING btree (patient_id)                                                                               | false     | false      |
| clinical            | patient_risk_alerts             | idx_risk_alerts_status                                    | CREATE INDEX idx_risk_alerts_status ON clinical.patient_risk_alerts USING btree (status)                                                                                    | false     | false      |
| clinical            | patient_risk_alerts             | patient_risk_alerts_pkey                                  | CREATE UNIQUE INDEX patient_risk_alerts_pkey ON clinical.patient_risk_alerts USING btree (alert_id)                                                                         | true      | true       |
| clinical            | patient_snapshots               | idx_snapshots_generated                                   | CREATE INDEX idx_snapshots_generated ON clinical.patient_snapshots USING btree (generated_at DESC)                                                                          | false     | false      |
| clinical            | patient_snapshots               | idx_snapshots_patient                                     | CREATE INDEX idx_snapshots_patient ON clinical.patient_snapshots USING btree (patient_id)                                                                                   | false     | false      |
| clinical            | patient_snapshots               | idx_snapshots_pinned                                      | CREATE INDEX idx_snapshots_pinned ON clinical.patient_snapshots USING btree (is_pinned) WHERE (is_pinned = true)                                                            | false     | false      |
| clinical            | patient_snapshots               | patient_snapshots_pkey                                    | CREATE UNIQUE INDEX patient_snapshots_pkey ON clinical.patient_snapshots USING btree (snapshot_id)                                                                          | true      | true       |
| linkage             | research_id_map                 | idx_research_map_research                                 | CREATE INDEX idx_research_map_research ON linkage.research_id_map USING btree (research_id)                                                                                 | false     | false      |
| linkage             | research_id_map                 | idx_research_map_user                                     | CREATE INDEX idx_research_map_user ON linkage.research_id_map USING btree (user_id)                                                                                         | false     | false      |
| linkage             | research_id_map                 | research_id_map_pkey                                      | CREATE UNIQUE INDEX research_id_map_pkey ON linkage.research_id_map USING btree (id)                                                                                        | true      | true       |
| linkage             | research_id_map                 | research_id_map_research_id_key                           | CREATE UNIQUE INDEX research_id_map_research_id_key ON linkage.research_id_map USING btree (research_id)                                                                    | true      | false      |
| linkage             | research_id_map                 | research_id_map_user_id_key                               | CREATE UNIQUE INDEX research_id_map_user_id_key ON linkage.research_id_map USING btree (user_id)                                                                            | true      | false      |
| private_health_info | clinical_media                  | clinical_media_pkey                                       | CREATE UNIQUE INDEX clinical_media_pkey ON private_health_info.clinical_media USING btree (media_id)                                                                        | true      | true       |
| private_health_info | clinical_media                  | idx_clinical_media_parent                                 | CREATE INDEX idx_clinical_media_parent ON private_health_info.clinical_media USING btree (parent_type, parent_id)                                                           | false     | false      |
| private_health_info | clinical_media                  | idx_clinical_media_patient                                | CREATE INDEX idx_clinical_media_patient ON private_health_info.clinical_media USING btree (patient_id)                                                                      | false     | false      |
| private_health_info | clinician_onboarding_data       | clinician_onboarding_data_pkey                            | CREATE UNIQUE INDEX clinician_onboarding_data_pkey ON private_health_info.clinician_onboarding_data USING btree (id)                                                        | true      | true       |
| private_health_info | clinician_onboarding_data       | clinician_onboarding_data_user_id_key                     | CREATE UNIQUE INDEX clinician_onboarding_data_user_id_key ON private_health_info.clinician_onboarding_data USING btree (user_id)                                            | true      | false      |
| private_health_info | clinician_phi                   | clinician_phi_npi_number_key                              | CREATE UNIQUE INDEX clinician_phi_npi_number_key ON private_health_info.clinician_phi USING btree (npi_number)                                                              | true      | false      |
| private_health_info | clinician_phi                   | clinician_phi_pkey                                        | CREATE UNIQUE INDEX clinician_phi_pkey ON private_health_info.clinician_phi USING btree (id)                                                                                | true      | true       |
| private_health_info | clinician_phi                   | clinician_phi_user_id_key                                 | CREATE UNIQUE INDEX clinician_phi_user_id_key ON private_health_info.clinician_phi USING btree (user_id)                                                                    | true      | false      |
| private_health_info | clinician_phi                   | idx_clinician_phi_npi                                     | CREATE UNIQUE INDEX idx_clinician_phi_npi ON private_health_info.clinician_phi USING btree (npi_number) WHERE (npi_number IS NOT NULL)                                      | true      | false      |
| private_health_info | clinician_phi                   | idx_clinician_phi_user                                    | CREATE INDEX idx_clinician_phi_user ON private_health_info.clinician_phi USING btree (user_id)                                                                              | false     | false      |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_patient_id_log_date_key                | CREATE UNIQUE INDEX daily_symptom_logs_patient_id_log_date_key ON private_health_info.daily_symptom_logs USING btree (patient_id, log_date)                                 | true      | false      |
| private_health_info | daily_symptom_logs              | daily_symptom_logs_pkey                                   | CREATE UNIQUE INDEX daily_symptom_logs_pkey ON private_health_info.daily_symptom_logs USING btree (log_id)                                                                  | true      | true       |
| private_health_info | daily_symptom_logs              | idx_daily_logs_date                                       | CREATE INDEX idx_daily_logs_date ON private_health_info.daily_symptom_logs USING btree (log_date DESC)                                                                      | false     | false      |
| private_health_info | daily_symptom_logs              | idx_daily_logs_patient                                    | CREATE INDEX idx_daily_logs_patient ON private_health_info.daily_symptom_logs USING btree (patient_id)                                                                      | false     | false      |
| private_health_info | gait_episodes                   | gait_episodes_pkey                                        | CREATE UNIQUE INDEX gait_episodes_pkey ON private_health_info.gait_episodes USING btree (gait_id)                                                                           | true      | true       |
| private_health_info | gait_episodes                   | idx_gait_episodes_occurred                                | CREATE INDEX idx_gait_episodes_occurred ON private_health_info.gait_episodes USING btree (occurred_at DESC)                                                                 | false     | false      |
| private_health_info | gait_episodes                   | idx_gait_episodes_patient                                 | CREATE INDEX idx_gait_episodes_patient ON private_health_info.gait_episodes USING btree (patient_id)                                                                        | false     | false      |
| private_health_info | gait_episodes                   | idx_gait_episodes_type                                    | CREATE INDEX idx_gait_episodes_type ON private_health_info.gait_episodes USING btree (event_type)                                                                           | false     | false      |
| private_health_info | patient_onboarding_data         | patient_onboarding_data_pkey                              | CREATE UNIQUE INDEX patient_onboarding_data_pkey ON private_health_info.patient_onboarding_data USING btree (id)                                                            | true      | true       |
| private_health_info | patient_onboarding_data         | patient_onboarding_data_user_id_key                       | CREATE UNIQUE INDEX patient_onboarding_data_user_id_key ON private_health_info.patient_onboarding_data USING btree (user_id)                                                | true      | false      |
| private_health_info | patient_phi                     | idx_patient_phi_user                                      | CREATE INDEX idx_patient_phi_user ON private_health_info.patient_phi USING btree (user_id)                                                                                  | false     | false      |
| private_health_info | patient_phi                     | patient_phi_pkey                                          | CREATE UNIQUE INDEX patient_phi_pkey ON private_health_info.patient_phi USING btree (id)                                                                                    | true      | true       |
| private_health_info | patient_phi                     | patient_phi_user_id_key                                   | CREATE UNIQUE INDEX patient_phi_user_id_key ON private_health_info.patient_phi USING btree (user_id)                                                                        | true      | false      |
| private_health_info | seizure_events                  | idx_seizure_events_occurred                               | CREATE INDEX idx_seizure_events_occurred ON private_health_info.seizure_events USING btree (occurred_at DESC)                                                               | false     | false      |
| private_health_info | seizure_events                  | idx_seizure_events_patient                                | CREATE INDEX idx_seizure_events_patient ON private_health_info.seizure_events USING btree (patient_id)                                                                      | false     | false      |
| private_health_info | seizure_events                  | idx_seizure_events_type                                   | CREATE INDEX idx_seizure_events_type ON private_health_info.seizure_events USING btree (seizure_type)                                                                       | false     | false      |
| private_health_info | seizure_events                  | seizure_events_pkey                                       | CREATE UNIQUE INDEX seizure_events_pkey ON private_health_info.seizure_events USING btree (event_id)                                                                        | true      | true       |
| private_health_info | seizure_generalized_assessment  | seizure_generalized_assessment_log_id_key                 | CREATE UNIQUE INDEX seizure_generalized_assessment_log_id_key ON private_health_info.seizure_generalized_assessment USING btree (log_id)                                    | true      | false      |
| private_health_info | seizure_generalized_assessment  | seizure_generalized_assessment_pkey                       | CREATE UNIQUE INDEX seizure_generalized_assessment_pkey ON private_health_info.seizure_generalized_assessment USING btree (id)                                              | true      | true       |
| private_health_info | seizure_log_brain_regions       | seizure_log_brain_regions_log_id_region_id_key            | CREATE UNIQUE INDEX seizure_log_brain_regions_log_id_region_id_key ON private_health_info.seizure_log_brain_regions USING btree (log_id, region_id)                         | true      | false      |
| private_health_info | seizure_log_brain_regions       | seizure_log_brain_regions_pkey                            | CREATE UNIQUE INDEX seizure_log_brain_regions_pkey ON private_health_info.seizure_log_brain_regions USING btree (id)                                                        | true      | true       |
| private_health_info | seizure_log_post_ictal_symptoms | seizure_log_post_ictal_symptoms_log_id_symptom_key        | CREATE UNIQUE INDEX seizure_log_post_ictal_symptoms_log_id_symptom_key ON private_health_info.seizure_log_post_ictal_symptoms USING btree (log_id, symptom)                 | true      | false      |
| private_health_info | seizure_log_post_ictal_symptoms | seizure_log_post_ictal_symptoms_pkey                      | CREATE UNIQUE INDEX seizure_log_post_ictal_symptoms_pkey ON private_health_info.seizure_log_post_ictal_symptoms USING btree (id)                                            | true      | true       |
| private_health_info | seizure_log_signs               | idx_seizure_log_signs_log_id                              | CREATE INDEX idx_seizure_log_signs_log_id ON private_health_info.seizure_log_signs USING btree (log_id)                                                                     | false     | false      |
| private_health_info | seizure_log_signs               | idx_seizure_log_signs_sign_id                             | CREATE INDEX idx_seizure_log_signs_sign_id ON private_health_info.seizure_log_signs USING btree (sign_id)                                                                   | false     | false      |
| private_health_info | seizure_log_signs               | seizure_log_signs_log_id_sign_id_key                      | CREATE UNIQUE INDEX seizure_log_signs_log_id_sign_id_key ON private_health_info.seizure_log_signs USING btree (log_id, sign_id)                                             | true      | false      |
| private_health_info | seizure_log_signs               | seizure_log_signs_pkey                                    | CREATE UNIQUE INDEX seizure_log_signs_pkey ON private_health_info.seizure_log_signs USING btree (id)                                                                        | true      | true       |
| private_health_info | seizure_log_triggers            | seizure_log_triggers_log_id_trigger_id_key                | CREATE UNIQUE INDEX seizure_log_triggers_log_id_trigger_id_key ON private_health_info.seizure_log_triggers USING btree (log_id, trigger_id)                                 | true      | false      |
| private_health_info | seizure_log_triggers            | seizure_log_triggers_pkey                                 | CREATE UNIQUE INDEX seizure_log_triggers_pkey ON private_health_info.seizure_log_triggers USING btree (id)                                                                  | true      | true       |
| private_health_info | seizure_logs_research           | idx_seizure_logs_research_log_date                        | CREATE INDEX idx_seizure_logs_research_log_date ON private_health_info.seizure_logs_research USING btree (log_date)                                                         | false     | false      |
| private_health_info | seizure_logs_research           | idx_seizure_logs_research_seizure_type                    | CREATE INDEX idx_seizure_logs_research_seizure_type ON private_health_info.seizure_logs_research USING btree (seizure_type)                                                 | false     | false      |
| private_health_info | seizure_logs_research           | idx_seizure_logs_research_user_id                         | CREATE INDEX idx_seizure_logs_research_user_id ON private_health_info.seizure_logs_research USING btree (user_id)                                                           | false     | false      |
| private_health_info | seizure_logs_research           | seizure_logs_research_pkey                                | CREATE UNIQUE INDEX seizure_logs_research_pkey ON private_health_info.seizure_logs_research USING btree (log_id)                                                            | true      | true       |
| private_health_info | tracking_entries                | idx_tracking_date                                         | CREATE INDEX idx_tracking_date ON private_health_info.tracking_entries USING btree (entry_date DESC)                                                                        | false     | false      |
| private_health_info | tracking_entries                | idx_tracking_user                                         | CREATE INDEX idx_tracking_user ON private_health_info.tracking_entries USING btree (user_id)                                                                                | false     | false      |
| private_health_info | tracking_entries                | tracking_entries_pkey                                     | CREATE UNIQUE INDEX tracking_entries_pkey ON private_health_info.tracking_entries USING btree (id)                                                                          | true      | true       |
| private_health_info | tremor_episodes                 | idx_tremor_episodes_occurred                              | CREATE INDEX idx_tremor_episodes_occurred ON private_health_info.tremor_episodes USING btree (occurred_at DESC)                                                             | false     | false      |
| private_health_info | tremor_episodes                 | idx_tremor_episodes_patient                               | CREATE INDEX idx_tremor_episodes_patient ON private_health_info.tremor_episodes USING btree (patient_id)                                                                    | false     | false      |
| private_health_info | tremor_episodes                 | tremor_episodes_pkey                                      | CREATE UNIQUE INDEX tremor_episodes_pkey ON private_health_info.tremor_episodes USING btree (tremor_id)                                                                     | true      | true       |
| private_health_info | user_conditions                 | idx_user_conditions_user                                  | CREATE INDEX idx_user_conditions_user ON private_health_info.user_conditions USING btree (user_id)                                                                          | false     | false      |
| private_health_info | user_conditions                 | user_conditions_pkey                                      | CREATE UNIQUE INDEX user_conditions_pkey ON private_health_info.user_conditions USING btree (id)                                                                            | true      | true       |
| private_health_info | user_conditions                 | user_conditions_user_id_condition_id_key                  | CREATE UNIQUE INDEX user_conditions_user_id_condition_id_key ON private_health_info.user_conditions USING btree (user_id, condition_id)                                     | true      | false      |
| private_health_info | user_medications                | idx_user_medications_user                                 | CREATE INDEX idx_user_medications_user ON private_health_info.user_medications USING btree (user_id)                                                                        | false     | false      |
| private_health_info | user_medications                | user_medications_pkey                                     | CREATE UNIQUE INDEX user_medications_pkey ON private_health_info.user_medications USING btree (id)                                                                          | true      | true       |
| protected           | system_settings                 | system_settings_pkey                                      | CREATE UNIQUE INDEX system_settings_pkey ON protected.system_settings USING btree (key)                                                                                     | true      | true       |
| public              | achievements                    | achievements_name_key                                     | CREATE UNIQUE INDEX achievements_name_key ON public.achievements USING btree (name)                                                                                         | true      | false      |
| public              | achievements                    | achievements_pkey                                         | CREATE UNIQUE INDEX achievements_pkey ON public.achievements USING btree (id)                                                                                               | true      | true       |
| public              | audit_log                       | audit_log_pkey                                            | CREATE UNIQUE INDEX audit_log_pkey ON public.audit_log USING btree (id)                                                                                                     | true      | true       |
| public              | audit_log                       | idx_audit_log_action                                      | CREATE INDEX idx_audit_log_action ON public.audit_log USING btree (action)                                                                                                  | false     | false      |
| public              | audit_log                       | idx_audit_log_created                                     | CREATE INDEX idx_audit_log_created ON public.audit_log USING btree (created_at DESC)                                                                                        | false     | false      |
| public              | audit_log                       | idx_audit_log_user                                        | CREATE INDEX idx_audit_log_user ON public.audit_log USING btree (user_id)                                                                                                   | false     | false      |
| public              | brain_regions_reference         | brain_regions_reference_pkey                              | CREATE UNIQUE INDEX brain_regions_reference_pkey ON public.brain_regions_reference USING btree (region_id)                                                                  | true      | true       |
| public              | carer_invitations               | carer_invitations_invitation_token_key                    | CREATE UNIQUE INDEX carer_invitations_invitation_token_key ON public.carer_invitations USING btree (invitation_token)                                                       | true      | false      |
| public              | carer_invitations               | carer_invitations_pkey                                    | CREATE UNIQUE INDEX carer_invitations_pkey ON public.carer_invitations USING btree (id)                                                                                     | true      | true       |
| public              | carer_invitations               | idx_carer_invitations_relationship                        | CREATE INDEX idx_carer_invitations_relationship ON public.carer_invitations USING btree (relationship_id)                                                                   | false     | false      |
| public              | carer_invitations               | idx_carer_invitations_status                              | CREATE INDEX idx_carer_invitations_status ON public.carer_invitations USING btree (status)                                                                                  | false     | false      |
| public              | carer_invitations               | idx_carer_invitations_token                               | CREATE INDEX idx_carer_invitations_token ON public.carer_invitations USING btree (invitation_token)                                                                         | false     | false      |
| public              | carer_onboarding_data           | carer_onboarding_data_pkey                                | CREATE UNIQUE INDEX carer_onboarding_data_pkey ON public.carer_onboarding_data USING btree (id)                                                                             | true      | true       |
| public              | carer_onboarding_data           | carer_onboarding_data_user_id_key                         | CREATE UNIQUE INDEX carer_onboarding_data_user_id_key ON public.carer_onboarding_data USING btree (user_id)                                                                 | true      | false      |
| public              | carer_profiles                  | carer_profiles_pkey                                       | CREATE UNIQUE INDEX carer_profiles_pkey ON public.carer_profiles USING btree (id)                                                                                           | true      | true       |
| public              | carer_profiles                  | carer_profiles_user_id_key                                | CREATE UNIQUE INDEX carer_profiles_user_id_key ON public.carer_profiles USING btree (user_id)                                                                               | true      | false      |
| public              | carer_profiles                  | idx_carer_profiles_user                                   | CREATE INDEX idx_carer_profiles_user ON public.carer_profiles USING btree (user_id)                                                                                         | false     | false      |
| public              | carer_relationships             | carer_relationships_pkey                                  | CREATE UNIQUE INDEX carer_relationships_pkey ON public.carer_relationships USING btree (id)                                                                                 | true      | true       |
| public              | carer_relationships             | idx_carer_rel_carer                                       | CREATE INDEX idx_carer_rel_carer ON public.carer_relationships USING btree (carer_user_id)                                                                                  | false     | false      |
| public              | carer_relationships             | idx_carer_rel_patient                                     | CREATE INDEX idx_carer_rel_patient ON public.carer_relationships USING btree (patient_user_id)                                                                              | false     | false      |
| public              | carer_relationships             | idx_carer_rel_status                                      | CREATE INDEX idx_carer_rel_status ON public.carer_relationships USING btree (status)                                                                                        | false     | false      |
| public              | clinician_profiles              | clinician_profiles_pkey                                   | CREATE UNIQUE INDEX clinician_profiles_pkey ON public.clinician_profiles USING btree (id)                                                                                   | true      | true       |
| public              | clinician_profiles              | clinician_profiles_user_id_key                            | CREATE UNIQUE INDEX clinician_profiles_user_id_key ON public.clinician_profiles USING btree (user_id)                                                                       | true      | false      |
| public              | clinician_profiles              | idx_clinician_profiles_specialty                          | CREATE INDEX idx_clinician_profiles_specialty ON public.clinician_profiles USING btree (specialty)                                                                          | false     | false      |
| public              | clinician_profiles              | idx_clinician_profiles_user                               | CREATE INDEX idx_clinician_profiles_user ON public.clinician_profiles USING btree (user_id)                                                                                 | false     | false      |
| public              | conditions                      | conditions_pkey                                           | CREATE UNIQUE INDEX conditions_pkey ON public.conditions USING btree (id)                                                                                                   | true      | true       |
| public              | conditions                      | idx_conditions_name                                       | CREATE INDEX idx_conditions_name ON public.conditions USING btree (name)                                                                                                    | false     | false      |
| public              | data_sharing_preferences        | data_sharing_preferences_patient_id_key                   | CREATE UNIQUE INDEX data_sharing_preferences_patient_id_key ON public.data_sharing_preferences USING btree (patient_id)                                                     | true      | false      |
| public              | data_sharing_preferences        | data_sharing_preferences_pkey                             | CREATE UNIQUE INDEX data_sharing_preferences_pkey ON public.data_sharing_preferences USING btree (id)                                                                       | true      | true       |
| public              | data_sharing_preferences        | idx_sharing_prefs_patient                                 | CREATE INDEX idx_sharing_prefs_patient ON public.data_sharing_preferences USING btree (patient_id)                                                                          | false     | false      |
| public              | medications                     | idx_medications_name                                      | CREATE INDEX idx_medications_name ON public.medications USING btree (name)                                                                                                  | false     | false      |
| public              | medications                     | medications_pkey                                          | CREATE UNIQUE INDEX medications_pkey ON public.medications USING btree (id)                                                                                                 | true      | true       |
| public              | patient_clinician_connections   | idx_pcc_clinician                                         | CREATE INDEX idx_pcc_clinician ON public.patient_clinician_connections USING btree (clinician_id)                                                                           | false     | false      |
| public              | patient_clinician_connections   | idx_pcc_patient                                           | CREATE INDEX idx_pcc_patient ON public.patient_clinician_connections USING btree (patient_id)                                                                               | false     | false      |
| public              | patient_clinician_connections   | idx_pcc_status                                            | CREATE INDEX idx_pcc_status ON public.patient_clinician_connections USING btree (status)                                                                                    | false     | false      |
| public              | patient_clinician_connections   | patient_clinician_connections_patient_id_clinician_id_key | CREATE UNIQUE INDEX patient_clinician_connections_patient_id_clinician_id_key ON public.patient_clinician_connections USING btree (patient_id, clinician_id)                | true      | false      |
| public              | patient_clinician_connections   | patient_clinician_connections_pkey                        | CREATE UNIQUE INDEX patient_clinician_connections_pkey ON public.patient_clinician_connections USING btree (id)                                                             | true      | true       |
| public              | patient_invitations             | idx_patient_invitations_clinician                         | CREATE INDEX idx_patient_invitations_clinician ON public.patient_invitations USING btree (clinician_id)                                                                     | false     | false      |
| public              | patient_invitations             | idx_patient_invitations_status                            | CREATE INDEX idx_patient_invitations_status ON public.patient_invitations USING btree (status)                                                                              | false     | false      |
| public              | patient_invitations             | idx_patient_invitations_token                             | CREATE INDEX idx_patient_invitations_token ON public.patient_invitations USING btree (invitation_token)                                                                     | false     | false      |
| public              | patient_invitations             | patient_invitations_invitation_token_key                  | CREATE UNIQUE INDEX patient_invitations_invitation_token_key ON public.patient_invitations USING btree (invitation_token)                                                   | true      | false      |
| public              | patient_invitations             | patient_invitations_pkey                                  | CREATE UNIQUE INDEX patient_invitations_pkey ON public.patient_invitations USING btree (id)                                                                                 | true      | true       |
| public              | patient_profiles                | idx_patient_profiles_user                                 | CREATE INDEX idx_patient_profiles_user ON public.patient_profiles USING btree (user_id)                                                                                     | false     | false      |
| public              | patient_profiles                | patient_profiles_pkey                                     | CREATE UNIQUE INDEX patient_profiles_pkey ON public.patient_profiles USING btree (id)                                                                                       | true      | true       |
| public              | patient_profiles                | patient_profiles_user_id_key                              | CREATE UNIQUE INDEX patient_profiles_user_id_key ON public.patient_profiles USING btree (user_id)                                                                           | true      | false      |
| public              | profiles                        | idx_profiles_user_type                                    | CREATE INDEX idx_profiles_user_type ON public.profiles USING btree (user_type)                                                                                              | false     | false      |
| public              | profiles                        | profiles_pkey                                             | CREATE UNIQUE INDEX profiles_pkey ON public.profiles USING btree (id)                                                                                                       | true      | true       |
| public              | research_consent                | idx_research_consent_user                                 | CREATE INDEX idx_research_consent_user ON public.research_consent USING btree (user_id)                                                                                     | false     | false      |
| public              | research_consent                | research_consent_pkey                                     | CREATE UNIQUE INDEX research_consent_pkey ON public.research_consent USING btree (id)                                                                                       | true      | true       |
| public              | researcher_onboarding_data      | researcher_onboarding_data_pkey                           | CREATE UNIQUE INDEX researcher_onboarding_data_pkey ON public.researcher_onboarding_data USING btree (id)                                                                   | true      | true       |
| public              | researcher_onboarding_data      | researcher_onboarding_data_user_id_key                    | CREATE UNIQUE INDEX researcher_onboarding_data_user_id_key ON public.researcher_onboarding_data USING btree (user_id)                                                       | true      | false      |
| public              | researcher_profiles             | idx_researcher_profiles_user                              | CREATE INDEX idx_researcher_profiles_user ON public.researcher_profiles USING btree (user_id)                                                                               | false     | false      |
| public              | researcher_profiles             | researcher_profiles_pkey                                  | CREATE UNIQUE INDEX researcher_profiles_pkey ON public.researcher_profiles USING btree (id)                                                                                 | true      | true       |
| public              | researcher_profiles             | researcher_profiles_user_id_key                           | CREATE UNIQUE INDEX researcher_profiles_user_id_key ON public.researcher_profiles USING btree (user_id)                                                                     | true      | false      |
| public              | security_incidents              | idx_security_incidents_severity                           | CREATE INDEX idx_security_incidents_severity ON public.security_incidents USING btree (severity)                                                                            | false     | false      |
| public              | security_incidents              | idx_security_incidents_user                               | CREATE INDEX idx_security_incidents_user ON public.security_incidents USING btree (user_id)                                                                                 | false     | false      |
| public              | security_incidents              | security_incidents_pkey                                   | CREATE UNIQUE INDEX security_incidents_pkey ON public.security_incidents USING btree (id)                                                                                   | true      | true       |
| public              | seizure_signs_reference         | seizure_signs_reference_pkey                              | CREATE UNIQUE INDEX seizure_signs_reference_pkey ON public.seizure_signs_reference USING btree (sign_id)                                                                    | true      | true       |
| public              | seizure_signs_reference         | seizure_signs_reference_sign_name_key                     | CREATE UNIQUE INDEX seizure_signs_reference_sign_name_key ON public.seizure_signs_reference USING btree (sign_name)                                                         | true      | false      |
| public              | seizure_triggers_reference      | seizure_triggers_reference_pkey                           | CREATE UNIQUE INDEX seizure_triggers_reference_pkey ON public.seizure_triggers_reference USING btree (trigger_id)                                                           | true      | true       |
| public              | seizure_triggers_reference      | seizure_triggers_reference_trigger_type_key               | CREATE UNIQUE INDEX seizure_triggers_reference_trigger_type_key ON public.seizure_triggers_reference USING btree (trigger_type)                                             | true      | false      |
| public              | sign_brain_region_mapping       | sign_brain_region_mapping_pkey                            | CREATE UNIQUE INDEX sign_brain_region_mapping_pkey ON public.sign_brain_region_mapping USING btree (id)                                                                     | true      | true       |
| public              | sign_brain_region_mapping       | sign_brain_region_mapping_sign_id_region_id_key           | CREATE UNIQUE INDEX sign_brain_region_mapping_sign_id_region_id_key ON public.sign_brain_region_mapping USING btree (sign_id, region_id)                                    | true      | false      |
| public              | symptom_options                 | symptom_options_pkey                                      | CREATE UNIQUE INDEX symptom_options_pkey ON public.symptom_options USING btree (id)                                                                                         | true      | true       |
| public              | trigger_options                 | trigger_options_pkey                                      | CREATE UNIQUE INDEX trigger_options_pkey ON public.trigger_options USING btree (id)                                                                                         | true      | true       |
| public              | user_achievements               | idx_user_achievements_user                                | CREATE INDEX idx_user_achievements_user ON public.user_achievements USING btree (user_id)                                                                                   | false     | false      |
| public              | user_achievements               | user_achievements_pkey                                    | CREATE UNIQUE INDEX user_achievements_pkey ON public.user_achievements USING btree (id)                                                                                     | true      | true       |
| public              | user_achievements               | user_achievements_user_id_achievement_id_key              | CREATE UNIQUE INDEX user_achievements_user_id_achievement_id_key ON public.user_achievements USING btree (user_id, achievement_id)                                          | true      | false      |
| public              | user_points                     | idx_user_points_user                                      | CREATE INDEX idx_user_points_user ON public.user_points USING btree (user_id)                                                                                               | false     | false      |
| public              | user_points                     | user_points_pkey                                          | CREATE UNIQUE INDEX user_points_pkey ON public.user_points USING btree (id)                                                                                                 | true      | true       |
| public              | user_points                     | user_points_user_id_key                                   | CREATE UNIQUE INDEX user_points_user_id_key ON public.user_points USING btree (user_id)                                                                                     | true      | false      |
| realtime            | messages                        | messages_inserted_at_topic_index                          | CREATE INDEX messages_inserted_at_topic_index ON ONLY realtime.messages USING btree (inserted_at DESC, topic) WHERE ((extension = 'broadcast'::text) AND (private IS TRUE)) | false     | false      |
| realtime            | messages                        | messages_pkey                                             | CREATE UNIQUE INDEX messages_pkey ON ONLY realtime.messages USING btree (id, inserted_at)                                                                                   | true      | true       |
| realtime            | schema_migrations               | schema_migrations_pkey                                    | CREATE UNIQUE INDEX schema_migrations_pkey ON realtime.schema_migrations USING btree (version)                                                                              | true      | true       |
| realtime            | subscription                    | ix_realtime_subscription_entity                           | CREATE INDEX ix_realtime_subscription_entity ON realtime.subscription USING btree (entity)                                                                                  | false     | false      |
| realtime            | subscription                    | pk_subscription                                           | CREATE UNIQUE INDEX pk_subscription ON realtime.subscription USING btree (id)                                                                                               | true      | true       |
| realtime            | subscription                    | subscription_subscription_id_entity_filters_key           | CREATE UNIQUE INDEX subscription_subscription_id_entity_filters_key ON realtime.subscription USING btree (subscription_id, entity, filters)                                 | true      | false      |
| research            | daily_symptom_logs              | daily_symptom_logs_pkey                                   | CREATE UNIQUE INDEX daily_symptom_logs_pkey ON research.daily_symptom_logs USING btree (log_id)                                                                             | true      | true       |
| research            | daily_symptom_logs              | daily_symptom_logs_research_id_log_date_key               | CREATE UNIQUE INDEX daily_symptom_logs_research_id_log_date_key ON research.daily_symptom_logs USING btree (research_id, log_date)                                          | true      | false      |
| research            | daily_symptom_logs              | idx_research_daily_logs_research_id                       | CREATE INDEX idx_research_daily_logs_research_id ON research.daily_symptom_logs USING btree (research_id)                                                                   | false     | false      |
| research            | gait_episodes                   | gait_episodes_pkey                                        | CREATE UNIQUE INDEX gait_episodes_pkey ON research.gait_episodes USING btree (gait_id)                                                                                      | true      | true       |
| research            | gait_episodes                   | idx_research_gait_research_id                             | CREATE INDEX idx_research_gait_research_id ON research.gait_episodes USING btree (research_id)                                                                              | false     | false      |
| research            | seizure_events                  | idx_research_seizures_date                                | CREATE INDEX idx_research_seizures_date ON research.seizure_events USING btree (occurred_at_date DESC)                                                                      | false     | false      |
| research            | seizure_events                  | idx_research_seizures_research_id                         | CREATE INDEX idx_research_seizures_research_id ON research.seizure_events USING btree (research_id)                                                                         | false     | false      |
| research            | seizure_events                  | seizure_events_pkey                                       | CREATE UNIQUE INDEX seizure_events_pkey ON research.seizure_events USING btree (event_id)                                                                                   | true      | true       |
| research            | tremor_episodes                 | idx_research_tremors_research_id                          | CREATE INDEX idx_research_tremors_research_id ON research.tremor_episodes USING btree (research_id)                                                                         | false     | false      |
| research            | tremor_episodes                 | tremor_episodes_pkey                                      | CREATE UNIQUE INDEX tremor_episodes_pkey ON research.tremor_episodes USING btree (tremor_id)                                                                                | true      | true       |
| storage             | buckets                         | bname                                                     | CREATE UNIQUE INDEX bname ON storage.buckets USING btree (name)                                                                                                             | true      | false      |
| storage             | buckets                         | buckets_pkey                                              | CREATE UNIQUE INDEX buckets_pkey ON storage.buckets USING btree (id)                                                                                                        | true      | true       |
| storage             | buckets_analytics               | buckets_analytics_pkey                                    | CREATE UNIQUE INDEX buckets_analytics_pkey ON storage.buckets_analytics USING btree (id)                                                                                    | true      | true       |
| storage             | migrations                      | migrations_name_key                                       | CREATE UNIQUE INDEX migrations_name_key ON storage.migrations USING btree (name)                                                                                            | true      | false      |
| storage             | migrations                      | migrations_pkey                                           | CREATE UNIQUE INDEX migrations_pkey ON storage.migrations USING btree (id)                                                                                                  | true      | true       |
| storage             | objects                         | bucketid_objname                                          | CREATE UNIQUE INDEX bucketid_objname ON storage.objects USING btree (bucket_id, name)                                                                                       | true      | false      |
| storage             | objects                         | idx_name_bucket_level_unique                              | CREATE UNIQUE INDEX idx_name_bucket_level_unique ON storage.objects USING btree (name COLLATE "C", bucket_id, level)                                                        | true      | false      |
| storage             | objects                         | idx_objects_bucket_id_name                                | CREATE INDEX idx_objects_bucket_id_name ON storage.objects USING btree (bucket_id, name COLLATE "C")                                                                        | false     | false      |
| storage             | objects                         | idx_objects_lower_name                                    | CREATE INDEX idx_objects_lower_name ON storage.objects USING btree ((path_tokens[level]), lower(name) text_pattern_ops, bucket_id, level)                                   | false     | false      |
| storage             | objects                         | name_prefix_search                                        | CREATE INDEX name_prefix_search ON storage.objects USING btree (name text_pattern_ops)                                                                                      | false     | false      |
| storage             | objects                         | objects_bucket_id_level_idx                               | CREATE UNIQUE INDEX objects_bucket_id_level_idx ON storage.objects USING btree (bucket_id, level, name COLLATE "C")                                                         | true      | false      |
| storage             | objects                         | objects_pkey                                              | CREATE UNIQUE INDEX objects_pkey ON storage.objects USING btree (id)                                                                                                        | true      | true       |
| storage             | prefixes                        | idx_prefixes_lower_name                                   | CREATE INDEX idx_prefixes_lower_name ON storage.prefixes USING btree (bucket_id, level, ((string_to_array(name, '/'::text))[level]), lower(name) text_pattern_ops)          | false     | false      |
| storage             | prefixes                        | prefixes_pkey                                             | CREATE UNIQUE INDEX prefixes_pkey ON storage.prefixes USING btree (bucket_id, level, name)                                                                                  | true      | true       |
| storage             | s3_multipart_uploads            | idx_multipart_uploads_list                                | CREATE INDEX idx_multipart_uploads_list ON storage.s3_multipart_uploads USING btree (bucket_id, key, created_at)                                                            | false     | false      |
| storage             | s3_multipart_uploads            | s3_multipart_uploads_pkey                                 | CREATE UNIQUE INDEX s3_multipart_uploads_pkey ON storage.s3_multipart_uploads USING btree (id)                                                                              | true      | true       |
| storage             | s3_multipart_uploads_parts      | s3_multipart_uploads_parts_pkey                           | CREATE UNIQUE INDEX s3_multipart_uploads_parts_pkey ON storage.s3_multipart_uploads_parts USING btree (id)                                                                  | true      | true       |
| supabase_migrations | schema_migrations               | schema_migrations_idempotency_key_key                     | CREATE UNIQUE INDEX schema_migrations_idempotency_key_key ON supabase_migrations.schema_migrations USING btree (idempotency_key)                                            | true      | false      |
| supabase_migrations | schema_migrations               | schema_migrations_pkey                                    | CREATE UNIQUE INDEX schema_migrations_pkey ON supabase_migrations.schema_migrations USING btree (version)                                                                   | true      | true       |
| supabase_migrations | seed_files                      | seed_files_pkey                                           | CREATE UNIQUE INDEX seed_files_pkey ON supabase_migrations.seed_files USING btree (path)                                                                                    | true      | true       |
| vault               | secrets                         | secrets_name_idx                                          | CREATE UNIQUE INDEX secrets_name_idx ON vault.secrets USING btree (name) WHERE (name IS NOT NULL)                                                                           | true      | false      |
| vault               | secrets                         | secrets_pkey                                              | CREATE UNIQUE INDEX secrets_pkey ON vault.secrets USING btree (id)                                                                                                          | true      | true       |





-------------

# Enums & Labels (All Schemas)

| schema_name | enum_name                 | sort_order | label                           |
| ----------- | ------------------------- | ---------- | ------------------------------- |
| auth        | aal_level                 | 1          | aal1                            |
| auth        | aal_level                 | 2          | aal2                            |
| auth        | aal_level                 | 3          | aal3                            |
| auth        | code_challenge_method     | 1          | s256                            |
| auth        | code_challenge_method     | 2          | plain                           |
| auth        | factor_status             | 1          | unverified                      |
| auth        | factor_status             | 2          | verified                        |
| auth        | factor_type               | 1          | totp                            |
| auth        | factor_type               | 2          | webauthn                        |
| auth        | factor_type               | 3          | phone                           |
| auth        | oauth_registration_type   | 1          | dynamic                         |
| auth        | oauth_registration_type   | 2          | manual                          |
| auth        | one_time_token_type       | 1          | confirmation_token              |
| auth        | one_time_token_type       | 2          | reauthentication_token          |
| auth        | one_time_token_type       | 3          | recovery_token                  |
| auth        | one_time_token_type       | 4          | email_change_token_new          |
| auth        | one_time_token_type       | 5          | email_change_token_current      |
| auth        | one_time_token_type       | 6          | phone_change_token              |
| public      | assessment_type_enum      | 1          | FOCAL                           |
| public      | assessment_type_enum      | 2          | GENERALIZED                     |
| public      | assessment_type_enum      | 3          | SECONDARY_GENERALIZED           |
| public      | assessment_type_enum      | 4          | UNKNOWN                         |
| public      | brain_lobe_enum           | 1          | TEMPORAL                        |
| public      | brain_lobe_enum           | 2          | FRONTAL                         |
| public      | brain_lobe_enum           | 3          | PARIETAL                        |
| public      | brain_lobe_enum           | 4          | OCCIPITAL                       |
| public      | brain_lobe_enum           | 5          | INSULA                          |
| public      | brain_lobe_enum           | 6          | CINGULATE                       |
| public      | brain_lobe_enum           | 7          | HYPOTHALAMUS                    |
| public      | brain_lobe_enum           | 8          | BILATERAL                       |
| public      | brain_subregion_enum      | 1          | MESIAL_TEMPORAL                 |
| public      | brain_subregion_enum      | 2          | LATERAL_TEMPORAL                |
| public      | brain_subregion_enum      | 3          | ANTERIOR_TEMPORAL               |
| public      | brain_subregion_enum      | 4          | POSTERIOR_TEMPORAL              |
| public      | brain_subregion_enum      | 5          | BASAL_TEMPORAL                  |
| public      | brain_subregion_enum      | 6          | HIPPOCAMPUS                     |
| public      | brain_subregion_enum      | 7          | AMYGDALA                        |
| public      | brain_subregion_enum      | 8          | PRIMARY_MOTOR_CORTEX            |
| public      | brain_subregion_enum      | 9          | PREMOTOR_CORTEX                 |
| public      | brain_subregion_enum      | 10         | SUPPLEMENTARY_MOTOR_AREA        |
| public      | brain_subregion_enum      | 11         | BROCA_AREA                      |
| public      | brain_subregion_enum      | 12         | PREFRONTAL_CORTEX               |
| public      | brain_subregion_enum      | 13         | PRIMARY_SOMATOSENSORY_CORTEX    |
| public      | brain_subregion_enum      | 14         | SUPERIOR_PARIETAL_LOBULE        |
| public      | brain_subregion_enum      | 15         | INFERIOR_PARIETAL_LOBULE        |
| public      | brain_subregion_enum      | 16         | PRIMARY_VISUAL_CORTEX           |
| public      | brain_subregion_enum      | 17         | VISUAL_ASSOCIATION_AREAS        |
| public      | brain_subregion_enum      | 18         | ANTERIOR_INSULA                 |
| public      | brain_subregion_enum      | 19         | POSTERIOR_INSULA                |
| public      | brain_subregion_enum      | 20         | ANTERIOR_CINGULATE              |
| public      | brain_subregion_enum      | 21         | POSTERIOR_CINGULATE             |
| public      | consciousness_level_enum  | 1          | FULL                            |
| public      | consciousness_level_enum  | 2          | PARTIAL                         |
| public      | consciousness_level_enum  | 3          | NONE                            |
| public      | consent_status_enum       | 1          | pending                         |
| public      | consent_status_enum       | 2          | active                          |
| public      | consent_status_enum       | 3          | withdrawn                       |
| public      | consent_status_enum       | 4          | expired                         |
| public      | gender_enum               | 1          | male                            |
| public      | gender_enum               | 2          | female                          |
| public      | gender_enum               | 3          | non_binary                      |
| public      | gender_enum               | 4          | other                           |
| public      | gender_enum               | 5          | prefer_not_to_say               |
| public      | laterality_enum           | 1          | LEFT                            |
| public      | laterality_enum           | 2          | RIGHT                           |
| public      | laterality_enum           | 3          | BILATERAL                       |
| public      | laterality_enum           | 4          | UNKNOWN                         |
| public      | location_type_enum        | 1          | HOME                            |
| public      | location_type_enum        | 2          | WORK                            |
| public      | location_type_enum        | 3          | SCHOOL                          |
| public      | location_type_enum        | 4          | OUTDOORS                        |
| public      | location_type_enum        | 5          | TRANSIT                         |
| public      | location_type_enum        | 6          | CLINICAL                        |
| public      | location_type_enum        | 7          | PUBLIC_PLACE                    |
| public      | location_type_enum        | 8          | UNKNOWN                         |
| public      | medication_adherence_enum | 1          | TAKEN_ON_TIME                   |
| public      | medication_adherence_enum | 2          | LATE                            |
| public      | medication_adherence_enum | 3          | MISSED                          |
| public      | medication_adherence_enum | 4          | UNKNOWN                         |
| public      | post_ictal_symptom_enum   | 1          | CONFUSION                       |
| public      | post_ictal_symptom_enum   | 2          | FATIGUE                         |
| public      | post_ictal_symptom_enum   | 3          | HEADACHE                        |
| public      | post_ictal_symptom_enum   | 4          | AGITATION                       |
| public      | post_ictal_symptom_enum   | 5          | WEAKNESS                        |
| public      | post_ictal_symptom_enum   | 6          | SPEECH_DIFFICULTY               |
| public      | post_ictal_symptom_enum   | 7          | MEMORY_LOSS                     |
| public      | post_ictal_symptom_enum   | 8          | MUSCLE_PAIN                     |
| public      | post_ictal_symptom_enum   | 9          | NAUSEA                          |
| public      | probability_grade_enum    | 1          | VERY_LOW                        |
| public      | probability_grade_enum    | 2          | LOW                             |
| public      | probability_grade_enum    | 3          | MODERATE                        |
| public      | probability_grade_enum    | 4          | HIGH                            |
| public      | probability_grade_enum    | 5          | VERY_HIGH                       |
| public      | relationship_enum         | 1          | parent                          |
| public      | relationship_enum         | 2          | spouse                          |
| public      | relationship_enum         | 3          | partner                         |
| public      | relationship_enum         | 4          | child                           |
| public      | relationship_enum         | 5          | sibling                         |
| public      | relationship_enum         | 6          | friend                          |
| public      | relationship_enum         | 7          | caregiver                       |
| public      | relationship_enum         | 8          | other                           |
| public      | rescue_medication_enum    | 1          | MIDAZOLAM                       |
| public      | rescue_medication_enum    | 2          | DIAZEPAM                        |
| public      | rescue_medication_enum    | 3          | LORAZEPAM                       |
| public      | rescue_medication_enum    | 4          | CLONAZEPAM                      |
| public      | rescue_medication_enum    | 5          | NONE                            |
| public      | rescue_medication_enum    | 6          | OTHER                           |
| public      | research_data_type_enum   | 1          | seizure_data                    |
| public      | research_data_type_enum   | 2          | medication_data                 |
| public      | research_data_type_enum   | 3          | symptom_data                    |
| public      | research_data_type_enum   | 4          | menstrual_data                  |
| public      | research_data_type_enum   | 5          | wearable_data                   |
| public      | research_data_type_enum   | 6          | genetic_data                    |
| public      | research_data_type_enum   | 7          | imaging_data                    |
| public      | research_data_type_enum   | 8          | location_data                   |
| public      | research_data_type_enum   | 9          | demographic_data                |
| public      | research_data_type_enum   | 10         | all_data                        |
| public      | seizure_sign_enum         | 1          | EPIGASTRIC_AURA                 |
| public      | seizure_sign_enum         | 2          | OLFACTORY_AURA                  |
| public      | seizure_sign_enum         | 3          | GUSTATORY_AURA                  |
| public      | seizure_sign_enum         | 4          | VISUAL_AURA                     |
| public      | seizure_sign_enum         | 5          | AUDITORY_AURA                   |
| public      | seizure_sign_enum         | 6          | SOMATOSENSORY_AURA              |
| public      | seizure_sign_enum         | 7          | FEAR_ANXIETY_AURA               |
| public      | seizure_sign_enum         | 8          | DEJA_VU                         |
| public      | seizure_sign_enum         | 9          | JAMAIS_VU                       |
| public      | seizure_sign_enum         | 10         | AUTOMATISMS_ORAL                |
| public      | seizure_sign_enum         | 11         | AUTOMATISMS_MANUAL              |
| public      | seizure_sign_enum         | 12         | TONIC_ACTIVITY                  |
| public      | seizure_sign_enum         | 13         | CLONIC_ACTIVITY                 |
| public      | seizure_sign_enum         | 14         | MYOCLONIC_JERKS                 |
| public      | seizure_sign_enum         | 15         | ATONIC_DROP                     |
| public      | seizure_sign_enum         | 16         | HEAD_VERSION                    |
| public      | seizure_sign_enum         | 17         | EYE_DEVIATION                   |
| public      | seizure_sign_enum         | 18         | DYSTONIC_POSTURING              |
| public      | seizure_sign_enum         | 19         | HYPERMOTOR_ACTIVITY             |
| public      | seizure_sign_enum         | 20         | MIMETIC_AUTOMATISMS             |
| public      | seizure_sign_enum         | 21         | GELASTIC                        |
| public      | seizure_sign_enum         | 22         | DACRYSTIC                       |
| public      | seizure_sign_enum         | 23         | VOCALIZATION                    |
| public      | seizure_sign_enum         | 24         | SPEECH_ARREST                   |
| public      | seizure_sign_enum         | 25         | LOSS_OF_AWARENESS               |
| public      | seizure_sign_enum         | 26         | STARING                         |
| public      | seizure_sign_enum         | 27         | BEHAVIORAL_ARREST               |
| public      | seizure_sign_enum         | 28         | AUTONOMIC_FEATURES              |
| public      | seizure_sign_enum         | 29         | PALLOR                          |
| public      | seizure_sign_enum         | 30         | FLUSHING                        |
| public      | seizure_sign_enum         | 31         | SWEATING                        |
| public      | seizure_sign_enum         | 32         | PILOERECTION                    |
| public      | seizure_sign_enum         | 33         | HEART_RATE_CHANGE               |
| public      | seizure_sign_enum         | 34         | BREATHING_CHANGE                |
| public      | seizure_sign_enum         | 35         | INCONTINENCE                    |
| public      | seizure_sign_enum         | 36         | TONGUE_BITING                   |
| public      | seizure_type_enum         | 1          | FOCAL_AWARE                     |
| public      | seizure_type_enum         | 2          | FOCAL_IMPAIRED                  |
| public      | seizure_type_enum         | 3          | FOCAL_TO_BILATERAL_TONIC_CLONIC |
| public      | seizure_type_enum         | 4          | GENERALIZED_TONIC_CLONIC        |
| public      | seizure_type_enum         | 5          | GENERALIZED_ABSENCE             |
| public      | seizure_type_enum         | 6          | GENERALIZED_MYOCLONIC           |
| public      | seizure_type_enum         | 7          | GENERALIZED_ATONIC              |
| public      | seizure_type_enum         | 8          | GENERALIZED_TONIC               |
| public      | seizure_type_enum         | 9          | GENERALIZED_CLONIC              |
| public      | seizure_type_enum         | 10         | UNKNOWN                         |
| public      | semiology_category_enum   | 1          | AURA                            |
| public      | semiology_category_enum   | 2          | MOTOR                           |
| public      | semiology_category_enum   | 3          | AUTONOMIC                       |
| public      | semiology_category_enum   | 4          | CONSCIOUSNESS                   |
| public      | semiology_category_enum   | 5          | BEHAVIORAL                      |
| public      | semiology_category_enum   | 6          | SENSORY                         |
| public      | stress_level_enum         | 1          | 1                               |
| public      | stress_level_enum         | 2          | 2                               |
| public      | stress_level_enum         | 3          | 3                               |
| public      | stress_level_enum         | 4          | 4                               |
| public      | stress_level_enum         | 5          | 5                               |
| public      | stress_level_enum         | 6          | 6                               |
| public      | stress_level_enum         | 7          | 7                               |
| public      | stress_level_enum         | 8          | 8                               |
| public      | stress_level_enum         | 9          | 9                               |
| public      | stress_level_enum         | 10         | 10                              |
| public      | tracking_feature_enum     | 1          | seizure                         |
| public      | tracking_feature_enum     | 2          | tremor                          |
| public      | tracking_feature_enum     | 3          | gait                            |
| public      | tracking_feature_enum     | 4          | menstruation                    |
| public      | tracking_feature_enum     | 5          | temperature                     |
| public      | tracking_feature_enum     | 6          | mood                            |
| public      | tracking_feature_enum     | 7          | energy                          |
| public      | tracking_feature_enum     | 8          | sleep                           |
| public      | tracking_feature_enum     | 9          | symptoms                        |
| public      | tracking_feature_enum     | 10         | medication                      |
| public      | tracking_feature_enum     | 11         | heart_rate                      |
| public      | tracking_feature_enum     | 12         | blood_pressure                  |
| public      | tracking_feature_enum     | 13         | weight                          |
| public      | tracking_feature_enum     | 14         | exercise                        |
| public      | trigger_strength_enum     | 1          | NONE                            |
| public      | trigger_strength_enum     | 2          | WEAK                            |
| public      | trigger_strength_enum     | 3          | MODERATE                        |
| public      | trigger_strength_enum     | 4          | STRONG                          |
| public      | trigger_type_enum         | 1          | SLEEP_DEPRIVATION               |
| public      | trigger_type_enum         | 2          | FEVER                           |
| public      | trigger_type_enum         | 3          | ALCOHOL                         |
| public      | trigger_type_enum         | 4          | MEDICATION_MISSED               |
| public      | trigger_type_enum         | 5          | EMOTIONAL_STRESS                |
| public      | trigger_type_enum         | 6          | PHYSICAL_STRESS                 |
| public      | trigger_type_enum         | 7          | FLASHING_LIGHTS                 |
| public      | trigger_type_enum         | 8          | MENSTRUATION                    |
| public      | trigger_type_enum         | 9          | ILLNESS                         |
| public      | trigger_type_enum         | 10         | UNKNOWN                         |
| public      | user_type_enum            | 1          | patient                         |
| public      | user_type_enum            | 2          | carer                           |
| public      | user_type_enum            | 3          | clinician                       |
| public      | user_type_enum            | 4          | researcher                      |
| public      | user_type_enum            | 5          | admin                           |
| public      | witness_role_enum         | 1          | SELF                            |
| public      | witness_role_enum         | 2          | FAMILY                          |
| public      | witness_role_enum         | 3          | FRIEND                          |
| public      | witness_role_enum         | 4          | CLINICIAN                       |
| public      | witness_role_enum         | 5          | CARER                           |
| public      | witness_role_enum         | 6          | STRANGER                        |
| public      | witness_role_enum         | 7          | UNKNOWN                         |
| public      | yes_no_enum               | 1          | YES                             |
| public      | yes_no_enum               | 2          | NO                              |
| realtime    | action                    | 1          | INSERT                          |
| realtime    | action                    | 2          | UPDATE                          |
| realtime    | action                    | 3          | DELETE                          |
| realtime    | action                    | 4          | TRUNCATE                        |
| realtime    | action                    | 5          | ERROR                           |
| realtime    | equality_op               | 1          | eq                              |
| realtime    | equality_op               | 2          | neq                             |
| realtime    | equality_op               | 3          | lt                              |
| realtime    | equality_op               | 4          | lte                             |
| realtime    | equality_op               | 5          | gt                              |
| realtime    | equality_op               | 6          | gte                             |
| realtime    | equality_op               | 7          | in                              |
| storage     | buckettype                | 1          | STANDARD                        |
| storage     | buckettype                | 2          | ANALYTICS                       |








------------


# RLS Policies enabled tables and policies (all schemas)

| schema_name         | table_name                      | policy_name                                          | command | using_expr                                                                                                                                                                                                                                                                                          | with_check_expr                                                                                                                                                                                                                                                | roles_oids |
| ------------------- | ------------------------------- | ---------------------------------------------------- | ------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------- |
| clinical            | ai_insights_cards               | Clinicians can manage own insights                   | *       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | ai_insights_cards               | System can generate insights                         | a       | null                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 0          |
| clinical            | ai_insights_cards               | System creates insights                              | a       | null                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 16481      |
| clinical            | ai_insights_cards               | Update own insights                                  | w       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | ai_insights_cards               | View own insights                                    | r       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | case_data_panels                | Clinicians can manage case panels                    | *       | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | case_data_panels                | Clinicians create panels                             | a       | null                                                                                                                                                                                                                                                                                                | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                               | 16481      |
| clinical            | case_data_panels                | Clinicians update panels                             | w       | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | case_data_panels                | View case panels                                     | r       | ((auth.uid() = patient_id) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = case_data_panels.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))                                                                        | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | clinical_notes_exports          | Authors update notes                                 | w       | (auth.uid() = author_id)                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | clinical_notes_exports          | Clinicians can create notes                          | *       | (auth.uid() = author_id)                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | clinical_notes_exports          | Clinicians can view own notes                        | r       | (auth.uid() = author_id)                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | clinical_notes_exports          | Clinicians create notes                              | a       | null                                                                                                                                                                                                                                                                                                | ((auth.uid() = author_id) AND (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))                                                | 16481      |
| clinical            | clinical_notes_exports          | Patients can view shared notes                       | r       | ((auth.uid() = patient_id) AND (status = ANY (ARRAY['finalized'::text, 'shared'::text])))                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | clinical_notes_exports          | View clinical notes                                  | r       | ((auth.uid() = author_id) OR (auth.uid() = patient_id) OR (auth.uid() = ANY (shared_with)) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = clinical_notes_exports.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))  | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | clinical_scale_results          | Clinicians can enter scale results                   | *       | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | clinical_scale_results          | Clinicians can view connected patient scales         | r       | (is_clinician_connected_to_patient(auth.uid(), patient_id) OR (auth.uid() = assessed_by))                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | clinical_scale_results          | Clinicians create scales                             | a       | null                                                                                                                                                                                                                                                                                                | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                               | 16481      |
| clinical            | clinical_scale_results          | Clinicians update scales                             | w       | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | clinical_scale_results          | Patients can view own scale results                  | r       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | clinical_scale_results          | View scale results                                   | r       | ((auth.uid() = patient_id) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = clinical_scale_results.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))                                                                  | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | clinician_today_view            | Clinicians can manage own today view                 | *       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | clinician_today_view            | Create own dashboard                                 | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = clinician_id)                                                                                                                                                                                                                                    | 16481      |
| clinical            | clinician_today_view            | Update own dashboard                                 | w       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | clinician_today_view            | View own dashboard                                   | r       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | neuro_imaging_results           | Clinicians can upload imaging                        | *       | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | neuro_imaging_results           | Clinicians can view connected patient imaging        | r       | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | neuro_imaging_results           | Clinicians update imaging                            | w       | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | neuro_imaging_results           | Clinicians upload imaging                            | a       | null                                                                                                                                                                                                                                                                                                | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                               | 16481      |
| clinical            | neuro_imaging_results           | Patients can view own imaging                        | r       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | neuro_imaging_results           | View imaging results                                 | r       | ((auth.uid() = patient_id) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = neuro_imaging_results.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))                                                                   | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | patient_collab_chat             | Care team send messages                              | a       | null                                                                                                                                                                                                                                                                                                | ((auth.uid() = sender_id) AND ((auth.uid() = patient_id) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = patient_collab_chat.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))) | 16481      |
| clinical            | patient_collab_chat             | Clinicians can send messages                         | a       | null                                                                                                                                                                                                                                                                                                | ((auth.uid() = sender_id) AND is_clinician_connected_to_patient(auth.uid(), patient_id))                                                                                                                                                                       | 0          |
| clinical            | patient_collab_chat             | Participants can view chat                           | r       | ((auth.uid() = sender_id) OR is_clinician_connected_to_patient(auth.uid(), patient_id))                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_collab_chat             | Senders update messages                              | w       | (auth.uid() = sender_id)                                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | patient_collab_chat             | View care team chat                                  | r       | ((auth.uid() = patient_id) OR (auth.uid() = sender_id) OR (auth.uid() = ANY (mentioned_users)) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = patient_collab_chat.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))) | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | patient_pro_timeline            | Clinicians can view connected patient PROs           | r       | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_pro_timeline            | Patients can view own PROs                           | r       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_pro_timeline            | Patients create PROs                                 | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = patient_id)                                                                                                                                                                                                                                      | 16481      |
| clinical            | patient_pro_timeline            | System can insert PROs                               | a       | null                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_pro_timeline            | Update PROs                                          | w       | ((auth.uid() = patient_id) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = patient_pro_timeline.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | patient_pro_timeline            | View PROs                                            | r       | ((auth.uid() = patient_id) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = patient_pro_timeline.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | patient_risk_alerts             | Clinicians can manage alerts                         | *       | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_risk_alerts             | Clinicians can view alerts for connected patients    | r       | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_risk_alerts             | Clinicians create patient alerts                     | a       | null                                                                                                                                                                                                                                                                                                | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                               | 16481      |
| clinical            | patient_risk_alerts             | Clinicians update patient alerts                     | w       | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | patient_risk_alerts             | Clinicians view patient alerts                       | r       | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | patient_risk_alerts             | Patients can view own alerts                         | r       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_snapshots               | Clinicians can create snapshots                      | a       | null                                                                                                                                                                                                                                                                                                | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                      | 0          |
| clinical            | patient_snapshots               | Clinicians can view snapshots for connected patients | r       | is_clinician_connected_to_patient(auth.uid(), patient_id)                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_snapshots               | Clinicians create snapshots                          | a       | null                                                                                                                                                                                                                                                                                                | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                               | 16481      |
| clinical            | patient_snapshots               | Clinicians update snapshots                          | w       | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = pcc.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| clinical            | patient_snapshots               | Patients can view own snapshots                      | r       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| clinical            | patient_snapshots               | System can generate snapshots                        | a       | null                                                                                                                                                                                                                                                                                                | (author = 'ai'::text)                                                                                                                                                                                                                                          | 0          |
| clinical            | patient_snapshots               | View snapshots                                       | r       | ((auth.uid() = patient_id) OR (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = patient_snapshots.patient_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text)))))                                                                       | null                                                                                                                                                                                                                                                           | 16481      |
| linkage             | research_id_map                 | No direct user access to research ID mapping         | *       | false                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | clinical_media                  | Carers can view related patient media                | r       | can_carer_see_patient_data(auth.uid(), patient_id, 'media'::text)                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | clinical_media                  | Clinicians can view connected patient media          | r       | (can_clinician_see_patient_data(auth.uid(), patient_id, 'media'::text) OR (shared_with_clinician = true))                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | clinical_media                  | Patients can manage own media                        | *       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | clinician_onboarding_data       | Users can insert their own clinician onboarding data | a       | null                                                                                                                                                                                                                                                                                                | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | clinician_onboarding_data       | Users can manage own clinician onboarding            | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | clinician_onboarding_data       | Users can update their own clinician onboarding data | w       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | clinician_onboarding_data       | Users can view their own clinician onboarding data   | r       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | clinician_phi                   | Admins can view clinician PHI                        | r       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | clinician_phi                   | Clinicians can insert own PHI                        | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 16481      |
| private_health_info | clinician_phi                   | Clinicians can manage own PHI                        | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | clinician_phi                   | Clinicians can update own PHI                        | w       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 16481      |
| private_health_info | clinician_phi                   | Clinicians can view own PHI                          | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 16481      |
| private_health_info | daily_symptom_logs              | Carers can view related patient logs                 | r       | can_carer_see_patient_data(auth.uid(), patient_id, 'daily_logs'::text)                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | daily_symptom_logs              | Clinicians can view connected patient logs           | r       | (can_clinician_see_patient_data(auth.uid(), patient_id, 'daily_logs'::text) OR (shared_with_clinician = true))                                                                                                                                                                                      | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | daily_symptom_logs              | Patients can manage own daily logs                   | *       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | gait_episodes                   | Carers can view related patient gait                 | r       | can_carer_see_patient_data(auth.uid(), patient_id, 'gait_episodes'::text)                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | gait_episodes                   | Clinicians can view connected patient gait           | r       | (can_clinician_see_patient_data(auth.uid(), patient_id, 'gait_episodes'::text) OR (shared_with_clinician = true))                                                                                                                                                                                   | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | gait_episodes                   | Patients can manage own gait episodes                | *       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | patient_onboarding_data         | Users can insert their own patient onboarding data   | a       | null                                                                                                                                                                                                                                                                                                | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | patient_onboarding_data         | Users can manage own onboarding data                 | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 16481      |
| private_health_info | patient_onboarding_data         | Users can manage own patient onboarding              | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | patient_onboarding_data         | Users can update their own patient onboarding data   | w       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | patient_onboarding_data         | Users can view their own patient onboarding data     | r       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | patient_phi                     | Admins can view PHI for support                      | r       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | patient_phi                     | Clinicians can view connected patient PHI            | r       | is_clinician_connected_to_patient(auth.uid(), user_id)                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | patient_phi                     | Clinicians can view their patients PHI               | r       | (EXISTS ( SELECT 1
   FROM patient_clinician_connections pcc
  WHERE ((pcc.patient_id = patient_phi.user_id) AND (pcc.clinician_id = auth.uid()) AND (pcc.status = 'active'::text))))                                                                                                               | null                                                                                                                                                                                                                                                           | 16481      |
| private_health_info | patient_phi                     | Patients can insert own PHI                          | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 0          |
| private_health_info | patient_phi                     | Patients can update own PHI                          | w       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | patient_phi                     | Patients can view own PHI                            | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_events                  | Carers can view related patient seizures             | r       | (can_carer_see_patient_data(auth.uid(), patient_id, 'seizure_events'::text) AND (shared_with_carers = true))                                                                                                                                                                                        | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_events                  | Clinicians can view connected patient seizures       | r       | (can_clinician_see_patient_data(auth.uid(), patient_id, 'seizure_events'::text) OR (shared_with_clinician = true))                                                                                                                                                                                  | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_events                  | Patients can manage own seizure events               | *       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_generalized_assessment  | Users can view own assessments                       | *       | (EXISTS ( SELECT 1
   FROM private_health_info.seizure_logs_research
  WHERE ((seizure_logs_research.log_id = seizure_generalized_assessment.log_id) AND (seizure_logs_research.user_id = auth.uid()))))                                                                                            | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_log_brain_regions       | Users can view own brain region analysis             | *       | (EXISTS ( SELECT 1
   FROM private_health_info.seizure_logs_research
  WHERE ((seizure_logs_research.log_id = seizure_log_brain_regions.log_id) AND (seizure_logs_research.user_id = auth.uid()))))                                                                                                 | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_log_post_ictal_symptoms | Users can manage own post-ictal symptoms             | *       | (EXISTS ( SELECT 1
   FROM private_health_info.seizure_logs_research
  WHERE ((seizure_logs_research.log_id = seizure_log_post_ictal_symptoms.log_id) AND (seizure_logs_research.user_id = auth.uid()))))                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_log_signs               | Users can manage own seizure log signs               | *       | (EXISTS ( SELECT 1
   FROM private_health_info.seizure_logs_research
  WHERE ((seizure_logs_research.log_id = seizure_log_signs.log_id) AND (seizure_logs_research.user_id = auth.uid()))))                                                                                                         | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_log_triggers            | Users can manage own triggers                        | *       | (EXISTS ( SELECT 1
   FROM private_health_info.seizure_logs_research
  WHERE ((seizure_logs_research.log_id = seizure_log_triggers.log_id) AND (seizure_logs_research.user_id = auth.uid()))))                                                                                                      | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | seizure_logs_research           | Users can manage own seizure logs                    | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | tracking_entries                | Carers can view related patient tracking             | r       | is_carer_related_to_patient(auth.uid(), user_id)                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | tracking_entries                | Clinicians can view connected patient tracking       | r       | is_clinician_connected_to_patient(auth.uid(), user_id)                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | tracking_entries                | Patients can manage own tracking                     | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | tracking_entries                | Users can delete their own tracking entries          | d       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | tracking_entries                | Users can insert their own tracking entries          | a       | null                                                                                                                                                                                                                                                                                                | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | tracking_entries                | Users can update their own tracking entries          | w       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | tracking_entries                | Users can view their own tracking entries            | r       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | tremor_episodes                 | Carers can view related patient tremors              | r       | can_carer_see_patient_data(auth.uid(), patient_id, 'tremor_episodes'::text)                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | tremor_episodes                 | Clinicians can view connected patient tremors        | r       | (can_clinician_see_patient_data(auth.uid(), patient_id, 'tremor_episodes'::text) OR (shared_with_clinician = true))                                                                                                                                                                                 | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | tremor_episodes                 | Patients can manage own tremor episodes              | *       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_conditions                 | Carers can view related patient conditions           | r       | is_carer_related_to_patient(auth.uid(), user_id)                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_conditions                 | Clinicians can view connected patient conditions     | r       | is_clinician_connected_to_patient(auth.uid(), user_id)                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_conditions                 | Patients can manage own conditions                   | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_conditions                 | Users can delete their own conditions                | d       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_conditions                 | Users can insert their own conditions                | a       | null                                                                                                                                                                                                                                                                                                | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | user_conditions                 | Users can update their own conditions                | w       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | user_conditions                 | Users can view their own conditions                  | r       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_medications                | Carers can view related patient medications          | r       | can_carer_see_patient_data(auth.uid(), user_id, 'medications'::text)                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_medications                | Clinicians can view connected patient medications    | r       | can_clinician_see_patient_data(auth.uid(), user_id, 'medications'::text)                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_medications                | Users can delete their own medications               | d       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| private_health_info | user_medications                | Users can insert their own medications               | a       | null                                                                                                                                                                                                                                                                                                | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | user_medications                | Users can update their own medications               | w       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                        | 0          |
| private_health_info | user_medications                | Users can view their own medications                 | r       | (( SELECT auth.uid() AS uid) = user_id)                                                                                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| protected           | system_settings                 | No direct access to system settings                  | *       | false                                                                                                                                                                                                                                                                                               | null                                                                                                                                                                                                                                                           | 0          |
| public              | achievements                    | Auth delete achievements                             | d       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 16481      |
| public              | achievements                    | Auth update achievements                             | w       | true                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 16481      |
| public              | achievements                    | Auth write achievements                              | a       | null                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 16481      |
| public              | achievements                    | Everyone can read achievements                       | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 0          |
| public              | achievements                    | Public read achievements                             | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 16480      |
| public              | audit_log                       | Admins can view all audit logs                       | r       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | audit_log                       | System can insert audit logs                         | a       | null                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 0          |
| public              | audit_log                       | Users can view own audit log                         | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_invitations               | Carers can update invites to accept                  | w       | (auth.uid() = carer_user_id)                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_invitations               | Carers can view invites to them                      | r       | (auth.uid() = carer_user_id)                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_invitations               | Patients can manage carer invites                    | *       | (auth.uid() = patient_user_id)                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_onboarding_data           | Users can manage own carer onboarding                | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_profiles                  | Carers can insert own profile                        | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 0          |
| public              | carer_profiles                  | Carers can update own profile                        | w       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_profiles                  | Carers can view own profile                          | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_profiles                  | Patients can view related carer profiles             | r       | (EXISTS ( SELECT 1
   FROM carer_relationships
  WHERE ((carer_relationships.carer_user_id = carer_profiles.user_id) AND (carer_relationships.patient_user_id = auth.uid()) AND (carer_relationships.status = 'active'::text))))                                                                    | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_relationships             | Both parties can update carer relationships          | w       | ((auth.uid() = patient_user_id) OR (auth.uid() = carer_user_id))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| public              | carer_relationships             | Carers can view own relationships                    | r       | (auth.uid() = carer_user_id)                                                                                                                                                                                                                                                                        | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_relationships             | Patients can create carer relationships              | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = patient_user_id)                                                                                                                                                                                                                                 | 16481      |
| public              | carer_relationships             | Patients can create relationships                    | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = patient_user_id)                                                                                                                                                                                                                                 | 0          |
| public              | carer_relationships             | Patients can manage relationships                    | w       | (auth.uid() = patient_user_id)                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_relationships             | Patients can view own carer relationships            | r       | (auth.uid() = patient_user_id)                                                                                                                                                                                                                                                                      | null                                                                                                                                                                                                                                                           | 0          |
| public              | carer_relationships             | Users can view their own carer relationships         | r       | ((auth.uid() = patient_user_id) OR (auth.uid() = carer_user_id))                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                           | 16481      |
| public              | clinician_profiles              | Clinicians can insert own profile                    | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 0          |
| public              | clinician_profiles              | Clinicians can update own profile                    | w       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | clinician_profiles              | Everyone can view clinician profiles                 | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 0          |
| public              | clinician_profiles              | Users can insert own clinician_profile               | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 16481      |
| public              | clinician_profiles              | Users can read own clinician_profile                 | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 16481      |
| public              | clinician_profiles              | Users can update own clinician_profile               | w       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 16481      |
| public              | conditions                      | Admins can manage conditions                         | *       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | conditions                      | Auth delete conditions                               | d       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 16481      |
| public              | conditions                      | Auth update conditions                               | w       | true                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 16481      |
| public              | conditions                      | Auth write conditions                                | a       | null                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 16481      |
| public              | conditions                      | Everyone can read conditions                         | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 0          |
| public              | conditions                      | Public read conditions                               | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 16480      |
| public              | data_sharing_preferences        | Patients can manage own sharing preferences          | *       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| public              | medications                     | Admins can manage medications                        | *       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | medications                     | Auth delete medications                              | d       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 16481      |
| public              | medications                     | Auth update medications                              | w       | true                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 16481      |
| public              | medications                     | Auth write medications                               | a       | null                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 16481      |
| public              | medications                     | Authenticated users can view medications             | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 16481      |
| public              | medications                     | Everyone can read medications                        | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 0          |
| public              | medications                     | Public read medications                              | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 16480      |
| public              | patient_clinician_connections   | Admins can view all connections                      | r       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_clinician_connections   | Both parties can update connections                  | w       | ((auth.uid() = patient_id) OR (auth.uid() = clinician_id))                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 16481      |
| public              | patient_clinician_connections   | Clinicians can create connections                    | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = clinician_id)                                                                                                                                                                                                                                    | 0          |
| public              | patient_clinician_connections   | Clinicians can view own connections                  | r       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_clinician_connections   | Patients can manage own connections                  | w       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_clinician_connections   | Patients can view own connections                    | r       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_clinician_connections   | Users can view their own connections                 | r       | ((auth.uid() = patient_id) OR (auth.uid() = clinician_id))                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 16481      |
| public              | patient_invitations             | Clinicians can create invites                        | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = clinician_id)                                                                                                                                                                                                                                    | 0          |
| public              | patient_invitations             | Clinicians can update own invites                    | w       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_invitations             | Clinicians can view own invites                      | r       | (auth.uid() = clinician_id)                                                                                                                                                                                                                                                                         | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_invitations             | Patients can view invites to them                    | r       | (auth.uid() = patient_id)                                                                                                                                                                                                                                                                           | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_profiles                | Carers can view related patient profiles             | r       | is_carer_related_to_patient(auth.uid(), user_id)                                                                                                                                                                                                                                                    | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_profiles                | Clinicians can view connected patient profiles       | r       | is_clinician_connected_to_patient(auth.uid(), user_id)                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_profiles                | Clinicians can view patient_profiles                 | r       | (EXISTS ( SELECT 1
   FROM patient_clinician_connections
  WHERE ((patient_clinician_connections.patient_id = patient_profiles.user_id) AND (patient_clinician_connections.clinician_id = auth.uid()) AND (patient_clinician_connections.status = 'active'::text))))                                | null                                                                                                                                                                                                                                                           | 16481      |
| public              | patient_profiles                | Patients can insert own profile                      | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 0          |
| public              | patient_profiles                | Patients can update own profile                      | w       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_profiles                | Patients can view own profile                        | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | patient_profiles                | Users can insert own patient_profile                 | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 16481      |
| public              | patient_profiles                | Users can manage own patient profile                 | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 16481      |
| public              | patient_profiles                | Users can read own patient_profile                   | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 16481      |
| public              | patient_profiles                | Users can update own patient_profile                 | w       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 16481      |
| public              | profiles                        | Admins can view all profiles                         | r       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | profiles                        | Carers can view related patient profiles             | r       | ((get_user_type(auth.uid()) = 'carer'::text) AND is_carer_related_to_patient(auth.uid(), id))                                                                                                                                                                                                       | null                                                                                                                                                                                                                                                           | 0          |
| public              | profiles                        | Clinicians can view connected patient profiles       | r       | ((get_user_type(auth.uid()) = 'clinician'::text) AND is_clinician_connected_to_patient(auth.uid(), id))                                                                                                                                                                                             | null                                                                                                                                                                                                                                                           | 0          |
| public              | profiles                        | Service role has full access                         | *       | true                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 16482      |
| public              | profiles                        | System can insert profiles                           | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = id)                                                                                                                                                                                                                                              | 0          |
| public              | profiles                        | Users can insert own profile                         | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = id)                                                                                                                                                                                                                                              | 16481      |
| public              | profiles                        | Users can read own profile                           | r       | (auth.uid() = id)                                                                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                           | 16481      |
| public              | profiles                        | Users can update own profile                         | w       | (auth.uid() = id)                                                                                                                                                                                                                                                                                   | (auth.uid() = id)                                                                                                                                                                                                                                              | 16481      |
| public              | profiles                        | Users can view own profile                           | r       | (auth.uid() = id)                                                                                                                                                                                                                                                                                   | null                                                                                                                                                                                                                                                           | 16481      |
| public              | research_consent                | Admins can view consent                              | r       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | research_consent                | Users can manage own research consent                | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | researcher_onboarding_data      | Users can manage own researcher onboarding           | *       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | researcher_profiles             | Admins can view researcher profiles                  | r       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | researcher_profiles             | Researchers can insert own profile                   | a       | null                                                                                                                                                                                                                                                                                                | (auth.uid() = user_id)                                                                                                                                                                                                                                         | 0          |
| public              | researcher_profiles             | Researchers can update own profile                   | w       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | researcher_profiles             | Researchers can view own profile                     | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | security_incidents              | Admins can manage security incidents                 | *       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | symptom_options                 | Admins can manage symptom options                    | *       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | symptom_options                 | Everyone can read symptom options                    | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 0          |
| public              | trigger_options                 | Admins can manage trigger options                    | *       | is_admin()                                                                                                                                                                                                                                                                                          | null                                                                                                                                                                                                                                                           | 0          |
| public              | trigger_options                 | Everyone can read trigger options                    | r       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 0          |
| public              | user_achievements               | System can award achievements                        | a       | null                                                                                                                                                                                                                                                                                                | true                                                                                                                                                                                                                                                           | 0          |
| public              | user_achievements               | Users can view own achievements                      | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| public              | user_points                     | System can manage points                             | *       | true                                                                                                                                                                                                                                                                                                | null                                                                                                                                                                                                                                                           | 0          |
| public              | user_points                     | Users can view own points                            | r       | (auth.uid() = user_id)                                                                                                                                                                                                                                                                              | null                                                                                                                                                                                                                                                           | 0          |
| research            | daily_symptom_logs              | Approved researchers can read daily logs             | r       | (is_approved_researcher() OR is_admin())                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 0          |
| research            | daily_symptom_logs              | System can insert daily logs                         | a       | null                                                                                                                                                                                                                                                                                                | false                                                                                                                                                                                                                                                          | 0          |
| research            | gait_episodes                   | Approved researchers can read gait data              | r       | (is_approved_researcher() OR is_admin())                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 0          |
| research            | gait_episodes                   | System can insert gait data                          | a       | null                                                                                                                                                                                                                                                                                                | false                                                                                                                                                                                                                                                          | 0          |
| research            | seizure_events                  | Approved researchers can read seizure data           | r       | (is_approved_researcher() OR is_admin())                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 0          |
| research            | seizure_events                  | System can insert anonymized data                    | a       | null                                                                                                                                                                                                                                                                                                | false                                                                                                                                                                                                                                                          | 0          |
| research            | tremor_episodes                 | Approved researchers can read tremor data            | r       | (is_approved_researcher() OR is_admin())                                                                                                                                                                                                                                                            | null                                                                                                                                                                                                                                                           | 0          |
| research            | tremor_episodes                 | System can insert tremor data                        | a       | null                                                                                                                                                                                                                                                                                                | false                                                                                                                                                                                                                                                          | 0          |















-------------------


# Triggers (all schemas)



| schema_name         | table_name                | trigger_name                          | granularity | events              | timing | function_name                                       | trigger_def                                                                                                                                                                                                      |
| ------------------- | ------------------------- | ------------------------------------- | ----------- | ------------------- | ------ | --------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| auth                | users                     | on_auth_user_created                  | ROW         | ["INSERT"]          | AFTER  | public.handle_new_user                              | CREATE TRIGGER on_auth_user_created AFTER INSERT ON auth.users FOR EACH ROW EXECUTE FUNCTION handle_new_user()                                                                                                   |
| private_health_info | clinician_onboarding_data | update_clinician_onboarding_timestamp | ROW         | ["UPDATE"]          | BEFORE | private_health_info.update_onboarding_timestamp     | CREATE TRIGGER update_clinician_onboarding_timestamp BEFORE UPDATE ON private_health_info.clinician_onboarding_data FOR EACH ROW EXECUTE FUNCTION private_health_info.update_onboarding_timestamp()              |
| private_health_info | daily_symptom_logs        | daily_log_to_research_trigger         | ROW         | ["INSERT","UPDATE"] | AFTER  | private_health_info.anonymize_daily_log_to_research | CREATE TRIGGER daily_log_to_research_trigger AFTER INSERT OR UPDATE ON private_health_info.daily_symptom_logs FOR EACH ROW EXECUTE FUNCTION private_health_info.anonymize_daily_log_to_research()                |
| private_health_info | gait_episodes             | gait_to_research_trigger              | ROW         | ["INSERT","UPDATE"] | AFTER  | private_health_info.anonymize_gait_to_research      | CREATE TRIGGER gait_to_research_trigger AFTER INSERT OR UPDATE ON private_health_info.gait_episodes FOR EACH ROW EXECUTE FUNCTION private_health_info.anonymize_gait_to_research()                               |
| private_health_info | patient_onboarding_data   | update_patient_onboarding_timestamp   | ROW         | ["UPDATE"]          | BEFORE | private_health_info.update_onboarding_timestamp     | CREATE TRIGGER update_patient_onboarding_timestamp BEFORE UPDATE ON private_health_info.patient_onboarding_data FOR EACH ROW EXECUTE FUNCTION private_health_info.update_onboarding_timestamp()                  |
| private_health_info | seizure_events            | seizure_to_research_trigger           | ROW         | ["INSERT","UPDATE"] | AFTER  | private_health_info.anonymize_seizure_to_research   | CREATE TRIGGER seizure_to_research_trigger AFTER INSERT OR UPDATE ON private_health_info.seizure_events FOR EACH ROW EXECUTE FUNCTION private_health_info.anonymize_seizure_to_research()                        |
| private_health_info | tremor_episodes           | tremor_to_research_trigger            | ROW         | ["INSERT","UPDATE"] | AFTER  | private_health_info.anonymize_tremor_to_research    | CREATE TRIGGER tremor_to_research_trigger AFTER INSERT OR UPDATE ON private_health_info.tremor_episodes FOR EACH ROW EXECUTE FUNCTION private_health_info.anonymize_tremor_to_research()                         |
| realtime            | subscription              | tr_check_filters                      | ROW         | ["INSERT","UPDATE"] | BEFORE | realtime.subscription_check_filters                 | CREATE TRIGGER tr_check_filters BEFORE INSERT OR UPDATE ON realtime.subscription FOR EACH ROW EXECUTE FUNCTION realtime.subscription_check_filters()                                                             |
| storage             | buckets                   | enforce_bucket_name_length_trigger    | ROW         | ["INSERT","UPDATE"] | BEFORE | storage.enforce_bucket_name_length                  | CREATE TRIGGER enforce_bucket_name_length_trigger BEFORE INSERT OR UPDATE OF name ON storage.buckets FOR EACH ROW EXECUTE FUNCTION storage.enforce_bucket_name_length()                                          |
| storage             | objects                   | objects_delete_delete_prefix          | ROW         | ["DELETE"]          | AFTER  | storage.delete_prefix_hierarchy_trigger             | CREATE TRIGGER objects_delete_delete_prefix AFTER DELETE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger()                                                              |
| storage             | objects                   | objects_insert_create_prefix          | ROW         | ["INSERT"]          | BEFORE | storage.objects_insert_prefix_trigger               | CREATE TRIGGER objects_insert_create_prefix BEFORE INSERT ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.objects_insert_prefix_trigger()                                                               |
| storage             | objects                   | objects_update_create_prefix          | ROW         | ["UPDATE"]          | BEFORE | storage.objects_update_prefix_trigger               | CREATE TRIGGER objects_update_create_prefix BEFORE UPDATE ON storage.objects FOR EACH ROW WHEN (new.name <> old.name OR new.bucket_id <> old.bucket_id) EXECUTE FUNCTION storage.objects_update_prefix_trigger() |
| storage             | objects                   | update_objects_updated_at             | ROW         | ["UPDATE"]          | BEFORE | storage.update_updated_at_column                    | CREATE TRIGGER update_objects_updated_at BEFORE UPDATE ON storage.objects FOR EACH ROW EXECUTE FUNCTION storage.update_updated_at_column()                                                                       |
| storage             | prefixes                  | prefixes_create_hierarchy             | ROW         | ["INSERT"]          | BEFORE | storage.prefixes_insert_trigger                     | CREATE TRIGGER prefixes_create_hierarchy BEFORE INSERT ON storage.prefixes FOR EACH ROW WHEN (pg_trigger_depth() < 1) EXECUTE FUNCTION storage.prefixes_insert_trigger()                                         |
| storage             | prefixes                  | prefixes_delete_hierarchy             | ROW         | ["DELETE"]          | AFTER  | storage.delete_prefix_hierarchy_trigger             | CREATE TRIGGER prefixes_delete_hierarchy AFTER DELETE ON storage.prefixes FOR EACH ROW EXECUTE FUNCTION storage.delete_prefix_hierarchy_trigger()                                                                |







----------




# Functions (all schemas) with argument types and return type

| schema_name         | function_name                         | args_signature                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | return_type                                                                                                                                                              | language | security_definer | volatility | parallel | comment                                                                                                                             |
| ------------------- | ------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------- | ---------------- | ---------- | -------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| auth                | email                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                     | sql      | false            | s          | u        | Deprecated. Use auth.jwt() -> 'email' instead.                                                                                      |
| auth                | jwt                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | jsonb                                                                                                                                                                    | sql      | false            | s          | u        | null                                                                                                                                |
| auth                | role                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                     | sql      | false            | s          | u        | Deprecated. Use auth.jwt() -> 'role' instead.                                                                                       |
| auth                | uid                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | sql      | false            | s          | u        | Deprecated. Use auth.jwt() -> 'sub' instead.                                                                                        |
| extensions          | armor                                 | bytea, text[], text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | armor                                 | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | crypt                                 | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | dearmor                               | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | decrypt                               | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | decrypt_iv                            | bytea, bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | digest                                | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | digest                                | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | encrypt                               | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | encrypt_iv                            | bytea, bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | gen_random_bytes                      | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | gen_random_uuid                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | gen_salt                              | text, integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | text                                                                                                                                                                     | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | gen_salt                              | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | text                                                                                                                                                                     | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | grant_pg_cron_access                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                            | plpgsql  | false            | v          | u        | Grants access to pg_cron                                                                                                            |
| extensions          | grant_pg_graphql_access               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                            | plpgsql  | false            | v          | u        | Grants access to pg_graphql                                                                                                         |
| extensions          | grant_pg_net_access                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                            | plpgsql  | false            | v          | u        | Grants access to pg_net                                                                                                             |
| extensions          | hmac                                  | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | hmac                                  | text, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pg_stat_statements                    | showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone | SETOF record                                                                                                                                                             | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pg_stat_statements_info               | OUT dealloc bigint, OUT stats_reset timestamp with time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | record                                                                                                                                                                   | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pg_stat_statements_reset              | userid oid, dbid oid, queryid bigint, minmax_only boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | timestamp with time zone                                                                                                                                                 | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgp_armor_headers                     | text, OUT key text, OUT value text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | SETOF record                                                                                                                                                             | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_key_id                            | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_pub_decrypt                       | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_pub_decrypt                       | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_pub_decrypt                       | bytea, bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_pub_decrypt_bytea                 | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_pub_decrypt_bytea                 | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_pub_decrypt_bytea                 | bytea, bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_pub_encrypt                       | text, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgp_pub_encrypt                       | text, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgp_pub_encrypt_bytea                 | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgp_pub_encrypt_bytea                 | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgp_sym_decrypt                       | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_sym_decrypt                       | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | text                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_sym_decrypt_bytea                 | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_sym_decrypt_bytea                 | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bytea                                                                                                                                                                    | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | pgp_sym_encrypt                       | text, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgp_sym_encrypt                       | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgp_sym_encrypt_bytea                 | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgp_sym_encrypt_bytea                 | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | bytea                                                                                                                                                                    | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | pgrst_ddl_watch                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                            | plpgsql  | false            | v          | u        | null                                                                                                                                |
| extensions          | pgrst_drop_watch                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                            | plpgsql  | false            | v          | u        | null                                                                                                                                |
| extensions          | set_graphql_placeholder               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                            | plpgsql  | false            | v          | u        | Reintroduces placeholder function for graphql_public.graphql                                                                        |
| extensions          | uuid_generate_v1                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | uuid_generate_v1mc                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | uuid_generate_v3                      | namespace uuid, name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | uuid                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | uuid_generate_v4                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | v          | s        | null                                                                                                                                |
| extensions          | uuid_generate_v5                      | namespace uuid, name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | uuid                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | uuid_nil                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | uuid_ns_dns                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | uuid_ns_oid                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | uuid_ns_url                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| extensions          | uuid_ns_x500                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | uuid                                                                                                                                                                     | c        | false            | i          | s        | null                                                                                                                                |
| graphql             | _internal_resolve                     | query text, variables jsonb, "operationName" text, extensions jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | jsonb                                                                                                                                                                    | c        | false            | v          | u        | null                                                                                                                                |
| graphql             | comment_directive                     | comment_ text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | jsonb                                                                                                                                                                    | sql      | false            | i          | u        | null                                                                                                                                |
| graphql             | exception                             | message text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | text                                                                                                                                                                     | plpgsql  | false            | v          | u        | null                                                                                                                                |
| graphql             | get_schema_version                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | integer                                                                                                                                                                  | sql      | true             | v          | u        | null                                                                                                                                |
| graphql             | increment_schema_version              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | event_trigger                                                                                                                                                            | plpgsql  | true             | v          | u        | null                                                                                                                                |
| graphql             | resolve                               | query text, variables jsonb, "operationName" text, extensions jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | jsonb                                                                                                                                                                    | plpgsql  | false            | v          | u        | null                                                                                                                                |
| graphql_public      | graphql                               | "operationName" text, query text, variables jsonb, extensions jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | jsonb                                                                                                                                                                    | sql      | false            | v          | u        | null                                                                                                                                |
| private_health_info | anonymize_daily_log_to_research       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| private_health_info | anonymize_gait_to_research            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| private_health_info | anonymize_seizure_to_research         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| private_health_info | anonymize_tremor_to_research          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| private_health_info | check_research_consent                | p_patient_id uuid, p_data_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | boolean                                                                                                                                                                  | plpgsql  | true             | v          | u        | Checks if patient has consented to research data sharing for specific data type                                                     |
| private_health_info | update_onboarding_timestamp           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| public              | can_carer_see_patient_data            | p_carer_id uuid, p_patient_id uuid, p_data_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | boolean                                                                                                                                                                  | plpgsql  | true             | v          | u        | Check if carer can see patient data based on sharing preferences                                                                    |
| public              | can_clinician_see_patient_data        | p_clinician_id uuid, p_patient_id uuid, p_data_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | boolean                                                                                                                                                                  | plpgsql  | true             | v          | u        | Check if clinician can see patient data based on sharing preferences                                                                |
| public              | complete_onboarding                   | p_user_id uuid, p_user_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | json                                                                                                                                                                     | plpgsql  | true             | v          | u        | Mark user onboarding as complete and award welcome achievement                                                                      |
| public              | get_research_id                       | p_user_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | uuid                                                                                                                                                                     | plpgsql  | true             | v          | u        | Secure function to retrieve research ID without exposing linkage table. This is the ONLY way app code should get research IDs.      |
| public              | get_user_type                         | p_user_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | text                                                                                                                                                                     | plpgsql  | true             | v          | u        | Get user type for given user ID                                                                                                     |
| public              | handle_new_user                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| public              | initialize_new_user                   | p_user_id uuid, p_email text, p_user_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | json                                                                                                                                                                     | plpgsql  | true             | v          | u        | Initialize new user profile, onboarding, points, and privacy settings. Call this after user signup via webhook or application code. |
| public              | initialize_new_user_jsonb             | p_user_id uuid, p_email text, p_user_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | jsonb                                                                                                                                                                    | plpgsql  | true             | v          | u        | null                                                                                                                                |
| public              | is_admin                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | boolean                                                                                                                                                                  | plpgsql  | true             | v          | u        | Check if current user is admin                                                                                                      |
| public              | is_approved_researcher                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | boolean                                                                                                                                                                  | plpgsql  | true             | v          | u        | Check if current user is an approved researcher with data access                                                                    |
| public              | is_carer_related_to_patient           | p_carer_id uuid, p_patient_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | boolean                                                                                                                                                                  | plpgsql  | true             | v          | u        | Check if carer has active relationship to patient                                                                                   |
| public              | is_clinician_connected_to_patient     | p_clinician_id uuid, p_patient_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | boolean                                                                                                                                                                  | plpgsql  | true             | v          | u        | Check if clinician has active connection to patient                                                                                 |
| realtime            | apply_rls                             | wal jsonb, max_record_bytes integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | SETOF realtime.wal_rls                                                                                                                                                   | plpgsql  | false            | v          | u        | null                                                                                                                                |
| realtime            | broadcast_changes                     | topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | void                                                                                                                                                                     | plpgsql  | false            | v          | u        | null                                                                                                                                |
| realtime            | build_prepared_statement_sql          | prepared_statement_name text, entity regclass, columns realtime.wal_column[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | text                                                                                                                                                                     | sql      | false            | v          | u        | null                                                                                                                                |
| realtime            | cast                                  | val text, type_ regtype                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | jsonb                                                                                                                                                                    | plpgsql  | false            | i          | u        | null                                                                                                                                |
| realtime            | check_equality_op                     | op realtime.equality_op, type_ regtype, val_1 text, val_2 text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | boolean                                                                                                                                                                  | plpgsql  | false            | i          | u        | null                                                                                                                                |
| realtime            | is_visible_through_filters            | columns realtime.wal_column[], filters realtime.user_defined_filter[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | boolean                                                                                                                                                                  | sql      | false            | i          | u        | null                                                                                                                                |
| realtime            | list_changes                          | publication name, slot_name name, max_changes integer, max_record_bytes integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | SETOF realtime.wal_rls                                                                                                                                                   | sql      | false            | v          | u        | null                                                                                                                                |
| realtime            | quote_wal2json                        | entity regclass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                     | sql      | false            | i          | u        | null                                                                                                                                |
| realtime            | send                                  | payload jsonb, event text, topic text, private boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | void                                                                                                                                                                     | plpgsql  | false            | v          | u        | null                                                                                                                                |
| realtime            | subscription_check_filters            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | false            | v          | u        | null                                                                                                                                |
| realtime            | to_regrole                            | role_name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | regrole                                                                                                                                                                  | sql      | false            | i          | u        | null                                                                                                                                |
| realtime            | topic                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                     | sql      | false            | s          | u        | null                                                                                                                                |
| storage             | add_prefixes                          | _bucket_id text, _name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | void                                                                                                                                                                     | plpgsql  | true             | v          | u        | null                                                                                                                                |
| storage             | can_insert_object                     | bucketid text, name text, owner uuid, metadata jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | void                                                                                                                                                                     | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | delete_leaf_prefixes                  | bucket_ids text[], names text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                     | plpgsql  | true             | v          | u        | null                                                                                                                                |
| storage             | delete_prefix                         | _bucket_id text, _name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | boolean                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| storage             | delete_prefix_hierarchy_trigger       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | enforce_bucket_name_length            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | extension                             | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text                                                                                                                                                                     | plpgsql  | false            | i          | u        | null                                                                                                                                |
| storage             | filename                              | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text                                                                                                                                                                     | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | foldername                            | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text[]                                                                                                                                                                   | plpgsql  | false            | i          | u        | null                                                                                                                                |
| storage             | get_level                             | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | integer                                                                                                                                                                  | sql      | false            | i          | u        | null                                                                                                                                |
| storage             | get_prefix                            | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text                                                                                                                                                                     | sql      | false            | i          | u        | null                                                                                                                                |
| storage             | get_prefixes                          | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | text[]                                                                                                                                                                   | plpgsql  | false            | i          | u        | null                                                                                                                                |
| storage             | get_size_by_bucket                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | TABLE(size bigint, bucket_id text)                                                                                                                                       | plpgsql  | false            | s          | u        | null                                                                                                                                |
| storage             | list_multipart_uploads_with_delimiter | bucket_id text, prefix_param text, delimiter_param text, max_keys integer, next_key_token text, next_upload_token text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | TABLE(key text, id text, created_at timestamp with time zone)                                                                                                            | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | list_objects_with_delimiter           | bucket_id text, prefix_param text, delimiter_param text, max_keys integer, start_after text, next_token text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | TABLE(name text, id uuid, metadata jsonb, updated_at timestamp with time zone)                                                                                           | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | lock_top_prefixes                     | bucket_ids text[], names text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | void                                                                                                                                                                     | plpgsql  | true             | v          | u        | null                                                                                                                                |
| storage             | objects_delete_cleanup                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| storage             | objects_insert_prefix_trigger         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | objects_update_cleanup                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| storage             | objects_update_level_trigger          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | objects_update_prefix_trigger         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | operation                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | text                                                                                                                                                                     | plpgsql  | false            | s          | u        | null                                                                                                                                |
| storage             | prefixes_delete_cleanup               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | true             | v          | u        | null                                                                                                                                |
| storage             | prefixes_insert_trigger               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | search                                | prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)           | plpgsql  | false            | v          | u        | null                                                                                                                                |
| storage             | search_legacy_v1                      | prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)           | plpgsql  | false            | s          | u        | null                                                                                                                                |
| storage             | search_v1_optimised                   | prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)           | plpgsql  | false            | s          | u        | null                                                                                                                                |
| storage             | search_v2                             | prefix text, bucket_name text, limits integer, levels integer, start_after text, sort_order text, sort_column text, sort_column_after text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | TABLE(key text, name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb) | plpgsql  | false            | s          | u        | null                                                                                                                                |
| storage             | update_updated_at_column              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | trigger                                                                                                                                                                  | plpgsql  | false            | v          | u        | null                                                                                                                                |
| vault               | _crypto_aead_det_decrypt              | message bytea, additional bytea, key_id bigint, context bytea, nonce bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | bytea                                                                                                                                                                    | c        | false            | i          | u        | null                                                                                                                                |
| vault               | _crypto_aead_det_encrypt              | message bytea, additional bytea, key_id bigint, context bytea, nonce bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | bytea                                                                                                                                                                    | c        | false            | i          | u        | null                                                                                                                                |
| vault               | _crypto_aead_det_noncegen             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | bytea                                                                                                                                                                    | c        | false            | i          | u        | null                                                                                                                                |
| vault               | create_secret                         | new_secret text, new_name text, new_description text, new_key_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | uuid                                                                                                                                                                     | plpgsql  | true             | v          | u        | null                                                                                                                                |
| vault               | update_secret                         | secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | void                                                                                                                                                                     | plpgsql  | true             | v          | u        | null                                                                                                                                |









---------


# Function source code (be cautious: can be large). Filter by schema if needed.


| schema_name         | function_name                         | args_signature                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | definition                                                                                                                                                                  |
| ------------------- | ------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| auth                | email                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION auth.email()
 RETURNS text
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.email', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'email')
  )::text
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| auth                | jwt                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION auth.jwt()
 RETURNS jsonb
 LANGUAGE sql
 STABLE
AS $function$
  select 
    coalesce(
        nullif(current_setting('request.jwt.claim', true), ''),
        nullif(current_setting('request.jwt.claims', true), '')
    )::jsonb
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| auth                | role                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION auth.role()
 RETURNS text
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.role', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'role')
  )::text
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| auth                | uid                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION auth.uid()
 RETURNS uuid
 LANGUAGE sql
 STABLE
AS $function$
  select 
  coalesce(
    nullif(current_setting('request.jwt.claim.sub', true), ''),
    (nullif(current_setting('request.jwt.claims', true), '')::jsonb ->> 'sub')
  )::uuid
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| extensions          | armor                                 | bytea, text[], text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | CREATE OR REPLACE FUNCTION extensions.armor(bytea, text[], text[])
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_armor$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions          | armor                                 | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | CREATE OR REPLACE FUNCTION extensions.armor(bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_armor$function$
           |
| extensions          | crypt                                 | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | CREATE OR REPLACE FUNCTION extensions.crypt(text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_crypt$function$
      |
| extensions          | dearmor                               | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | CREATE OR REPLACE FUNCTION extensions.dearmor(text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_dearmor$function$
       |
| extensions          | decrypt                               | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | CREATE OR REPLACE FUNCTION extensions.decrypt(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_decrypt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| extensions          | decrypt_iv                            | bytea, bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION extensions.decrypt_iv(bytea, bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_decrypt_iv$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions          | digest                                | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | CREATE OR REPLACE FUNCTION extensions.digest(text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_digest$function$
   |
| extensions          | digest                                | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION extensions.digest(bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_digest$function$
  |
| extensions          | encrypt                               | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | CREATE OR REPLACE FUNCTION extensions.encrypt(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_encrypt$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| extensions          | encrypt_iv                            | bytea, bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION extensions.encrypt_iv(bytea, bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_encrypt_iv$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| extensions          | gen_random_bytes                      | integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | CREATE OR REPLACE FUNCTION extensions.gen_random_bytes(integer)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_random_bytes$function$
|
| extensions          | gen_random_uuid                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.gen_random_uuid()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE
AS '$libdir/pgcrypto', $function$pg_random_uuid$function$
                 |
| extensions          | gen_salt                              | text, integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | CREATE OR REPLACE FUNCTION extensions.gen_salt(text, integer)
 RETURNS text
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_gen_salt_rounds$function$
|
| extensions          | gen_salt                              | text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | CREATE OR REPLACE FUNCTION extensions.gen_salt(text)
 RETURNS text
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_gen_salt$function$
                |
| extensions          | grant_pg_cron_access                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.grant_pg_cron_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF EXISTS (
    SELECT
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_cron'
  )
  THEN
    grant usage on schema cron to postgres with grant option;

    alter default privileges in schema cron grant all on tables to postgres with grant option;
    alter default privileges in schema cron grant all on functions to postgres with grant option;
    alter default privileges in schema cron grant all on sequences to postgres with grant option;

    alter default privileges for user supabase_admin in schema cron grant all
        on sequences to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on tables to postgres with grant option;
    alter default privileges for user supabase_admin in schema cron grant all
        on functions to postgres with grant option;

    grant all privileges on all tables in schema cron to postgres with grant option;
    revoke all on table cron.job from postgres;
    grant select on table cron.job to postgres with grant option;
  END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions          | grant_pg_graphql_access               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.grant_pg_graphql_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    func_is_graphql_resolve bool;
BEGIN
    func_is_graphql_resolve = (
        SELECT n.proname = 'resolve'
        FROM pg_event_trigger_ddl_commands() AS ev
        LEFT JOIN pg_catalog.pg_proc AS n
        ON ev.objid = n.oid
    );

    IF func_is_graphql_resolve
    THEN
        -- Update public wrapper to pass all arguments through to the pg_graphql resolve func
        DROP FUNCTION IF EXISTS graphql_public.graphql;
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language sql
        as $$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $$;

        -- This hook executes when `graphql.resolve` is created. That is not necessarily the last
        -- function in the extension so we need to grant permissions on existing entities AND
        -- update default permissions to any others that are created after `graphql.resolve`
        grant usage on schema graphql to postgres, anon, authenticated, service_role;
        grant select on all tables in schema graphql to postgres, anon, authenticated, service_role;
        grant execute on all functions in schema graphql to postgres, anon, authenticated, service_role;
        grant all on all sequences in schema graphql to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on tables to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on functions to postgres, anon, authenticated, service_role;
        alter default privileges in schema graphql grant all on sequences to postgres, anon, authenticated, service_role;

        -- Allow postgres role to allow granting usage on graphql and graphql_public schemas to custom roles
        grant usage on schema graphql_public to postgres with grant option;
        grant usage on schema graphql to postgres with grant option;
    END IF;

END;
$function$
                                                                                                                                                                                                                                                                                                                                                                  |
| extensions          | grant_pg_net_access                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.grant_pg_net_access()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF EXISTS (
    SELECT 1
    FROM pg_event_trigger_ddl_commands() AS ev
    JOIN pg_extension AS ext
    ON ev.objid = ext.oid
    WHERE ext.extname = 'pg_net'
  )
  THEN
    IF NOT EXISTS (
      SELECT 1
      FROM pg_roles
      WHERE rolname = 'supabase_functions_admin'
    )
    THEN
      CREATE USER supabase_functions_admin NOINHERIT CREATEROLE LOGIN NOREPLICATION;
    END IF;

    GRANT USAGE ON SCHEMA net TO supabase_functions_admin, postgres, anon, authenticated, service_role;

    IF EXISTS (
      SELECT FROM pg_extension
      WHERE extname = 'pg_net'
      -- all versions in use on existing projects as of 2025-02-20
      -- version 0.12.0 onwards don't need these applied
      AND extversion IN ('0.2', '0.6', '0.7', '0.7.1', '0.8', '0.10.0', '0.11.0')
    ) THEN
      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SECURITY DEFINER;

      ALTER function net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;
      ALTER function net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) SET search_path = net;

      REVOKE ALL ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;
      REVOKE ALL ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) FROM PUBLIC;

      GRANT EXECUTE ON FUNCTION net.http_get(url text, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
      GRANT EXECUTE ON FUNCTION net.http_post(url text, body jsonb, params jsonb, headers jsonb, timeout_milliseconds integer) TO supabase_functions_admin, postgres, anon, authenticated, service_role;
    END IF;
  END IF;
END;
$function$
                                                                                                                                                                                                          |
| extensions          | hmac                                  | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | CREATE OR REPLACE FUNCTION extensions.hmac(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_hmac$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions          | hmac                                  | text, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | CREATE OR REPLACE FUNCTION extensions.hmac(text, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pg_hmac$function$
 |
| extensions          | pg_stat_statements                    | showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements(showtext boolean, OUT userid oid, OUT dbid oid, OUT toplevel boolean, OUT queryid bigint, OUT query text, OUT plans bigint, OUT total_plan_time double precision, OUT min_plan_time double precision, OUT max_plan_time double precision, OUT mean_plan_time double precision, OUT stddev_plan_time double precision, OUT calls bigint, OUT total_exec_time double precision, OUT min_exec_time double precision, OUT max_exec_time double precision, OUT mean_exec_time double precision, OUT stddev_exec_time double precision, OUT rows bigint, OUT shared_blks_hit bigint, OUT shared_blks_read bigint, OUT shared_blks_dirtied bigint, OUT shared_blks_written bigint, OUT local_blks_hit bigint, OUT local_blks_read bigint, OUT local_blks_dirtied bigint, OUT local_blks_written bigint, OUT temp_blks_read bigint, OUT temp_blks_written bigint, OUT shared_blk_read_time double precision, OUT shared_blk_write_time double precision, OUT local_blk_read_time double precision, OUT local_blk_write_time double precision, OUT temp_blk_read_time double precision, OUT temp_blk_write_time double precision, OUT wal_records bigint, OUT wal_fpi bigint, OUT wal_bytes numeric, OUT jit_functions bigint, OUT jit_generation_time double precision, OUT jit_inlining_count bigint, OUT jit_inlining_time double precision, OUT jit_optimization_count bigint, OUT jit_optimization_time double precision, OUT jit_emission_count bigint, OUT jit_emission_time double precision, OUT jit_deform_count bigint, OUT jit_deform_time double precision, OUT stats_since timestamp with time zone, OUT minmax_stats_since timestamp with time zone)
 RETURNS SETOF record
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_1_11$function$
|
| extensions          | pg_stat_statements_info               | OUT dealloc bigint, OUT stats_reset timestamp with time zone                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements_info(OUT dealloc bigint, OUT stats_reset timestamp with time zone)
 RETURNS record
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_info$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions          | pg_stat_statements_reset              | userid oid, dbid oid, queryid bigint, minmax_only boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION extensions.pg_stat_statements_reset(userid oid DEFAULT 0, dbid oid DEFAULT 0, queryid bigint DEFAULT 0, minmax_only boolean DEFAULT false)
 RETURNS timestamp with time zone
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pg_stat_statements', $function$pg_stat_statements_reset_1_11$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions          | pgp_armor_headers                     | text, OUT key text, OUT value text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | CREATE OR REPLACE FUNCTION extensions.pgp_armor_headers(text, OUT key text, OUT value text)
 RETURNS SETOF record
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_armor_headers$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions          | pgp_key_id                            | bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | CREATE OR REPLACE FUNCTION extensions.pgp_key_id(bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_key_id_w$function$
  |
| extensions          | pgp_pub_decrypt                       | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions          | pgp_pub_decrypt                       | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| extensions          | pgp_pub_decrypt                       | bytea, bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt(bytea, bytea, text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| extensions          | pgp_pub_decrypt_bytea                 | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| extensions          | pgp_pub_decrypt_bytea                 | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions          | pgp_pub_decrypt_bytea                 | bytea, bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | CREATE OR REPLACE FUNCTION extensions.pgp_pub_decrypt_bytea(bytea, bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| extensions          | pgp_pub_encrypt                       | text, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt(text, bytea)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| extensions          | pgp_pub_encrypt                       | text, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt(text, bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| extensions          | pgp_pub_encrypt_bytea                 | bytea, bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| extensions          | pgp_pub_encrypt_bytea                 | bytea, bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | CREATE OR REPLACE FUNCTION extensions.pgp_pub_encrypt_bytea(bytea, bytea)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_pub_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| extensions          | pgp_sym_decrypt                       | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt(bytea, text, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| extensions          | pgp_sym_decrypt                       | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt(bytea, text)
 RETURNS text
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| extensions          | pgp_sym_decrypt_bytea                 | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions          | pgp_sym_decrypt_bytea                 | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION extensions.pgp_sym_decrypt_bytea(bytea, text)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_decrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| extensions          | pgp_sym_encrypt                       | text, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt(text, text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| extensions          | pgp_sym_encrypt                       | text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt(text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_text$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| extensions          | pgp_sym_encrypt_bytea                 | bytea, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| extensions          | pgp_sym_encrypt_bytea                 | bytea, text, text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | CREATE OR REPLACE FUNCTION extensions.pgp_sym_encrypt_bytea(bytea, text, text)
 RETURNS bytea
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/pgcrypto', $function$pgp_sym_encrypt_bytea$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| extensions          | pgrst_ddl_watch                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.pgrst_ddl_watch()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
  cmd record;
BEGIN
  FOR cmd IN SELECT * FROM pg_event_trigger_ddl_commands()
  LOOP
    IF cmd.command_tag IN (
      'CREATE SCHEMA', 'ALTER SCHEMA'
    , 'CREATE TABLE', 'CREATE TABLE AS', 'SELECT INTO', 'ALTER TABLE'
    , 'CREATE FOREIGN TABLE', 'ALTER FOREIGN TABLE'
    , 'CREATE VIEW', 'ALTER VIEW'
    , 'CREATE MATERIALIZED VIEW', 'ALTER MATERIALIZED VIEW'
    , 'CREATE FUNCTION', 'ALTER FUNCTION'
    , 'CREATE TRIGGER'
    , 'CREATE TYPE', 'ALTER TYPE'
    , 'CREATE RULE'
    , 'COMMENT'
    )
    -- don't notify in case of CREATE TEMP table or other objects created on pg_temp
    AND cmd.schema_name is distinct from 'pg_temp'
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| extensions          | pgrst_drop_watch                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.pgrst_drop_watch()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
  obj record;
BEGIN
  FOR obj IN SELECT * FROM pg_event_trigger_dropped_objects()
  LOOP
    IF obj.object_type IN (
      'schema'
    , 'table'
    , 'foreign table'
    , 'view'
    , 'materialized view'
    , 'function'
    , 'trigger'
    , 'type'
    , 'rule'
    )
    AND obj.is_temporary IS false -- no pg_temp objects
    THEN
      NOTIFY pgrst, 'reload schema';
    END IF;
  END LOOP;
END; $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| extensions          | set_graphql_placeholder               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.set_graphql_placeholder()
 RETURNS event_trigger
 LANGUAGE plpgsql
AS $function$
    DECLARE
    graphql_is_dropped bool;
    BEGIN
    graphql_is_dropped = (
        SELECT ev.schema_name = 'graphql_public'
        FROM pg_event_trigger_dropped_objects() AS ev
        WHERE ev.schema_name = 'graphql_public'
    );

    IF graphql_is_dropped
    THEN
        create or replace function graphql_public.graphql(
            "operationName" text default null,
            query text default null,
            variables jsonb default null,
            extensions jsonb default null
        )
            returns jsonb
            language plpgsql
        as $$
            DECLARE
                server_version float;
            BEGIN
                server_version = (SELECT (SPLIT_PART((select version()), ' ', 2))::float);

                IF server_version >= 14 THEN
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql extension is not enabled.'
                            )
                        )
                    );
                ELSE
                    RETURN jsonb_build_object(
                        'errors', jsonb_build_array(
                            jsonb_build_object(
                                'message', 'pg_graphql is only available on projects running Postgres 14 onwards.'
                            )
                        )
                    );
                END IF;
            END;
        $$;
    END IF;

    END;
$function$
                                                                                                                     |
| extensions          | uuid_generate_v1                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v1()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v1$function$
      |
| extensions          | uuid_generate_v1mc                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v1mc()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v1mc$function$
  |
| extensions          | uuid_generate_v3                      | namespace uuid, name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v3(namespace uuid, name text)
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v3$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| extensions          | uuid_generate_v4                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v4()
 RETURNS uuid
 LANGUAGE c
 PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v4$function$
      |
| extensions          | uuid_generate_v5                      | namespace uuid, name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION extensions.uuid_generate_v5(namespace uuid, name text)
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_generate_v5$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| extensions          | uuid_nil                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.uuid_nil()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_nil$function$
            |
| extensions          | uuid_ns_dns                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_dns()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_dns$function$
      |
| extensions          | uuid_ns_oid                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_oid()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_oid$function$
      |
| extensions          | uuid_ns_url                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_url()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_url$function$
      |
| extensions          | uuid_ns_x500                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION extensions.uuid_ns_x500()
 RETURNS uuid
 LANGUAGE c
 IMMUTABLE PARALLEL SAFE STRICT
AS '$libdir/uuid-ossp', $function$uuid_ns_x500$function$
    |
| graphql             | _internal_resolve                     | query text, variables jsonb, "operationName" text, extensions jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | CREATE OR REPLACE FUNCTION graphql._internal_resolve(query text, variables jsonb DEFAULT '{}'::jsonb, "operationName" text DEFAULT NULL::text, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE c
AS '$libdir/pg_graphql', $function$resolve_wrapper$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| graphql             | comment_directive                     | comment_ text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | CREATE OR REPLACE FUNCTION graphql.comment_directive(comment_ text)
 RETURNS jsonb
 LANGUAGE sql
 IMMUTABLE
AS $function$
    /*
    comment on column public.account.name is '@graphql.name: myField'
    */
    select
        coalesce(
            (
                regexp_match(
                    comment_,
                    '@graphql\((.+)\)'
                )
            )[1]::jsonb,
            jsonb_build_object()
        )
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| graphql             | exception                             | message text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | CREATE OR REPLACE FUNCTION graphql.exception(message text)
 RETURNS text
 LANGUAGE plpgsql
AS $function$
begin
    raise exception using errcode='22000', message=message;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| graphql             | get_schema_version                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION graphql.get_schema_version()
 RETURNS integer
 LANGUAGE sql
 SECURITY DEFINER
AS $function$
    select last_value from graphql.seq_schema_version;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| graphql             | increment_schema_version              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION graphql.increment_schema_version()
 RETURNS event_trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
begin
    perform pg_catalog.nextval('graphql.seq_schema_version');
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| graphql             | resolve                               | query text, variables jsonb, "operationName" text, extensions jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | CREATE OR REPLACE FUNCTION graphql.resolve(query text, variables jsonb DEFAULT '{}'::jsonb, "operationName" text DEFAULT NULL::text, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE plpgsql
AS $function$
declare
    res jsonb;
    message_text text;
begin
  begin
    select graphql._internal_resolve("query" := "query",
                                     "variables" := "variables",
                                     "operationName" := "operationName",
                                     "extensions" := "extensions") into res;
    return res;
  exception
    when others then
    get stacked diagnostics message_text = message_text;
    return
    jsonb_build_object('data', null,
                       'errors', jsonb_build_array(jsonb_build_object('message', message_text)));
  end;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| graphql_public      | graphql                               | "operationName" text, query text, variables jsonb, extensions jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | CREATE OR REPLACE FUNCTION graphql_public.graphql("operationName" text DEFAULT NULL::text, query text DEFAULT NULL::text, variables jsonb DEFAULT NULL::jsonb, extensions jsonb DEFAULT NULL::jsonb)
 RETURNS jsonb
 LANGUAGE sql
AS $function$
            select graphql.resolve(
                query := query,
                variables := coalesce(variables, '{}'),
                "operationName" := "operationName",
                extensions := extensions
            );
        $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| private_health_info | anonymize_daily_log_to_research       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION private_health_info.anonymize_daily_log_to_research()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'research', 'private_health_info', 'linkage', 'public'
AS $function$
DECLARE
    v_research_id UUID;
    v_consent BOOLEAN;
BEGIN
    IF NEW.visible_to_researchers = false THEN
        RETURN NEW;
    END IF;
    
    v_consent := private_health_info.check_research_consent(NEW.patient_id, 'symptom');
    IF v_consent = false THEN
        RETURN NEW;
    END IF;
    
    SELECT research_id INTO v_research_id FROM linkage.research_id_map WHERE user_id = NEW.patient_id;
    
    IF v_research_id IS NULL THEN
        v_research_id := gen_random_uuid();
        INSERT INTO linkage.research_id_map (user_id, research_id) VALUES (NEW.patient_id, v_research_id)
        ON CONFLICT (user_id) DO UPDATE SET research_id = EXCLUDED.research_id RETURNING research_id INTO v_research_id;
    END IF;
    
    INSERT INTO research.daily_symptom_logs (
        research_id, log_date, overall_feeling, mood, energy_level, fatigue_level,
        pain_level, sleep_quality, sleep_hours, sleep_disturbances,
        motor_fluctuations_occurred, on_time_hours, off_time_hours,
        dyskinesia_severity, stiffness_severity, slowness_severity,
        cognitive_issues, mood_issues, autonomic_symptoms, adl_independence_level,
        activities_difficult, all_medications_taken, medication_side_effects,
        stress_level, exercise_minutes, source_log_id
    ) VALUES (
        v_research_id, NEW.log_date, NEW.overall_feeling, NEW.mood, NEW.energy_level,
        NEW.fatigue_level, NEW.pain_level, NEW.sleep_quality, NEW.sleep_hours,
        NEW.sleep_disturbances, NEW.motor_fluctuations_occurred, NEW.on_time_hours,
        NEW.off_time_hours, NEW.dyskinesia_severity, NEW.stiffness_severity,
        NEW.slowness_severity, NEW.cognitive_issues, NEW.mood_issues,
        NEW.autonomic_symptoms, NEW.adl_independence_level, NEW.activities_difficult,
        NEW.all_medications_taken, NEW.medication_side_effects, NEW.stress_level,
        NEW.exercise_minutes, NEW.log_id
    ) ON CONFLICT (research_id, log_date) DO UPDATE SET
        overall_feeling = EXCLUDED.overall_feeling,
        mood = EXCLUDED.mood,
        updated_at = NOW();
    
    RETURN NEW;
END;
$function$
|
| private_health_info | anonymize_gait_to_research            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION private_health_info.anonymize_gait_to_research()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'research', 'private_health_info', 'linkage', 'public'
AS $function$
DECLARE
    v_research_id UUID;
    v_consent BOOLEAN;
BEGIN
    IF NEW.visible_to_researchers = false THEN
        RETURN NEW;
    END IF;
    
    v_consent := private_health_info.check_research_consent(NEW.patient_id, 'gait');
    IF v_consent = false THEN
        RETURN NEW;
    END IF;
    
    SELECT research_id INTO v_research_id FROM linkage.research_id_map WHERE user_id = NEW.patient_id;
    
    IF v_research_id IS NULL THEN
        v_research_id := gen_random_uuid();
        INSERT INTO linkage.research_id_map (user_id, research_id) VALUES (NEW.patient_id, v_research_id)
        ON CONFLICT (user_id) DO UPDATE SET research_id = EXCLUDED.research_id RETURNING research_id INTO v_research_id;
    END IF;
    
    INSERT INTO research.gait_episodes (
        research_id, occurred_at_date, occurred_at_hour, duration_seconds,
        event_type, severity, resulted_in_fall, fall_direction, injury_occurred,
        required_assistance, environmental_factors, medication_status,
        hours_since_medication, freezing_trigger, source_gait_id
    ) VALUES (
        v_research_id, DATE(NEW.occurred_at), EXTRACT(HOUR FROM NEW.occurred_at),
        NEW.duration_seconds, NEW.event_type, NEW.severity, NEW.resulted_in_fall,
        NEW.fall_direction, NEW.injury_occurred, NEW.required_assistance,
        NEW.environmental_factors, NEW.medication_status, NEW.hours_since_medication,
        NEW.freezing_trigger, NEW.gait_id
    ) ON CONFLICT (gait_id) DO NOTHING;
    
    RETURN NEW;
END;
$function$
                                                 |
| private_health_info | anonymize_seizure_to_research         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION private_health_info.anonymize_seizure_to_research()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'research', 'private_health_info', 'linkage', 'public'
AS $function$
DECLARE
    v_research_id UUID;
    v_consent BOOLEAN;
BEGIN
    -- Only process if visible_to_researchers is true
    IF NEW.visible_to_researchers = false THEN
        RETURN NEW;
    END IF;
    
    -- Check consent
    v_consent := private_health_info.check_research_consent(NEW.patient_id, 'seizure');
    
    IF v_consent = false THEN
        RETURN NEW;
    END IF;
    
    -- Get research ID
    SELECT research_id INTO v_research_id
    FROM linkage.research_id_map
    WHERE user_id = NEW.patient_id;
    
    -- If no research ID, create one
    IF v_research_id IS NULL THEN
        v_research_id := gen_random_uuid();
        INSERT INTO linkage.research_id_map (user_id, research_id)
        VALUES (NEW.patient_id, v_research_id)
        ON CONFLICT (user_id) DO UPDATE SET research_id = EXCLUDED.research_id
        RETURNING research_id INTO v_research_id;
    END IF;
    
    -- Insert anonymized data into research schema
    INSERT INTO research.seizure_events (
        research_id,
        occurred_at_date,
        occurred_at_hour,
        duration_seconds,
        seizure_type,
        severity,
        consciousness_level,
        had_aura,
        aura_signs,
        possible_triggers,
        body_parts_affected,
        motor_symptoms,
        non_motor_symptoms,
        post_ictal_effects,
        post_ictal_duration_minutes,
        injuries_occurred,
        injury_types,
        required_medical_attention,
        witnessed,
        medication_taken_as_prescribed,
        hours_since_last_dose,
        recent_medication_changes,
        fully_recovered,
        recovery_time_minutes,
        source_event_id
    ) VALUES (
        v_research_id,
        DATE(NEW.occurred_at),
        EXTRACT(HOUR FROM NEW.occurred_at),
        NEW.duration_seconds,
        NEW.seizure_type,
        NEW.severity,
        NEW.consciousness_level,
        NEW.had_aura,
        NEW.aura_signs,
        NEW.possible_triggers,
        NEW.body_parts_affected,
        NEW.motor_symptoms,
        NEW.non_motor_symptoms,
        NEW.post_ictal_effects,
        NEW.post_ictal_duration_minutes,
        NEW.injuries_occurred,
        NEW.injury_types,
        NEW.required_medical_attention,
        NEW.witnessed,
        NEW.medication_taken_as_prescribed,
        NEW.hours_since_last_dose,
        NEW.recent_medication_changes,
        NEW.fully_recovered,
        NEW.recovery_time_minutes,
        NEW.event_id
    )
    ON CONFLICT (event_id) DO NOTHING; -- Prevent duplicates on update
    
    RETURN NEW;
END;
$function$
|
| private_health_info | anonymize_tremor_to_research          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION private_health_info.anonymize_tremor_to_research()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'research', 'private_health_info', 'linkage', 'public'
AS $function$
DECLARE
    v_research_id UUID;
    v_consent BOOLEAN;
BEGIN
    IF NEW.visible_to_researchers = false THEN
        RETURN NEW;
    END IF;
    
    v_consent := private_health_info.check_research_consent(NEW.patient_id, 'tremor');
    IF v_consent = false THEN
        RETURN NEW;
    END IF;
    
    SELECT research_id INTO v_research_id FROM linkage.research_id_map WHERE user_id = NEW.patient_id;
    
    IF v_research_id IS NULL THEN
        v_research_id := gen_random_uuid();
        INSERT INTO linkage.research_id_map (user_id, research_id) VALUES (NEW.patient_id, v_research_id)
        ON CONFLICT (user_id) DO UPDATE SET research_id = EXCLUDED.research_id RETURNING research_id INTO v_research_id;
    END IF;
    
    INSERT INTO research.tremor_episodes (
        research_id, occurred_at_date, occurred_at_hour, duration_seconds,
        tremor_type, severity, frequency_hz, body_regions, dominant_side,
        interfered_with_activities, activities_affected, occurred_during,
        medication_status, hours_since_medication, possible_triggers, source_tremor_id
    ) VALUES (
        v_research_id, DATE(NEW.occurred_at), EXTRACT(HOUR FROM NEW.occurred_at),
        NEW.duration_seconds, NEW.tremor_type, NEW.severity, NEW.frequency_hz,
        NEW.body_regions, NEW.dominant_side, NEW.interfered_with_activities,
        NEW.activities_affected, NEW.occurred_during, NEW.medication_status,
        NEW.hours_since_medication, NEW.possible_triggers, NEW.tremor_id
    ) ON CONFLICT (tremor_id) DO NOTHING;
    
    RETURN NEW;
END;
$function$
 |
| private_health_info | check_research_consent                | p_patient_id uuid, p_data_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | CREATE OR REPLACE FUNCTION private_health_info.check_research_consent(p_patient_id uuid, p_data_type text)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public', 'private_health_info', 'linkage'
AS $function$
DECLARE
    v_consent BOOLEAN := false;
    v_default_share BOOLEAN := false;
BEGIN
    -- Check data_sharing_preferences
    SELECT 
        default_share_with_researchers,
        CASE p_data_type
            WHEN 'seizure' THEN research_seizure_data
            WHEN 'tremor' THEN research_tremor_data
            WHEN 'gait' THEN research_gait_data
            WHEN 'symptom' THEN research_symptom_data
            ELSE false
        END
    INTO v_default_share, v_consent
    FROM public.data_sharing_preferences
    WHERE patient_id = p_patient_id;
    
    -- If no preferences exist, default to NO consent
    IF NOT FOUND THEN
        RETURN false;
    END IF;
    
    -- Both default AND specific consent must be true
    RETURN (v_default_share AND v_consent);
END;
$function$
|
| private_health_info | update_onboarding_timestamp           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION private_health_info.update_onboarding_timestamp()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'private_health_info', 'public'
AS $function$
BEGIN
  NEW.last_updated_at = NOW();
  RETURN NEW;
END;
$function$
|
| public              | can_carer_see_patient_data            | p_carer_id uuid, p_patient_id uuid, p_data_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | CREATE OR REPLACE FUNCTION public.can_carer_see_patient_data(p_carer_id uuid, p_patient_id uuid, p_data_type text)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
DECLARE
    v_default_share BOOLEAN;
    v_visibility TEXT;
    v_can_view_health_data BOOLEAN;
BEGIN
    -- Check if carer relationship exists and allows health data
    SELECT can_view_health_data
    INTO v_can_view_health_data
    FROM public.carer_relationships
    WHERE carer_user_id = p_carer_id
      AND patient_user_id = p_patient_id
      AND status = 'active';
    
    IF NOT FOUND OR NOT v_can_view_health_data THEN
        RETURN false;
    END IF;
    
    -- Check sharing preferences
    SELECT 
        default_share_with_carers,
        CASE p_data_type
            WHEN 'seizure_events' THEN seizure_events_visibility
            WHEN 'tremor_episodes' THEN tremor_episodes_visibility
            WHEN 'gait_episodes' THEN gait_episodes_visibility
            WHEN 'daily_logs' THEN daily_logs_visibility
            WHEN 'medications' THEN medications_visibility
            WHEN 'media' THEN media_visibility
            ELSE 'clinician_only'
        END
    INTO v_default_share, v_visibility
    FROM public.data_sharing_preferences
    WHERE patient_id = p_patient_id;
    
    -- If no preferences set, default to allow for carers
    IF NOT FOUND THEN
        RETURN true;
    END IF;
    
    -- Check if visibility allows carer access
    RETURN v_default_share AND v_visibility IN ('clinician_carer', 'all');
END;
$function$
|
| public              | can_clinician_see_patient_data        | p_clinician_id uuid, p_patient_id uuid, p_data_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | CREATE OR REPLACE FUNCTION public.can_clinician_see_patient_data(p_clinician_id uuid, p_patient_id uuid, p_data_type text)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
DECLARE
    v_default_share BOOLEAN;
    v_visibility TEXT;
BEGIN
    -- Must have active connection
    IF NOT public.is_clinician_connected_to_patient(p_clinician_id, p_patient_id) THEN
        RETURN false;
    END IF;
    
    -- Check sharing preferences
    SELECT 
        default_share_with_clinicians,
        CASE p_data_type
            WHEN 'seizure_events' THEN seizure_events_visibility
            WHEN 'tremor_episodes' THEN tremor_episodes_visibility
            WHEN 'gait_episodes' THEN gait_episodes_visibility
            WHEN 'daily_logs' THEN daily_logs_visibility
            WHEN 'medications' THEN medications_visibility
            WHEN 'media' THEN media_visibility
            ELSE 'clinician_only'
        END
    INTO v_default_share, v_visibility
    FROM public.data_sharing_preferences
    WHERE patient_id = p_patient_id;
    
    -- If no preferences set, default to allow
    IF NOT FOUND THEN
        RETURN true;
    END IF;
    
    -- Check if visibility allows clinician access
    RETURN v_default_share AND v_visibility IN ('clinician_only', 'clinician_carer', 'all');
END;
$function$
|
| public              | complete_onboarding                   | p_user_id uuid, p_user_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | CREATE OR REPLACE FUNCTION public.complete_onboarding(p_user_id uuid, p_user_type text)
 RETURNS json
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
DECLARE
    v_user_type user_type_enum;
BEGIN
    v_user_type := p_user_type::user_type_enum;

    -- Update profile
    UPDATE public.profiles
    SET onboarding_completed = true,
        updated_at = NOW()
    WHERE id = p_user_id;

    -- Update onboarding progress
    UPDATE public.onboarding_progress
    SET completed = true,
        completed_at = NOW()
    WHERE user_id = p_user_id;

    -- Award "Welcome Aboard" achievement
    INSERT INTO public.user_achievements (user_id, achievement_id)
    SELECT p_user_id, id
    FROM public.achievements
    WHERE name = 'Welcome Aboard'
    ON CONFLICT DO NOTHING;

    -- Award points for completion
    UPDATE public.user_points
    SET total_points = total_points + 50
    WHERE user_id = p_user_id;

    RETURN json_build_object(
        'success', true,
        'message', 'Onboarding completed successfully'
    );

EXCEPTION WHEN OTHERS THEN
    RETURN json_build_object(
        'success', false,
        'message', 'Error completing onboarding: ' || SQLERRM
    );
END;
$function$
|
| public              | get_research_id                       | p_user_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | CREATE OR REPLACE FUNCTION public.get_research_id(p_user_id uuid)
 RETURNS uuid
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'linkage', 'public'
AS $function$
DECLARE
    v_research_id UUID;
BEGIN
    -- Get research ID from secure linkage table
    SELECT research_id INTO v_research_id
    FROM linkage.research_id_map
    WHERE user_id = p_user_id;
    
    -- If not exists, create one
    IF v_research_id IS NULL THEN
        INSERT INTO linkage.research_id_map (user_id, research_id)
        VALUES (p_user_id, gen_random_uuid())
        RETURNING research_id INTO v_research_id;
    END IF;
    
    -- Update access tracking
    UPDATE linkage.research_id_map
    SET 
        last_accessed = NOW(),
        access_count = access_count + 1
    WHERE user_id = p_user_id;
    
    RETURN v_research_id;
END;
$function$
|
| public              | get_user_type                         | p_user_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | CREATE OR REPLACE FUNCTION public.get_user_type(p_user_id uuid)
 RETURNS text
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
DECLARE
    v_user_type TEXT;
BEGIN
    SELECT user_type INTO v_user_type
    FROM public.profiles
    WHERE id = p_user_id;
    
    RETURN v_user_type;
END;
$function$
|
| public              | handle_new_user                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION public.handle_new_user()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
BEGIN
    -- Insert new profile for the user
    INSERT INTO public.profiles (id, email, user_type, onboarding_completed, created_at, updated_at)
    VALUES (
        NEW.id,
        NEW.email,
        NULL, -- Will be set during onboarding
        FALSE,
        NOW(),
        NOW()
    )
    ON CONFLICT (id) DO NOTHING;
    
    RETURN NEW;
END;
$function$
|
| public              | initialize_new_user                   | p_user_id uuid, p_email text, p_user_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | CREATE OR REPLACE FUNCTION public.initialize_new_user(p_user_id uuid, p_email text, p_user_type text DEFAULT 'patient'::text)
 RETURNS json
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
DECLARE
    v_user_type user_type_enum;
    v_result JSON;
BEGIN
    -- Validate user_type
    v_user_type := p_user_type::user_type_enum;

    -- Check if profile already exists
    IF EXISTS (SELECT 1 FROM public.profiles WHERE id = p_user_id) THEN
        RETURN json_build_object(
            'success', false,
            'message', 'User already initialized',
            'user_id', p_user_id
        );
    END IF;

    -- Create profile entry
    INSERT INTO public.profiles (
        id,
        email,
        user_type,
        onboarding_completed
    ) VALUES (
        p_user_id,
        p_email,
        v_user_type,
        false
    );

    -- Create onboarding progress entry
    INSERT INTO public.onboarding_progress (
        user_id,
        current_step,
        total_steps,
        completed
    ) VALUES (
        p_user_id,
        1,
        CASE v_user_type
            WHEN 'patient' THEN 6
            WHEN 'clinician' THEN 5
            WHEN 'carer' THEN 4
            WHEN 'researcher' THEN 5
            ELSE 4
        END,
        false
    );

    -- Initialize user points (for gamification)
    INSERT INTO public.user_points (
        user_id,
        total_points,
        current_level,
        current_streak,
        longest_streak
    ) VALUES (
        p_user_id,
        0,
        1,
        0,
        0
    );

    -- If patient, create data sharing preferences with secure defaults
    IF v_user_type = 'patient' THEN
        INSERT INTO public.data_sharing_preferences (
            patient_id,
            default_share_with_clinicians,
            default_share_with_carers,
            default_share_with_researchers,
            seizure_events_visibility,
            tremor_episodes_visibility,
            gait_episodes_visibility,
            daily_logs_visibility,
            medications_visibility,
            media_visibility
        ) VALUES (
            p_user_id,
            true,   -- Share with clinicians by default
            true,   -- Share with carers by default
            false,  -- Do NOT share with researchers by default
            'clinician_only',
            'clinician_only',
            'clinician_only',
            'clinician_only',
            'clinician_only',
            'private'  -- Media is private by default
        );

        -- Create research consent entry (opted out by default)
        INSERT INTO public.research_consent (
            user_id,
            general_research_consent,
            research_seizure_data,
            research_tremor_data,
            research_gait_data,
            research_daily_logs,
            research_medication_data
        ) VALUES (
            p_user_id,
            false,  -- Opt-in required
            false,
            false,
            false,
            false,
            false
        );
    END IF;

    -- Return success
    RETURN json_build_object(
        'success', true,
        'message', 'User initialized successfully',
        'user_id', p_user_id,
        'user_type', v_user_type
    );

EXCEPTION WHEN OTHERS THEN
    -- Return error
    RETURN json_build_object(
        'success', false,
        'message', 'Error initializing user: ' || SQLERRM,
        'user_id', p_user_id
    );
END;
$function$
|
| public              | initialize_new_user_jsonb             | p_user_id uuid, p_email text, p_user_type text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | CREATE OR REPLACE FUNCTION public.initialize_new_user_jsonb(p_user_id uuid, p_email text, p_user_type text)
 RETURNS jsonb
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'pg_catalog', 'public', 'private_health_info'
AS $function$
BEGIN
  -- Optional: call legacy function if it exists and is needed
  -- PERFORM public.initialize_new_user(p_user_id, p_email, p_user_type);

  -- Create/ensure profile
  INSERT INTO public.profiles (
    id,
    user_type,
    onboarding_completed,
    created_at,
    updated_at
  ) VALUES (
    p_user_id,
    p_user_type::user_type_enum,
    false,
    NOW(),
    NOW()
  )
  ON CONFLICT (id) DO UPDATE
    SET user_type = EXCLUDED.user_type,
        updated_at = NOW();

  -- Patient-specific
  IF p_user_type = 'patient' THEN
    INSERT INTO public.patient_profiles (user_id, created_at, updated_at)
    VALUES (p_user_id, NOW(), NOW())
    ON CONFLICT (user_id) DO NOTHING;

    INSERT INTO private_health_info.patient_phi (user_id, created_at, updated_at)
    VALUES (p_user_id, NOW(), NOW())
    ON CONFLICT (user_id) DO NOTHING;
  END IF;

  -- Carer-specific
  IF p_user_type = 'carer' THEN
    INSERT INTO public.carer_profiles (user_id, created_at, updated_at)
    VALUES (p_user_id, NOW(), NOW())
    ON CONFLICT (user_id) DO NOTHING;
  END IF;

  RETURN jsonb_build_object('success', true, 'message', 'User initialized successfully');

EXCEPTION
  WHEN OTHERS THEN
    RETURN jsonb_build_object('success', false, 'message', 'Initialization failed: ' || SQLERRM);
END;
$function$
|
| public              | is_admin                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION public.is_admin()
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
BEGIN
    RETURN EXISTS (
        SELECT 1
        FROM public.profiles
        WHERE id = auth.uid()
          AND user_type = 'admin'
    );
END;
$function$
|| public              | is_approved_researcher                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION public.is_approved_researcher()
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
BEGIN
    RETURN EXISTS (
        SELECT 1
        FROM public.researcher_profiles
        WHERE user_id = auth.uid()
          AND access_level IN ('advanced', 'admin')
    );
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| public              | is_carer_related_to_patient           | p_carer_id uuid, p_patient_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | CREATE OR REPLACE FUNCTION public.is_carer_related_to_patient(p_carer_id uuid, p_patient_id uuid)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
BEGIN
    RETURN EXISTS (
        SELECT 1
        FROM public.carer_relationships
        WHERE carer_user_id = p_carer_id
          AND patient_user_id = p_patient_id
          AND status = 'active'
    );
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| public              | is_clinician_connected_to_patient     | p_clinician_id uuid, p_patient_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | CREATE OR REPLACE FUNCTION public.is_clinician_connected_to_patient(p_clinician_id uuid, p_patient_id uuid)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
BEGIN
    RETURN EXISTS (
        SELECT 1
        FROM public.patient_clinician_connections
        WHERE clinician_id = p_clinician_id
          AND patient_id = p_patient_id
          AND status = 'active'
    );
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| realtime            | apply_rls                             | wal jsonb, max_record_bytes integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | CREATE OR REPLACE FUNCTION realtime.apply_rls(wal jsonb, max_record_bytes integer DEFAULT (1024 * 1024))
 RETURNS SETOF realtime.wal_rls
 LANGUAGE plpgsql
AS $function$
declare
-- Regclass of the table e.g. public.notes
entity_ regclass = (quote_ident(wal ->> 'schema') || '.' || quote_ident(wal ->> 'table'))::regclass;

-- I, U, D, T: insert, update ...
action realtime.action = (
    case wal ->> 'action'
        when 'I' then 'INSERT'
        when 'U' then 'UPDATE'
        when 'D' then 'DELETE'
        else 'ERROR'
    end
);

-- Is row level security enabled for the table
is_rls_enabled bool = relrowsecurity from pg_class where oid = entity_;

subscriptions realtime.subscription[] = array_agg(subs)
    from
        realtime.subscription subs
    where
        subs.entity = entity_;

-- Subscription vars
roles regrole[] = array_agg(distinct us.claims_role::text)
    from
        unnest(subscriptions) us;

working_role regrole;
claimed_role regrole;
claims jsonb;

subscription_id uuid;
subscription_has_access bool;
visible_to_subscription_ids uuid[] = '{}';

-- structured info for wal's columns
columns realtime.wal_column[];
-- previous identity values for update/delete
old_columns realtime.wal_column[];

error_record_exceeds_max_size boolean = octet_length(wal::text) > max_record_bytes;

-- Primary jsonb output for record
output jsonb;

begin
perform set_config('role', null, true);

columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'columns') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

old_columns =
    array_agg(
        (
            x->>'name',
            x->>'type',
            x->>'typeoid',
            realtime.cast(
                (x->'value') #>> '{}',
                coalesce(
                    (x->>'typeoid')::regtype, -- null when wal2json version <= 2.4
                    (x->>'type')::regtype
                )
            ),
            (pks ->> 'name') is not null,
            true
        )::realtime.wal_column
    )
    from
        jsonb_array_elements(wal -> 'identity') x
        left join jsonb_array_elements(wal -> 'pk') pks
            on (x ->> 'name') = (pks ->> 'name');

for working_role in select * from unnest(roles) loop

    -- Update `is_selectable` for columns and old_columns
    columns =
        array_agg(
            (
                c.name,
                c.type_name,
                c.type_oid,
                c.value,
                c.is_pkey,
                pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
            )::realtime.wal_column
        )
        from
            unnest(columns) c;

    old_columns =
            array_agg(
                (
                    c.name,
                    c.type_name,
                    c.type_oid,
                    c.value,
                    c.is_pkey,
                    pg_catalog.has_column_privilege(working_role, entity_, c.name, 'SELECT')
                )::realtime.wal_column
            )
            from
                unnest(old_columns) c;

    if action <> 'DELETE' and count(1) = 0 from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            -- subscriptions is already filtered by entity
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 400: Bad Request, no primary key']
        )::realtime.wal_rls;

    -- The claims role does not have SELECT permission to the primary key of entity
    elsif action <> 'DELETE' and sum(c.is_selectable::int) <> count(1) from unnest(columns) c where c.is_pkey then
        return next (
            jsonb_build_object(
                'schema', wal ->> 'schema',
                'table', wal ->> 'table',
                'type', action
            ),
            is_rls_enabled,
            (select array_agg(s.subscription_id) from unnest(subscriptions) as s where claims_role = working_role),
            array['Error 401: Unauthorized']
        )::realtime.wal_rls;

    else
        output = jsonb_build_object(
            'schema', wal ->> 'schema',
            'table', wal ->> 'table',
            'type', action,
            'commit_timestamp', to_char(
                ((wal ->> 'timestamp')::timestamptz at time zone 'utc'),
                'YYYY-MM-DD"T"HH24:MI:SS.MS"Z"'
            ),
            'columns', (
                select
                    jsonb_agg(
                        jsonb_build_object(
                            'name', pa.attname,
                            'type', pt.typname
                        )
                        order by pa.attnum asc
                    )
                from
                    pg_attribute pa
                    join pg_type pt
                        on pa.atttypid = pt.oid
                where
                    attrelid = entity_
                    and attnum > 0
                    and pg_catalog.has_column_privilege(working_role, entity_, pa.attname, 'SELECT')
            )
        )
        -- Add "record" key for insert and update
        || case
            when action in ('INSERT', 'UPDATE') then
                jsonb_build_object(
                    'record',
                    (
                        select
                            jsonb_object_agg(
                                -- if unchanged toast, get column name and value from old record
                                coalesce((c).name, (oc).name),
                                case
                                    when (c).name is null then (oc).value
                                    else (c).value
                                end
                            )
                        from
                            unnest(columns) c
                            full outer join unnest(old_columns) oc
                                on (c).name = (oc).name
                        where
                            coalesce((c).is_selectable, (oc).is_selectable)
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                    )
                )
            else '{}'::jsonb
        end
        -- Add "old_record" key for update and delete
        || case
            when action = 'UPDATE' then
                jsonb_build_object(
                        'old_record',
                        (
                            select jsonb_object_agg((c).name, (c).value)
                            from unnest(old_columns) c
                            where
                                (c).is_selectable
                                and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                        )
                    )
            when action = 'DELETE' then
                jsonb_build_object(
                    'old_record',
                    (
                        select jsonb_object_agg((c).name, (c).value)
                        from unnest(old_columns) c
                        where
                            (c).is_selectable
                            and ( not error_record_exceeds_max_size or (octet_length((c).value::text) <= 64))
                            and ( not is_rls_enabled or (c).is_pkey ) -- if RLS enabled, we can't secure deletes so filter to pkey
                    )
                )
            else '{}'::jsonb
        end;

        -- Create the prepared statement
        if is_rls_enabled and action <> 'DELETE' then
            if (select 1 from pg_prepared_statements where name = 'walrus_rls_stmt' limit 1) > 0 then
                deallocate walrus_rls_stmt;
            end if;
            execute realtime.build_prepared_statement_sql('walrus_rls_stmt', entity_, columns);
        end if;

        visible_to_subscription_ids = '{}';

        for subscription_id, claims in (
                select
                    subs.subscription_id,
                    subs.claims
                from
                    unnest(subscriptions) subs
                where
                    subs.entity = entity_
                    and subs.claims_role = working_role
                    and (
                        realtime.is_visible_through_filters(columns, subs.filters)
                        or (
                          action = 'DELETE'
                          and realtime.is_visible_through_filters(old_columns, subs.filters)
                        )
                    )
        ) loop

            if not is_rls_enabled or action = 'DELETE' then
                visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
            else
                -- Check if RLS allows the role to see the record
                perform
                    -- Trim leading and trailing quotes from working_role because set_config
                    -- doesn't recognize the role as valid if they are included
                    set_config('role', trim(both '"' from working_role::text), true),
                    set_config('request.jwt.claims', claims::text, true);

                execute 'execute walrus_rls_stmt' into subscription_has_access;

                if subscription_has_access then
                    visible_to_subscription_ids = visible_to_subscription_ids || subscription_id;
                end if;
            end if;
        end loop;

        perform set_config('role', null, true);

        return next (
            output,
            is_rls_enabled,
            visible_to_subscription_ids,
            case
                when error_record_exceeds_max_size then array['Error 413: Payload Too Large']
                else '{}'
            end
        )::realtime.wal_rls;

    end if;
end loop;

perform set_config('role', null, true);
end;
$function$
 |
| realtime            | broadcast_changes                     | topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | CREATE OR REPLACE FUNCTION realtime.broadcast_changes(topic_name text, event_name text, operation text, table_name text, table_schema text, new record, old record, level text DEFAULT 'ROW'::text)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
DECLARE
    -- Declare a variable to hold the JSONB representation of the row
    row_data jsonb := '{}'::jsonb;
BEGIN
    IF level = 'STATEMENT' THEN
        RAISE EXCEPTION 'function can only be triggered for each row, not for each statement';
    END IF;
    -- Check the operation type and handle accordingly
    IF operation = 'INSERT' OR operation = 'UPDATE' OR operation = 'DELETE' THEN
        row_data := jsonb_build_object('old_record', OLD, 'record', NEW, 'operation', operation, 'table', table_name, 'schema', table_schema);
        PERFORM realtime.send (row_data, event_name, topic_name);
    ELSE
        RAISE EXCEPTION 'Unexpected operation type: %', operation;
    END IF;
EXCEPTION
    WHEN OTHERS THEN
        RAISE EXCEPTION 'Failed to process the row: %', SQLERRM;
END;

$function$




|
| realtime            | build_prepared_statement_sql          | prepared_statement_name text, entity regclass, columns realtime.wal_column[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | CREATE OR REPLACE FUNCTION realtime.build_prepared_statement_sql(prepared_statement_name text, entity regclass, columns realtime.wal_column[])
 RETURNS text
 LANGUAGE sql
AS $function$
      /*
      Builds a sql string that, if executed, creates a prepared statement to
      tests retrive a row from *entity* by its primary key columns.
      Example
          select realtime.build_prepared_statement_sql('public.notes', '{"id"}'::text[], '{"bigint"}'::text[])
      */
          select
      'prepare ' || prepared_statement_name || ' as
          select
              exists(
                  select
                      1
                  from
                      ' || entity || '
                  where
                      ' || string_agg(quote_ident(pkc.name) || '=' || quote_nullable(pkc.value #>> '{}') , ' and ') || '
              )'
          from
              unnest(columns) pkc
          where
              pkc.is_pkey
          group by
              entity
      $function$
|
| realtime            | cast                                  | val text, type_ regtype                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | CREATE OR REPLACE FUNCTION realtime."cast"(val text, type_ regtype)
 RETURNS jsonb
 LANGUAGE plpgsql
 IMMUTABLE
AS $function$
    declare
      res jsonb;
    begin
      execute format('select to_jsonb(%L::'|| type_::text || ')', val)  into res;
      return res;
    end
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| realtime            | check_equality_op                     | op realtime.equality_op, type_ regtype, val_1 text, val_2 text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | CREATE OR REPLACE FUNCTION realtime.check_equality_op(op realtime.equality_op, type_ regtype, val_1 text, val_2 text)
 RETURNS boolean
 LANGUAGE plpgsql
 IMMUTABLE
AS $function$
      /*
      Casts *val_1* and *val_2* as type *type_* and check the *op* condition for truthiness
      */
      declare
          op_symbol text = (
              case
                  when op = 'eq' then '='
                  when op = 'neq' then '!='
                  when op = 'lt' then '<'
                  when op = 'lte' then '<='
                  when op = 'gt' then '>'
                  when op = 'gte' then '>='
                  when op = 'in' then '= any'
                  else 'UNKNOWN OP'
              end
          );
          res boolean;
      begin
          execute format(
              'select %L::'|| type_::text || ' ' || op_symbol
              || ' ( %L::'
              || (
                  case
                      when op = 'in' then type_::text || '[]'
                      else type_::text end
              )
              || ')', val_1, val_2) into res;
          return res;
      end;
      $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| realtime            | is_visible_through_filters            | columns realtime.wal_column[], filters realtime.user_defined_filter[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | CREATE OR REPLACE FUNCTION realtime.is_visible_through_filters(columns realtime.wal_column[], filters realtime.user_defined_filter[])
 RETURNS boolean
 LANGUAGE sql
 IMMUTABLE
AS $function$
    /*
    Should the record be visible (true) or filtered out (false) after *filters* are applied
    */
        select
            -- Default to allowed when no filters present
            $2 is null -- no filters. this should not happen because subscriptions has a default
            or array_length($2, 1) is null -- array length of an empty array is null
            or bool_and(
                coalesce(
                    realtime.check_equality_op(
                        op:=f.op,
                        type_:=coalesce(
                            col.type_oid::regtype, -- null when wal2json version <= 2.4
                            col.type_name::regtype
                        ),
                        -- cast jsonb to text
                        val_1:=col.value #>> '{}',
                        val_2:=f.value
                    ),
                    false -- if null, filter does not match
                )
            )
        from
            unnest(filters) f
            join unnest(columns) col
                on f.column_name = col.name;
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| realtime            | list_changes                          | publication name, slot_name name, max_changes integer, max_record_bytes integer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION realtime.list_changes(publication name, slot_name name, max_changes integer, max_record_bytes integer)
 RETURNS SETOF realtime.wal_rls
 LANGUAGE sql
 SET log_min_messages TO 'fatal'
AS $function$
      with pub as (
        select
          concat_ws(
            ',',
            case when bool_or(pubinsert) then 'insert' else null end,
            case when bool_or(pubupdate) then 'update' else null end,
            case when bool_or(pubdelete) then 'delete' else null end
          ) as w2j_actions,
          coalesce(
            string_agg(
              realtime.quote_wal2json(format('%I.%I', schemaname, tablename)::regclass),
              ','
            ) filter (where ppt.tablename is not null and ppt.tablename not like '% %'),
            ''
          ) w2j_add_tables
        from
          pg_publication pp
          left join pg_publication_tables ppt
            on pp.pubname = ppt.pubname
        where
          pp.pubname = publication
        group by
          pp.pubname
        limit 1
      ),
      w2j as (
        select
          x.*, pub.w2j_add_tables
        from
          pub,
          pg_logical_slot_get_changes(
            slot_name, null, max_changes,
            'include-pk', 'true',
            'include-transaction', 'false',
            'include-timestamp', 'true',
            'include-type-oids', 'true',
            'format-version', '2',
            'actions', pub.w2j_actions,
            'add-tables', pub.w2j_add_tables
          ) x
      )
      select
        xyz.wal,
        xyz.is_rls_enabled,
        xyz.subscription_ids,
        xyz.errors
      from
        w2j,
        realtime.apply_rls(
          wal := w2j.data::jsonb,
          max_record_bytes := max_record_bytes
        ) xyz(wal, is_rls_enabled, subscription_ids, errors)
      where
        w2j.w2j_add_tables <> ''
        and xyz.subscription_ids[1] is not null
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                  |
| realtime            | quote_wal2json                        | entity regclass                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION realtime.quote_wal2json(entity regclass)
 RETURNS text
 LANGUAGE sql
 IMMUTABLE STRICT
AS $function$
      select
        (
          select string_agg('' || ch,'')
          from unnest(string_to_array(nsp.nspname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
        )
        || '.'
        || (
          select string_agg('' || ch,'')
          from unnest(string_to_array(pc.relname::text, null)) with ordinality x(ch, idx)
          where
            not (x.idx = 1 and x.ch = '"')
            and not (
              x.idx = array_length(string_to_array(nsp.nspname::text, null), 1)
              and x.ch = '"'
            )
          )
      from
        pg_class pc
        join pg_namespace nsp
          on pc.relnamespace = nsp.oid
      where
        pc.oid = entity
    $function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| realtime            | send                                  | payload jsonb, event text, topic text, private boolean                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | CREATE OR REPLACE FUNCTION realtime.send(payload jsonb, event text, topic text, private boolean DEFAULT true)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  BEGIN
    -- Set the topic configuration
    EXECUTE format('SET LOCAL realtime.topic TO %L', topic);

    -- Attempt to insert the message
    INSERT INTO realtime.messages (payload, event, topic, private, extension)
    VALUES (payload, event, topic, private, 'broadcast');
  EXCEPTION
    WHEN OTHERS THEN
      -- Capture and notify the error
      RAISE WARNING 'ErrorSendingBroadcastMessage: %', SQLERRM;
  END;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| realtime            | subscription_check_filters            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION realtime.subscription_check_filters()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
    /*
    Validates that the user defined filters for a subscription:
    - refer to valid columns that the claimed role may access
    - values are coercable to the correct column type
    */
    declare
        col_names text[] = coalesce(
                array_agg(c.column_name order by c.ordinal_position),
                '{}'::text[]
            )
            from
                information_schema.columns c
            where
                format('%I.%I', c.table_schema, c.table_name)::regclass = new.entity
                and pg_catalog.has_column_privilege(
                    (new.claims ->> 'role'),
                    format('%I.%I', c.table_schema, c.table_name)::regclass,
                    c.column_name,
                    'SELECT'
                );
        filter realtime.user_defined_filter;
        col_type regtype;

        in_val jsonb;
    begin
        for filter in select * from unnest(new.filters) loop
            -- Filtered column is valid
            if not filter.column_name = any(col_names) then
                raise exception 'invalid column for filter %', filter.column_name;
            end if;

            -- Type is sanitized and safe for string interpolation
            col_type = (
                select atttypid::regtype
                from pg_catalog.pg_attribute
                where attrelid = new.entity
                      and attname = filter.column_name
            );
            if col_type is null then
                raise exception 'failed to lookup type for column %', filter.column_name;
            end if;

            -- Set maximum number of entries for in filter
            if filter.op = 'in'::realtime.equality_op then
                in_val = realtime.cast(filter.value, (col_type::text || '[]')::regtype);
                if coalesce(jsonb_array_length(in_val), 0) > 100 then
                    raise exception 'too many values for `in` filter. Maximum 100';
                end if;
            else
                -- raises an exception if value is not coercable to type
                perform realtime.cast(filter.value, col_type);
            end if;

        end loop;

        -- Apply consistent order to filters so the unique constraint on
        -- (subscription_id, entity, filters) can't be tricked by a different filter order
        new.filters = coalesce(
            array_agg(f order by f.column_name, f.op, f.value),
            '{}'
        ) from unnest(new.filters) f;

        return new;
    end;
    $function$
                                                                                                                                             |
| realtime            | to_regrole                            | role_name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | CREATE OR REPLACE FUNCTION realtime.to_regrole(role_name text)
 RETURNS regrole
 LANGUAGE sql
 IMMUTABLE
AS $function$ select role_name::regrole $function$
                |
| realtime            | topic                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION realtime.topic()
 RETURNS text
 LANGUAGE sql
 STABLE
AS $function$
select nullif(current_setting('realtime.topic', true), '')::text;
$function$
 |
| storage             | add_prefixes                          | _bucket_id text, _name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION storage.add_prefixes(_bucket_id text, _name text)
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    prefixes text[];
BEGIN
    prefixes := "storage"."get_prefixes"("_name");

    IF array_length(prefixes, 1) > 0 THEN
        INSERT INTO storage.prefixes (name, bucket_id)
        SELECT UNNEST(prefixes) as name, "_bucket_id" ON CONFLICT DO NOTHING;
    END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage             | can_insert_object                     | bucketid text, name text, owner uuid, metadata jsonb                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | CREATE OR REPLACE FUNCTION storage.can_insert_object(bucketid text, name text, owner uuid, metadata jsonb)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  INSERT INTO "storage"."objects" ("bucket_id", "name", "owner", "metadata") VALUES (bucketid, name, owner, metadata);
  -- hack to rollback the successful insert
  RAISE sqlstate 'PT200' using
  message = 'ROLLBACK',
  detail = 'rollback successful insert';
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| storage             | delete_leaf_prefixes                  | bucket_ids text[], names text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.delete_leaf_prefixes(bucket_ids text[], names text[])
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    v_rows_deleted integer;
BEGIN
    LOOP
        WITH candidates AS (
            SELECT DISTINCT
                t.bucket_id,
                unnest(storage.get_prefixes(t.name)) AS name
            FROM unnest(bucket_ids, names) AS t(bucket_id, name)
        ),
        uniq AS (
             SELECT
                 bucket_id,
                 name,
                 storage.get_level(name) AS level
             FROM candidates
             WHERE name <> ''
             GROUP BY bucket_id, name
        ),
        leaf AS (
             SELECT
                 p.bucket_id,
                 p.name,
                 p.level
             FROM storage.prefixes AS p
                  JOIN uniq AS u
                       ON u.bucket_id = p.bucket_id
                           AND u.name = p.name
                           AND u.level = p.level
             WHERE NOT EXISTS (
                 SELECT 1
                 FROM storage.objects AS o
                 WHERE o.bucket_id = p.bucket_id
                   AND o.level = p.level + 1
                   AND o.name COLLATE "C" LIKE p.name || '/%'
             )
             AND NOT EXISTS (
                 SELECT 1
                 FROM storage.prefixes AS c
                 WHERE c.bucket_id = p.bucket_id
                   AND c.level = p.level + 1
                   AND c.name COLLATE "C" LIKE p.name || '/%'
             )
        )
        DELETE
        FROM storage.prefixes AS p
            USING leaf AS l
        WHERE p.bucket_id = l.bucket_id
          AND p.name = l.name
          AND p.level = l.level;

        GET DIAGNOSTICS v_rows_deleted = ROW_COUNT;
        EXIT WHEN v_rows_deleted = 0;
    END LOOP;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| storage             | delete_prefix                         | _bucket_id text, _name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION storage.delete_prefix(_bucket_id text, _name text)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    -- Check if we can delete the prefix
    IF EXISTS(
        SELECT FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name") + 1
          AND "prefixes"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    )
    OR EXISTS(
        SELECT FROM "storage"."objects"
        WHERE "objects"."bucket_id" = "_bucket_id"
          AND "storage"."get_level"("objects"."name") = "storage"."get_level"("_name") + 1
          AND "objects"."name" COLLATE "C" LIKE "_name" || '/%'
        LIMIT 1
    ) THEN
    -- There are sub-objects, skip deletion
    RETURN false;
    ELSE
        DELETE FROM "storage"."prefixes"
        WHERE "prefixes"."bucket_id" = "_bucket_id"
          AND level = "storage"."get_level"("_name")
          AND "prefixes"."name" = "_name";
        RETURN true;
    END IF;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| storage             | delete_prefix_hierarchy_trigger       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.delete_prefix_hierarchy_trigger()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    prefix text;
BEGIN
    prefix := "storage"."get_prefix"(OLD."name");

    IF coalesce(prefix, '') != '' THEN
        PERFORM "storage"."delete_prefix"(OLD."bucket_id", prefix);
    END IF;

    RETURN OLD;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| storage             | enforce_bucket_name_length            |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.enforce_bucket_name_length()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
begin
    if length(new.name) > 100 then
        raise exception 'bucket name "%" is too long (% characters). Max is 100.', new.name, length(new.name);
    end if;
    return new;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| storage             | extension                             | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION storage.extension(name text)
 RETURNS text
 LANGUAGE plpgsql
 IMMUTABLE
AS $function$
DECLARE
    _parts text[];
    _filename text;
BEGIN
    SELECT string_to_array(name, '/') INTO _parts;
    SELECT _parts[array_length(_parts,1)] INTO _filename;
    RETURN reverse(split_part(reverse(_filename), '.', 1));
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| storage             | filename                              | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION storage.filename(name text)
 RETURNS text
 LANGUAGE plpgsql
AS $function$
DECLARE
_parts text[];
BEGIN
	select string_to_array(name, '/') into _parts;
	return _parts[array_length(_parts,1)];
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| storage             | foldername                            | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION storage.foldername(name text)
 RETURNS text[]
 LANGUAGE plpgsql
 IMMUTABLE
AS $function$
DECLARE
    _parts text[];
BEGIN
    -- Split on "/" to get path segments
    SELECT string_to_array(name, '/') INTO _parts;
    -- Return everything except the last segment
    RETURN _parts[1 : array_length(_parts,1) - 1];
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| storage             | get_level                             | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION storage.get_level(name text)
 RETURNS integer
 LANGUAGE sql
 IMMUTABLE STRICT
AS $function$
SELECT array_length(string_to_array("name", '/'), 1);
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| storage             | get_prefix                            | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION storage.get_prefix(name text)
 RETURNS text
 LANGUAGE sql
 IMMUTABLE STRICT
AS $function$
SELECT
    CASE WHEN strpos("name", '/') > 0 THEN
             regexp_replace("name", '[\/]{1}[^\/]+\/?$', '')
         ELSE
             ''
        END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| storage             | get_prefixes                          | name text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | CREATE OR REPLACE FUNCTION storage.get_prefixes(name text)
 RETURNS text[]
 LANGUAGE plpgsql
 IMMUTABLE STRICT
AS $function$
DECLARE
    parts text[];
    prefixes text[];
    prefix text;
BEGIN
    -- Split the name into parts by '/'
    parts := string_to_array("name", '/');
    prefixes := '{}';

    -- Construct the prefixes, stopping one level below the last part
    FOR i IN 1..array_length(parts, 1) - 1 LOOP
            prefix := array_to_string(parts[1:i], '/');
            prefixes := array_append(prefixes, prefix);
    END LOOP;

    RETURN prefixes;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| storage             | get_size_by_bucket                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.get_size_by_bucket()
 RETURNS TABLE(size bigint, bucket_id text)
 LANGUAGE plpgsql
 STABLE
AS $function$
BEGIN
    return query
        select sum((metadata->>'size')::bigint) as size, obj.bucket_id
        from "storage".objects as obj
        group by obj.bucket_id;
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| storage             | list_multipart_uploads_with_delimiter | bucket_id text, prefix_param text, delimiter_param text, max_keys integer, next_key_token text, next_upload_token text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | CREATE OR REPLACE FUNCTION storage.list_multipart_uploads_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, next_key_token text DEFAULT ''::text, next_upload_token text DEFAULT ''::text)
 RETURNS TABLE(key text, id text, created_at timestamp with time zone)
 LANGUAGE plpgsql
AS $function$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(key COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                        substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1)))
                    ELSE
                        key
                END AS key, id, created_at
            FROM
                storage.s3_multipart_uploads
            WHERE
                bucket_id = $5 AND
                key ILIKE $1 || ''%'' AND
                CASE
                    WHEN $4 != '''' AND $6 = '''' THEN
                        CASE
                            WHEN position($2 IN substring(key from length($1) + 1)) > 0 THEN
                                substring(key from 1 for length($1) + position($2 IN substring(key from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                key COLLATE "C" > $4
                            END
                    ELSE
                        true
                END AND
                CASE
                    WHEN $6 != '''' THEN
                        id COLLATE "C" > $6
                    ELSE
                        true
                    END
            ORDER BY
                key COLLATE "C" ASC, created_at ASC) as e order by key COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_key_token, bucket_id, next_upload_token;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| storage             | list_objects_with_delimiter           | bucket_id text, prefix_param text, delimiter_param text, max_keys integer, start_after text, next_token text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | CREATE OR REPLACE FUNCTION storage.list_objects_with_delimiter(bucket_id text, prefix_param text, delimiter_param text, max_keys integer DEFAULT 100, start_after text DEFAULT ''::text, next_token text DEFAULT ''::text)
 RETURNS TABLE(name text, id uuid, metadata jsonb, updated_at timestamp with time zone)
 LANGUAGE plpgsql
AS $function$
BEGIN
    RETURN QUERY EXECUTE
        'SELECT DISTINCT ON(name COLLATE "C") * from (
            SELECT
                CASE
                    WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                        substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1)))
                    ELSE
                        name
                END AS name, id, metadata, updated_at
            FROM
                storage.objects
            WHERE
                bucket_id = $5 AND
                name ILIKE $1 || ''%'' AND
                CASE
                    WHEN $6 != '''' THEN
                    name COLLATE "C" > $6
                ELSE true END
                AND CASE
                    WHEN $4 != '''' THEN
                        CASE
                            WHEN position($2 IN substring(name from length($1) + 1)) > 0 THEN
                                substring(name from 1 for length($1) + position($2 IN substring(name from length($1) + 1))) COLLATE "C" > $4
                            ELSE
                                name COLLATE "C" > $4
                            END
                    ELSE
                        true
                END
            ORDER BY
                name COLLATE "C" ASC) as e order by name COLLATE "C" LIMIT $3'
        USING prefix_param, delimiter_param, max_keys, next_token, bucket_id, start_after;
END;
$function$
 |
| storage             | lock_top_prefixes                     | bucket_ids text[], names text[]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.lock_top_prefixes(bucket_ids text[], names text[])
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    v_bucket text;
    v_top text;
BEGIN
    FOR v_bucket, v_top IN
        SELECT DISTINCT t.bucket_id,
            split_part(t.name, '/', 1) AS top
        FROM unnest(bucket_ids, names) AS t(bucket_id, name)
        WHERE t.name <> ''
        ORDER BY 1, 2
        LOOP
            PERFORM pg_advisory_xact_lock(hashtextextended(v_bucket || '/' || v_top, 0));
        END LOOP;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| storage             | objects_delete_cleanup                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.objects_delete_cleanup()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    v_bucket_ids text[];
    v_names      text[];
BEGIN
    IF current_setting('storage.gc.prefixes', true) = '1' THEN
        RETURN NULL;
    END IF;

    PERFORM set_config('storage.gc.prefixes', '1', true);

    SELECT COALESCE(array_agg(d.bucket_id), '{}'),
           COALESCE(array_agg(d.name), '{}')
    INTO v_bucket_ids, v_names
    FROM deleted AS d
    WHERE d.name <> '';

    PERFORM storage.lock_top_prefixes(v_bucket_ids, v_names);
    PERFORM storage.delete_leaf_prefixes(v_bucket_ids, v_names);

    RETURN NULL;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| storage             | objects_insert_prefix_trigger         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.objects_insert_prefix_trigger()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    NEW.level := "storage"."get_level"(NEW."name");

    RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage             | objects_update_cleanup                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.objects_update_cleanup()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    -- NEW - OLD (destinations to create prefixes for)
    v_add_bucket_ids text[];
    v_add_names      text[];

    -- OLD - NEW (sources to prune)
    v_src_bucket_ids text[];
    v_src_names      text[];
BEGIN
    IF TG_OP <> 'UPDATE' THEN
        RETURN NULL;
    END IF;

    -- 1) Compute NEWOLD (added paths) and OLDNEW (moved-away paths)
    WITH added AS (
        SELECT n.bucket_id, n.name
        FROM new_rows n
        WHERE n.name <> '' AND position('/' in n.name) > 0
        EXCEPT
        SELECT o.bucket_id, o.name FROM old_rows o WHERE o.name <> ''
    ),
    moved AS (
         SELECT o.bucket_id, o.name
         FROM old_rows o
         WHERE o.name <> ''
         EXCEPT
         SELECT n.bucket_id, n.name FROM new_rows n WHERE n.name <> ''
    )
    SELECT
        -- arrays for ADDED (dest) in stable order
        COALESCE( (SELECT array_agg(a.bucket_id ORDER BY a.bucket_id, a.name) FROM added a), '{}' ),
        COALESCE( (SELECT array_agg(a.name      ORDER BY a.bucket_id, a.name) FROM added a), '{}' ),
        -- arrays for MOVED (src) in stable order
        COALESCE( (SELECT array_agg(m.bucket_id ORDER BY m.bucket_id, m.name) FROM moved m), '{}' ),
        COALESCE( (SELECT array_agg(m.name      ORDER BY m.bucket_id, m.name) FROM moved m), '{}' )
    INTO v_add_bucket_ids, v_add_names, v_src_bucket_ids, v_src_names;

    -- Nothing to do?
    IF (array_length(v_add_bucket_ids, 1) IS NULL) AND (array_length(v_src_bucket_ids, 1) IS NULL) THEN
        RETURN NULL;
    END IF;

    -- 2) Take per-(bucket, top) locks: ALL prefixes in consistent global order to prevent deadlocks
    DECLARE
        v_all_bucket_ids text[];
        v_all_names text[];
    BEGIN
        -- Combine source and destination arrays for consistent lock ordering
        v_all_bucket_ids := COALESCE(v_src_bucket_ids, '{}') || COALESCE(v_add_bucket_ids, '{}');
        v_all_names := COALESCE(v_src_names, '{}') || COALESCE(v_add_names, '{}');

        -- Single lock call ensures consistent global ordering across all transactions
        IF array_length(v_all_bucket_ids, 1) IS NOT NULL THEN
            PERFORM storage.lock_top_prefixes(v_all_bucket_ids, v_all_names);
        END IF;
    END;

    -- 3) Create destination prefixes (NEWOLD) BEFORE pruning sources
    IF array_length(v_add_bucket_ids, 1) IS NOT NULL THEN
        WITH candidates AS (
            SELECT DISTINCT t.bucket_id, unnest(storage.get_prefixes(t.name)) AS name
            FROM unnest(v_add_bucket_ids, v_add_names) AS t(bucket_id, name)
            WHERE name <> ''
        )
        INSERT INTO storage.prefixes (bucket_id, name)
        SELECT c.bucket_id, c.name
        FROM candidates c
        ON CONFLICT DO NOTHING;
    END IF;

    -- 4) Prune source prefixes bottom-up for OLDNEW
    IF array_length(v_src_bucket_ids, 1) IS NOT NULL THEN
        -- re-entrancy guard so DELETE on prefixes won't recurse
        IF current_setting('storage.gc.prefixes', true) <> '1' THEN
            PERFORM set_config('storage.gc.prefixes', '1', true);
        END IF;

        PERFORM storage.delete_leaf_prefixes(v_src_bucket_ids, v_src_names);
    END IF;

    RETURN NULL;
END;
$function$
|
| storage             | objects_update_level_trigger          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.objects_update_level_trigger()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Ensure this is an update operation and the name has changed
    IF TG_OP = 'UPDATE' AND (NEW."name" <> OLD."name" OR NEW."bucket_id" <> OLD."bucket_id") THEN
        -- Set the new level
        NEW."level" := "storage"."get_level"(NEW."name");
    END IF;
    RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| storage             | objects_update_prefix_trigger         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.objects_update_prefix_trigger()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    old_prefixes TEXT[];
BEGIN
    -- Ensure this is an update operation and the name has changed
    IF TG_OP = 'UPDATE' AND (NEW."name" <> OLD."name" OR NEW."bucket_id" <> OLD."bucket_id") THEN
        -- Retrieve old prefixes
        old_prefixes := "storage"."get_prefixes"(OLD."name");

        -- Remove old prefixes that are only used by this object
        WITH all_prefixes as (
            SELECT unnest(old_prefixes) as prefix
        ),
        can_delete_prefixes as (
             SELECT prefix
             FROM all_prefixes
             WHERE NOT EXISTS (
                 SELECT 1 FROM "storage"."objects"
                 WHERE "bucket_id" = OLD."bucket_id"
                   AND "name" <> OLD."name"
                   AND "name" LIKE (prefix || '%')
             )
         )
        DELETE FROM "storage"."prefixes" WHERE name IN (SELECT prefix FROM can_delete_prefixes);

        -- Add new prefixes
        PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    END IF;
    -- Set the new level
    NEW."level" := "storage"."get_level"(NEW."name");

    RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| storage             | operation                             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.operation()
 RETURNS text
 LANGUAGE plpgsql
 STABLE
AS $function$
BEGIN
    RETURN current_setting('storage.operation', true);
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| storage             | prefixes_delete_cleanup               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.prefixes_delete_cleanup()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    v_bucket_ids text[];
    v_names      text[];
BEGIN
    IF current_setting('storage.gc.prefixes', true) = '1' THEN
        RETURN NULL;
    END IF;

    PERFORM set_config('storage.gc.prefixes', '1', true);

    SELECT COALESCE(array_agg(d.bucket_id), '{}'),
           COALESCE(array_agg(d.name), '{}')
    INTO v_bucket_ids, v_names
    FROM deleted AS d
    WHERE d.name <> '';

    PERFORM storage.lock_top_prefixes(v_bucket_ids, v_names);
    PERFORM storage.delete_leaf_prefixes(v_bucket_ids, v_names);

    RETURN NULL;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| storage             | prefixes_insert_trigger               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.prefixes_insert_trigger()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    PERFORM "storage"."add_prefixes"(NEW."bucket_id", NEW."name");
    RETURN NEW;
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| storage             | search                                | prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION storage.search(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text)
 RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
 LANGUAGE plpgsql
AS $function$
declare
    can_bypass_rls BOOLEAN;
begin
    SELECT rolbypassrls
    INTO can_bypass_rls
    FROM pg_roles
    WHERE rolname = coalesce(nullif(current_setting('role', true), 'none'), current_user);

    IF can_bypass_rls THEN
        RETURN QUERY SELECT * FROM storage.search_v1_optimised(prefix, bucketname, limits, levels, offsets, search, sortcolumn, sortorder);
    ELSE
        RETURN QUERY SELECT * FROM storage.search_legacy_v1(prefix, bucketname, limits, levels, offsets, search, sortcolumn, sortorder);
    END IF;
end;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| storage             | search_legacy_v1                      | prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION storage.search_legacy_v1(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text)
 RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
 LANGUAGE plpgsql
 STABLE
AS $function$
declare
    v_order_by text;
    v_sort_order text;
begin
    case
        when sortcolumn = 'name' then
            v_order_by = 'name';
        when sortcolumn = 'updated_at' then
            v_order_by = 'updated_at';
        when sortcolumn = 'created_at' then
            v_order_by = 'created_at';
        when sortcolumn = 'last_accessed_at' then
            v_order_by = 'last_accessed_at';
        else
            v_order_by = 'name';
        end case;

    case
        when sortorder = 'asc' then
            v_sort_order = 'asc';
        when sortorder = 'desc' then
            v_sort_order = 'desc';
        else
            v_sort_order = 'asc';
        end case;

    v_order_by = v_order_by || ' ' || v_sort_order;

    return query execute
        'with folders as (
           select path_tokens[$1] as folder
           from storage.objects
             where objects.name ilike $2 || $3 || ''%''
               and bucket_id = $4
               and array_length(objects.path_tokens, 1) <> $1
           group by folder
           order by folder ' || v_sort_order || '
     )
     (select folder as "name",
            null as id,
            null as updated_at,
            null as created_at,
            null as last_accessed_at,
            null as metadata from folders)
     union all
     (select path_tokens[$1] as "name",
            id,
            updated_at,
            created_at,
            last_accessed_at,
            metadata
     from storage.objects
     where objects.name ilike $2 || $3 || ''%''
       and bucket_id = $4
       and array_length(objects.path_tokens, 1) = $1
     order by ' || v_order_by || ')
     limit $5
     offset $6' using levels, prefix, search, bucketname, limits, offsets;
end;
$function$
                                                                                       |
| storage             | search_v1_optimised                   | prefix text, bucketname text, limits integer, levels integer, offsets integer, search text, sortcolumn text, sortorder text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | CREATE OR REPLACE FUNCTION storage.search_v1_optimised(prefix text, bucketname text, limits integer DEFAULT 100, levels integer DEFAULT 1, offsets integer DEFAULT 0, search text DEFAULT ''::text, sortcolumn text DEFAULT 'name'::text, sortorder text DEFAULT 'asc'::text)
 RETURNS TABLE(name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
 LANGUAGE plpgsql
 STABLE
AS $function$
declare
    v_order_by text;
    v_sort_order text;
begin
    case
        when sortcolumn = 'name' then
            v_order_by = 'name';
        when sortcolumn = 'updated_at' then
            v_order_by = 'updated_at';
        when sortcolumn = 'created_at' then
            v_order_by = 'created_at';
        when sortcolumn = 'last_accessed_at' then
            v_order_by = 'last_accessed_at';
        else
            v_order_by = 'name';
        end case;

    case
        when sortorder = 'asc' then
            v_sort_order = 'asc';
        when sortorder = 'desc' then
            v_sort_order = 'desc';
        else
            v_sort_order = 'asc';
        end case;

    v_order_by = v_order_by || ' ' || v_sort_order;

    return query execute
        'with folders as (
           select (string_to_array(name, ''/''))[level] as name
           from storage.prefixes
             where lower(prefixes.name) like lower($2 || $3) || ''%''
               and bucket_id = $4
               and level = $1
           order by name ' || v_sort_order || '
     )
     (select name,
            null as id,
            null as updated_at,
            null as created_at,
            null as last_accessed_at,
            null as metadata from folders)
     union all
     (select path_tokens[level] as "name",
            id,
            updated_at,
            created_at,
            last_accessed_at,
            metadata
     from storage.objects
     where lower(objects.name) like lower($2 || $3) || ''%''
       and bucket_id = $4
       and level = $1
     order by ' || v_order_by || ')
     limit $5
     offset $6' using levels, prefix, search, bucketname, limits, offsets;
end;
$function$
                                                                                                                                         |
| storage             | search_v2                             | prefix text, bucket_name text, limits integer, levels integer, start_after text, sort_order text, sort_column text, sort_column_after text                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | CREATE OR REPLACE FUNCTION storage.search_v2(prefix text, bucket_name text, limits integer DEFAULT 100, levels integer DEFAULT 1, start_after text DEFAULT ''::text, sort_order text DEFAULT 'asc'::text, sort_column text DEFAULT 'name'::text, sort_column_after text DEFAULT ''::text)
 RETURNS TABLE(key text, name text, id uuid, updated_at timestamp with time zone, created_at timestamp with time zone, last_accessed_at timestamp with time zone, metadata jsonb)
 LANGUAGE plpgsql
 STABLE
AS $function$
DECLARE
    sort_col text;
    sort_ord text;
    cursor_op text;
    cursor_expr text;
    sort_expr text;
BEGIN
    -- Validate sort_order
    sort_ord := lower(sort_order);
    IF sort_ord NOT IN ('asc', 'desc') THEN
        sort_ord := 'asc';
    END IF;

    -- Determine cursor comparison operator
    IF sort_ord = 'asc' THEN
        cursor_op := '>';
    ELSE
        cursor_op := '<';
    END IF;
    
    sort_col := lower(sort_column);
    -- Validate sort column  
    IF sort_col IN ('updated_at', 'created_at') THEN
        cursor_expr := format(
            '($5 = '''' OR ROW(date_trunc(''milliseconds'', %I), name COLLATE "C") %s ROW(COALESCE(NULLIF($6, '''')::timestamptz, ''epoch''::timestamptz), $5))',
            sort_col, cursor_op
        );
        sort_expr := format(
            'COALESCE(date_trunc(''milliseconds'', %I), ''epoch''::timestamptz) %s, name COLLATE "C" %s',
            sort_col, sort_ord, sort_ord
        );
    ELSE
        cursor_expr := format('($5 = '''' OR name COLLATE "C" %s $5)', cursor_op);
        sort_expr := format('name COLLATE "C" %s', sort_ord);
    END IF;

    RETURN QUERY EXECUTE format(
        $sql$
        SELECT * FROM (
            (
                SELECT
                    split_part(name, '/', $4) AS key,
                    name,
                    NULL::uuid AS id,
                    updated_at,
                    created_at,
                    NULL::timestamptz AS last_accessed_at,
                    NULL::jsonb AS metadata
                FROM storage.prefixes
                WHERE name COLLATE "C" LIKE $1 || '%%'
                    AND bucket_id = $2
                    AND level = $4
                    AND %s
                ORDER BY %s
                LIMIT $3
            )
            UNION ALL
            (
                SELECT
                    split_part(name, '/', $4) AS key,
                    name,
                    id,
                    updated_at,
                    created_at,
                    last_accessed_at,
                    metadata
                FROM storage.objects
                WHERE name COLLATE "C" LIKE $1 || '%%'
                    AND bucket_id = $2
                    AND level = $4
                    AND %s
                ORDER BY %s
                LIMIT $3
            )
        ) obj
        ORDER BY %s
        LIMIT $3
        $sql$,
        cursor_expr,    -- prefixes WHERE
        sort_expr,      -- prefixes ORDER BY
        cursor_expr,    -- objects WHERE
        sort_expr,      -- objects ORDER BY
        sort_expr       -- final ORDER BY
    )
    USING prefix, bucket_name, limits, levels, start_after, sort_column_after;
END;
$function$
                                                                                                                      |
| storage             | update_updated_at_column              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION storage.update_updated_at_column()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    NEW.updated_at = now();
    RETURN NEW; 
END;
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vault               | _crypto_aead_det_decrypt              | message bytea, additional bytea, key_id bigint, context bytea, nonce bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | CREATE OR REPLACE FUNCTION vault._crypto_aead_det_decrypt(message bytea, additional bytea, key_id bigint, context bytea DEFAULT '\x7067736f6469756d'::bytea, nonce bytea DEFAULT NULL::bytea)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE
AS '$libdir/supabase_vault', $function$pgsodium_crypto_aead_det_decrypt_by_id$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vault               | _crypto_aead_det_encrypt              | message bytea, additional bytea, key_id bigint, context bytea, nonce bytea                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | CREATE OR REPLACE FUNCTION vault._crypto_aead_det_encrypt(message bytea, additional bytea, key_id bigint, context bytea DEFAULT '\x7067736f6469756d'::bytea, nonce bytea DEFAULT NULL::bytea)
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE
AS '$libdir/supabase_vault', $function$pgsodium_crypto_aead_det_encrypt_by_id$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| vault               | _crypto_aead_det_noncegen             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | CREATE OR REPLACE FUNCTION vault._crypto_aead_det_noncegen()
 RETURNS bytea
 LANGUAGE c
 IMMUTABLE
AS '$libdir/supabase_vault', $function$pgsodium_crypto_aead_det_noncegen$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| vault               | create_secret                         | new_secret text, new_name text, new_description text, new_key_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | CREATE OR REPLACE FUNCTION vault.create_secret(new_secret text, new_name text DEFAULT NULL::text, new_description text DEFAULT ''::text, new_key_id uuid DEFAULT NULL::uuid)
 RETURNS uuid
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO ''
AS $function$
DECLARE
  rec record;
BEGIN
  INSERT INTO vault.secrets (secret, name, description)
  VALUES (
    new_secret,
    new_name,
    new_description
  )
  RETURNING * INTO rec;
  UPDATE vault.secrets s
  SET secret = encode(vault._crypto_aead_det_encrypt(
    message := convert_to(rec.secret, 'utf8'),
    additional := convert_to(s.id::text, 'utf8'),
    key_id := 0,
    context := 'pgsodium'::bytea,
    nonce := rec.nonce
  ), 'base64')
  WHERE id = rec.id;
  RETURN rec.id;
END
$function$
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| vault               | update_secret                         | secret_id uuid, new_secret text, new_name text, new_description text, new_key_id uuid                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | CREATE OR REPLACE FUNCTION vault.update_secret(secret_id uuid, new_secret text DEFAULT NULL::text, new_name text DEFAULT NULL::text, new_description text DEFAULT NULL::text, new_key_id uuid DEFAULT NULL::uuid)
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO ''
AS $function$
DECLARE
  decrypted_secret text := (SELECT decrypted_secret FROM vault.decrypted_secrets WHERE id = secret_id);
BEGIN
  UPDATE vault.secrets s
  SET
    secret = CASE WHEN new_secret IS NULL THEN s.secret
                  ELSE encode(vault._crypto_aead_det_encrypt(
                    message := convert_to(new_secret, 'utf8'),
                    additional := convert_to(s.id::text, 'utf8'),
                    key_id := 0,
                    context := 'pgsodium'::bytea,
                    nonce := s.nonce
                  ), 'base64') END,
    name = coalesce(new_name, s.name),
    description = coalesce(new_description, s.description),
    updated_at = now()
  WHERE s.id = secret_id;
END
$function$
|






-------


# Views and their definitions (all schemas)


| schema_name | view_name               | view_definition                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ----------- | ----------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| extensions  | pg_stat_statements      |  SELECT userid,
    dbid,
    toplevel,
    queryid,
    query,
    plans,
    total_plan_time,
    min_plan_time,
    max_plan_time,
    mean_plan_time,
    stddev_plan_time,
    calls,
    total_exec_time,
    min_exec_time,
    max_exec_time,
    mean_exec_time,
    stddev_exec_time,
    rows,
    shared_blks_hit,
    shared_blks_read,
    shared_blks_dirtied,
    shared_blks_written,
    local_blks_hit,
    local_blks_read,
    local_blks_dirtied,
    local_blks_written,
    temp_blks_read,
    temp_blks_written,
    shared_blk_read_time,
    shared_blk_write_time,
    local_blk_read_time,
    local_blk_write_time,
    temp_blk_read_time,
    temp_blk_write_time,
    wal_records,
    wal_fpi,
    wal_bytes,
    jit_functions,
    jit_generation_time,
    jit_inlining_count,
    jit_inlining_time,
    jit_optimization_count,
    jit_optimization_time,
    jit_emission_count,
    jit_emission_time,
    jit_deform_count,
    jit_deform_time,
    stats_since,
    minmax_stats_since
   FROM pg_stat_statements(true) pg_stat_statements(userid, dbid, toplevel, queryid, query, plans, total_plan_time, min_plan_time, max_plan_time, mean_plan_time, stddev_plan_time, calls, total_exec_time, min_exec_time, max_exec_time, mean_exec_time, stddev_exec_time, rows, shared_blks_hit, shared_blks_read, shared_blks_dirtied, shared_blks_written, local_blks_hit, local_blks_read, local_blks_dirtied, local_blks_written, temp_blks_read, temp_blks_written, shared_blk_read_time, shared_blk_write_time, local_blk_read_time, local_blk_write_time, temp_blk_read_time, temp_blk_write_time, wal_records, wal_fpi, wal_bytes, jit_functions, jit_generation_time, jit_inlining_count, jit_inlining_time, jit_optimization_count, jit_optimization_time, jit_emission_count, jit_emission_time, jit_deform_count, jit_deform_time, stats_since, minmax_stats_since); |
| extensions  | pg_stat_statements_info |  SELECT dealloc,
    stats_reset
   FROM pg_stat_statements_info() pg_stat_statements_info(dealloc, stats_reset);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| vault       | decrypted_secrets       |  SELECT id,
    name,
    description,
    secret,
    convert_from(vault._crypto_aead_det_decrypt(message => decode(secret, 'base64'::text), additional => convert_to(id::text, 'utf8'::name), key_id => 0::bigint, context => '\x7067736f6469756d'::bytea, nonce => nonce), 'utf8'::name) AS decrypted_secret,
    key_id,
    nonce,
    created_at,
    updated_at
   FROM vault.secrets s;                                              |




